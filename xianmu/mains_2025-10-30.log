2025-10-30 00:11:11,447 - chromadb.telemetry.product.posthog - INFO - Anonymized telemetry enabled. See                     https://docs.trychroma.com/telemetry for more information.
2025-10-30 00:11:15,198 - travel - INFO - Langchain代理初始化成功
2025-10-30 00:11:23,319 - httpx - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-30 00:11:31,465 - httpx - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-30 00:11:31,918 - httpx - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-30 00:11:53,073 - httpx - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-30 00:11:54,245 - httpx - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-30 00:11:56,145 - httpx - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-30 00:20:12,613 - chromadb.telemetry.product.posthog - INFO - Anonymized telemetry enabled. See                     https://docs.trychroma.com/telemetry for more information.
2025-10-30 00:20:18,342 - travel - INFO - Langchain代理初始化成功
2025-10-30 00:20:23,708 - httpx - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-30 00:22:08,809 - httpx - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-30 00:22:09,335 - httpx - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-30 00:22:46,081 - chromadb.telemetry.product.posthog - INFO - Anonymized telemetry enabled. See                     https://docs.trychroma.com/telemetry for more information.
2025-10-30 00:22:49,148 - travel - INFO - Langchain代理初始化成功
2025-10-30 00:23:49,654 - chromadb.telemetry.product.posthog - INFO - Anonymized telemetry enabled. See                     https://docs.trychroma.com/telemetry for more information.
2025-10-30 00:23:52,444 - travel - INFO - Langchain代理初始化成功
2025-10-30 00:23:59,637 - httpx - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-30 00:39:11,424 - chromadb.telemetry.product.posthog - INFO - Anonymized telemetry enabled. See                     https://docs.trychroma.com/telemetry for more information.
2025-10-30 00:39:14,688 - travel - INFO - Langchain代理初始化成功
2025-10-30 00:39:20,293 - httpx - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-30 00:48:17,949 - chromadb.telemetry.product.posthog - INFO - Anonymized telemetry enabled. See                     https://docs.trychroma.com/telemetry for more information.
2025-10-30 00:48:20,976 - travel - INFO - Langchain代理初始化成功
2025-10-30 00:48:26,860 - httpx - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-30 00:48:34,147 - httpx - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-30 00:48:34,983 - httpx - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-30 00:48:36,271 - httpx - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-30 00:50:17,363 - chromadb.telemetry.product.posthog - INFO - Anonymized telemetry enabled. See                     https://docs.trychroma.com/telemetry for more information.
2025-10-30 00:50:20,213 - travel - INFO - Langchain代理初始化成功
2025-10-30 00:50:24,861 - httpx - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-30 00:50:30,037 - httpx - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-30 00:50:31,104 - httpx - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-30 00:50:32,556 - httpx - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-30 00:56:08,813 - chromadb.telemetry.product.posthog - INFO - Anonymized telemetry enabled. See                     https://docs.trychroma.com/telemetry for more information.
2025-10-30 00:56:08,879 - travel - ERROR - 添加文件到知识库失败：Error executing plan: Error sending backfill request to compactor: Error constructing hnsw segment reader: Error creating hnsw segment reader: Error loading hnsw index
2025-10-30 00:56:08,879 - travel - ERROR - Error executing plan: Error sending backfill request to compactor: Error constructing hnsw segment reader: Error creating hnsw segment reader: Error loading hnsw index
Traceback (most recent call last):
  File "D:\pythonlianxi\day23\基于langchian的智慧工厂知识助手实战\xianmu\main.py", line 104, in text_spliter_add
    test_count = vector_db._collection.count()
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\moxingxunihuanjing\mash3\Lib\site-packages\chromadb\api\models\Collection.py", line 43, in count
    return self._client._count(
           ^^^^^^^^^^^^^^^^^^^^
  File "D:\moxingxunihuanjing\mash3\Lib\site-packages\chromadb\api\rust.py", line 334, in _count
    return self.bindings.count(str(collection_id), tenant, database)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
chromadb.errors.InternalError: Error executing plan: Error sending backfill request to compactor: Error constructing hnsw segment reader: Error creating hnsw segment reader: Error loading hnsw index
2025-10-30 00:56:08,881 - travel - ERROR - 重置数据库失败：[WinError 32] 另一个程序正在使用此文件，进程无法访问。: 'D:\\pythonlianxi\\day23\\基于langchian的智慧工厂知识助手实战\\xianmu\\xiangliang\\chroma.sqlite3'
2025-10-30 00:56:08,881 - travel - ERROR - [WinError 32] 另一个程序正在使用此文件，进程无法访问。: 'D:\\pythonlianxi\\day23\\基于langchian的智慧工厂知识助手实战\\xianmu\\xiangliang\\chroma.sqlite3'
Traceback (most recent call last):
  File "D:\pythonlianxi\day23\基于langchian的智慧工厂知识助手实战\xianmu\main.py", line 104, in text_spliter_add
    test_count = vector_db._collection.count()
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\moxingxunihuanjing\mash3\Lib\site-packages\chromadb\api\models\Collection.py", line 43, in count
    return self._client._count(
           ^^^^^^^^^^^^^^^^^^^^
  File "D:\moxingxunihuanjing\mash3\Lib\site-packages\chromadb\api\rust.py", line 334, in _count
    return self.bindings.count(str(collection_id), tenant, database)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
chromadb.errors.InternalError: Error executing plan: Error sending backfill request to compactor: Error constructing hnsw segment reader: Error creating hnsw segment reader: Error loading hnsw index

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\pythonlianxi\day23\基于langchian的智慧工厂知识助手实战\xianmu\main.py", line 128, in text_spliter_add
    shutil.rmtree(kb_dir)
  File "D:\python\Lib\shutil.py", line 787, in rmtree
    return _rmtree_unsafe(path, onerror)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\python\Lib\shutil.py", line 634, in _rmtree_unsafe
    onerror(os.unlink, fullname, sys.exc_info())
  File "D:\python\Lib\shutil.py", line 632, in _rmtree_unsafe
    os.unlink(fullname)
PermissionError: [WinError 32] 另一个程序正在使用此文件，进程无法访问。: 'D:\\pythonlianxi\\day23\\基于langchian的智慧工厂知识助手实战\\xianmu\\xiangliang\\chroma.sqlite3'
2025-10-30 00:56:08,921 - travel - INFO - Langchain代理初始化成功
2025-10-30 00:56:23,488 - httpx - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-30 00:56:27,971 - httpx - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-30 00:56:29,254 - httpx - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-30 00:56:29,938 - httpx - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-30 00:56:46,581 - chromadb.telemetry.product.posthog - INFO - Anonymized telemetry enabled. See                     https://docs.trychroma.com/telemetry for more information.
2025-10-30 00:56:49,623 - travel - INFO - Langchain代理初始化成功
2025-10-30 00:57:00,270 - httpx - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-30 00:57:01,754 - httpx - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-30 00:59:46,005 - chromadb.telemetry.product.posthog - INFO - Anonymized telemetry enabled. See                     https://docs.trychroma.com/telemetry for more information.
2025-10-30 00:59:48,570 - travel - INFO - Langchain代理初始化成功
2025-10-30 00:59:57,751 - httpx - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-30 00:59:58,844 - httpx - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-30 01:00:57,692 - chromadb.telemetry.product.posthog - INFO - Anonymized telemetry enabled. See                     https://docs.trychroma.com/telemetry for more information.
2025-10-30 01:01:00,100 - travel - INFO - Langchain代理初始化成功
2025-10-30 01:01:10,442 - httpx - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-30 01:01:11,707 - httpx - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-30 01:07:22,187 - chromadb.telemetry.product.posthog - INFO - Anonymized telemetry enabled. See                     https://docs.trychroma.com/telemetry for more information.
2025-10-30 01:07:24,631 - travel - INFO - Langchain代理初始化成功
2025-10-30 01:07:34,440 - httpx - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-30 01:07:37,956 - httpx - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-30 01:07:39,398 - httpx - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-30 01:07:40,627 - httpx - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-30 01:08:06,253 - httpx - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-30 01:08:06,705 - httpx - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-30 01:08:11,376 - httpx - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-30 01:08:11,951 - httpx - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-30 09:12:25,084 - chromadb.telemetry.product.posthog - INFO - Anonymized telemetry enabled. See                     https://docs.trychroma.com/telemetry for more information.
2025-10-30 09:12:25,560 - travel - ERROR - 添加文件到知识库失败：status_code: 400 
 code: Arrearage 
 message: Access denied, please make sure your account is in good standing.
2025-10-30 09:12:25,560 - travel - ERROR - status_code: 400 
 code: Arrearage 
 message: Access denied, please make sure your account is in good standing.
Traceback (most recent call last):
  File "D:\pythonlianxi\day23\基于langchian的智慧工厂知识助手实战\xianmu\main.py", line 105, in text_spliter_add
    vector_db.add_documents(chunks)
  File "D:\moxingxunihuanjing\mash3\Lib\site-packages\langchain_core\vectorstores\base.py", line 288, in add_documents
    return self.add_texts(texts, metadatas, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\moxingxunihuanjing\mash3\Lib\site-packages\langchain_chroma\vectorstores.py", line 623, in add_texts
    embeddings = self._embedding_function.embed_documents(texts)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\moxingxunihuanjing\mash3\Lib\site-packages\langchain_community\embeddings\dashscope.py", line 150, in embed_documents
    embeddings = embed_with_retry(
                 ^^^^^^^^^^^^^^^^^
  File "D:\moxingxunihuanjing\mash3\Lib\site-packages\langchain_community\embeddings\dashscope.py", line 78, in embed_with_retry
    return _embed_with_retry(**kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\moxingxunihuanjing\mash3\Lib\site-packages\tenacity\__init__.py", line 338, in wrapped_f
    return copy(f, *args, **kw)
           ^^^^^^^^^^^^^^^^^^^^
  File "D:\moxingxunihuanjing\mash3\Lib\site-packages\tenacity\__init__.py", line 477, in __call__
    do = self.iter(retry_state=retry_state)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\moxingxunihuanjing\mash3\Lib\site-packages\tenacity\__init__.py", line 378, in iter
    result = action(retry_state)
             ^^^^^^^^^^^^^^^^^^^
  File "D:\moxingxunihuanjing\mash3\Lib\site-packages\tenacity\__init__.py", line 400, in <lambda>
    self._add_action_func(lambda rs: rs.outcome.result())
                                     ^^^^^^^^^^^^^^^^^^^
  File "D:\python\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "D:\python\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\moxingxunihuanjing\mash3\Lib\site-packages\tenacity\__init__.py", line 480, in __call__
    result = fn(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^
  File "D:\moxingxunihuanjing\mash3\Lib\site-packages\langchain_community\embeddings\dashscope.py", line 65, in _embed_with_retry
    raise ValueError(
ValueError: status_code: 400 
 code: Arrearage 
 message: Access denied, please make sure your account is in good standing.
2025-10-30 09:12:25,566 - travel - ERROR - 重置数据库失败：[WinError 32] 另一个程序正在使用此文件，进程无法访问。: 'D:\\pythonlianxi\\day23\\基于langchian的智慧工厂知识助手实战\\xianmu\\xiangliang\\chroma.sqlite3'
2025-10-30 09:12:25,566 - travel - ERROR - [WinError 32] 另一个程序正在使用此文件，进程无法访问。: 'D:\\pythonlianxi\\day23\\基于langchian的智慧工厂知识助手实战\\xianmu\\xiangliang\\chroma.sqlite3'
Traceback (most recent call last):
  File "D:\pythonlianxi\day23\基于langchian的智慧工厂知识助手实战\xianmu\main.py", line 105, in text_spliter_add
    vector_db.add_documents(chunks)
  File "D:\moxingxunihuanjing\mash3\Lib\site-packages\langchain_core\vectorstores\base.py", line 288, in add_documents
    return self.add_texts(texts, metadatas, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\moxingxunihuanjing\mash3\Lib\site-packages\langchain_chroma\vectorstores.py", line 623, in add_texts
    embeddings = self._embedding_function.embed_documents(texts)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\moxingxunihuanjing\mash3\Lib\site-packages\langchain_community\embeddings\dashscope.py", line 150, in embed_documents
    embeddings = embed_with_retry(
                 ^^^^^^^^^^^^^^^^^
  File "D:\moxingxunihuanjing\mash3\Lib\site-packages\langchain_community\embeddings\dashscope.py", line 78, in embed_with_retry
    return _embed_with_retry(**kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\moxingxunihuanjing\mash3\Lib\site-packages\tenacity\__init__.py", line 338, in wrapped_f
    return copy(f, *args, **kw)
           ^^^^^^^^^^^^^^^^^^^^
  File "D:\moxingxunihuanjing\mash3\Lib\site-packages\tenacity\__init__.py", line 477, in __call__
    do = self.iter(retry_state=retry_state)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\moxingxunihuanjing\mash3\Lib\site-packages\tenacity\__init__.py", line 378, in iter
    result = action(retry_state)
             ^^^^^^^^^^^^^^^^^^^
  File "D:\moxingxunihuanjing\mash3\Lib\site-packages\tenacity\__init__.py", line 400, in <lambda>
    self._add_action_func(lambda rs: rs.outcome.result())
                                     ^^^^^^^^^^^^^^^^^^^
  File "D:\python\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "D:\python\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\moxingxunihuanjing\mash3\Lib\site-packages\tenacity\__init__.py", line 480, in __call__
    result = fn(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^
  File "D:\moxingxunihuanjing\mash3\Lib\site-packages\langchain_community\embeddings\dashscope.py", line 65, in _embed_with_retry
    raise ValueError(
ValueError: status_code: 400 
 code: Arrearage 
 message: Access denied, please make sure your account is in good standing.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\pythonlianxi\day23\基于langchian的智慧工厂知识助手实战\xianmu\main.py", line 128, in text_spliter_add
    shutil.rmtree(kb_dir)
  File "D:\python\Lib\shutil.py", line 787, in rmtree
    return _rmtree_unsafe(path, onerror)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\python\Lib\shutil.py", line 634, in _rmtree_unsafe
    onerror(os.unlink, fullname, sys.exc_info())
  File "D:\python\Lib\shutil.py", line 632, in _rmtree_unsafe
    os.unlink(fullname)
PermissionError: [WinError 32] 另一个程序正在使用此文件，进程无法访问。: 'D:\\pythonlianxi\\day23\\基于langchian的智慧工厂知识助手实战\\xianmu\\xiangliang\\chroma.sqlite3'
2025-10-30 09:12:25,620 - travel - INFO - Langchain代理初始化成功
2025-10-30 09:12:33,999 - chromadb.telemetry.product.posthog - INFO - Anonymized telemetry enabled. See                     https://docs.trychroma.com/telemetry for more information.
2025-10-30 09:12:34,345 - travel - ERROR - 添加文件到知识库失败：status_code: 400 
 code: Arrearage 
 message: Access denied, please make sure your account is in good standing.
2025-10-30 09:12:34,346 - travel - ERROR - status_code: 400 
 code: Arrearage 
 message: Access denied, please make sure your account is in good standing.
Traceback (most recent call last):
  File "D:\pythonlianxi\day23\基于langchian的智慧工厂知识助手实战\xianmu\main.py", line 105, in text_spliter_add
    vector_db.add_documents(chunks)
  File "D:\moxingxunihuanjing\mash3\Lib\site-packages\langchain_core\vectorstores\base.py", line 288, in add_documents
    return self.add_texts(texts, metadatas, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\moxingxunihuanjing\mash3\Lib\site-packages\langchain_chroma\vectorstores.py", line 623, in add_texts
    embeddings = self._embedding_function.embed_documents(texts)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\moxingxunihuanjing\mash3\Lib\site-packages\langchain_community\embeddings\dashscope.py", line 150, in embed_documents
    embeddings = embed_with_retry(
                 ^^^^^^^^^^^^^^^^^
  File "D:\moxingxunihuanjing\mash3\Lib\site-packages\langchain_community\embeddings\dashscope.py", line 78, in embed_with_retry
    return _embed_with_retry(**kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\moxingxunihuanjing\mash3\Lib\site-packages\tenacity\__init__.py", line 338, in wrapped_f
    return copy(f, *args, **kw)
           ^^^^^^^^^^^^^^^^^^^^
  File "D:\moxingxunihuanjing\mash3\Lib\site-packages\tenacity\__init__.py", line 477, in __call__
    do = self.iter(retry_state=retry_state)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\moxingxunihuanjing\mash3\Lib\site-packages\tenacity\__init__.py", line 378, in iter
    result = action(retry_state)
             ^^^^^^^^^^^^^^^^^^^
  File "D:\moxingxunihuanjing\mash3\Lib\site-packages\tenacity\__init__.py", line 400, in <lambda>
    self._add_action_func(lambda rs: rs.outcome.result())
                                     ^^^^^^^^^^^^^^^^^^^
  File "D:\python\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "D:\python\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\moxingxunihuanjing\mash3\Lib\site-packages\tenacity\__init__.py", line 480, in __call__
    result = fn(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^
  File "D:\moxingxunihuanjing\mash3\Lib\site-packages\langchain_community\embeddings\dashscope.py", line 65, in _embed_with_retry
    raise ValueError(
ValueError: status_code: 400 
 code: Arrearage 
 message: Access denied, please make sure your account is in good standing.
2025-10-30 09:12:34,352 - travel - ERROR - 重置数据库失败：[WinError 32] 另一个程序正在使用此文件，进程无法访问。: 'D:\\pythonlianxi\\day23\\基于langchian的智慧工厂知识助手实战\\xianmu\\xiangliang\\chroma.sqlite3'
2025-10-30 09:12:34,352 - travel - ERROR - [WinError 32] 另一个程序正在使用此文件，进程无法访问。: 'D:\\pythonlianxi\\day23\\基于langchian的智慧工厂知识助手实战\\xianmu\\xiangliang\\chroma.sqlite3'
Traceback (most recent call last):
  File "D:\pythonlianxi\day23\基于langchian的智慧工厂知识助手实战\xianmu\main.py", line 105, in text_spliter_add
    vector_db.add_documents(chunks)
  File "D:\moxingxunihuanjing\mash3\Lib\site-packages\langchain_core\vectorstores\base.py", line 288, in add_documents
    return self.add_texts(texts, metadatas, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\moxingxunihuanjing\mash3\Lib\site-packages\langchain_chroma\vectorstores.py", line 623, in add_texts
    embeddings = self._embedding_function.embed_documents(texts)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\moxingxunihuanjing\mash3\Lib\site-packages\langchain_community\embeddings\dashscope.py", line 150, in embed_documents
    embeddings = embed_with_retry(
                 ^^^^^^^^^^^^^^^^^
  File "D:\moxingxunihuanjing\mash3\Lib\site-packages\langchain_community\embeddings\dashscope.py", line 78, in embed_with_retry
    return _embed_with_retry(**kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\moxingxunihuanjing\mash3\Lib\site-packages\tenacity\__init__.py", line 338, in wrapped_f
    return copy(f, *args, **kw)
           ^^^^^^^^^^^^^^^^^^^^
  File "D:\moxingxunihuanjing\mash3\Lib\site-packages\tenacity\__init__.py", line 477, in __call__
    do = self.iter(retry_state=retry_state)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\moxingxunihuanjing\mash3\Lib\site-packages\tenacity\__init__.py", line 378, in iter
    result = action(retry_state)
             ^^^^^^^^^^^^^^^^^^^
  File "D:\moxingxunihuanjing\mash3\Lib\site-packages\tenacity\__init__.py", line 400, in <lambda>
    self._add_action_func(lambda rs: rs.outcome.result())
                                     ^^^^^^^^^^^^^^^^^^^
  File "D:\python\Lib\concurrent\futures\_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "D:\python\Lib\concurrent\futures\_base.py", line 401, in __get_result
    raise self._exception
  File "D:\moxingxunihuanjing\mash3\Lib\site-packages\tenacity\__init__.py", line 480, in __call__
    result = fn(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^
  File "D:\moxingxunihuanjing\mash3\Lib\site-packages\langchain_community\embeddings\dashscope.py", line 65, in _embed_with_retry
    raise ValueError(
ValueError: status_code: 400 
 code: Arrearage 
 message: Access denied, please make sure your account is in good standing.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\pythonlianxi\day23\基于langchian的智慧工厂知识助手实战\xianmu\main.py", line 128, in text_spliter_add
    shutil.rmtree(kb_dir)
  File "D:\python\Lib\shutil.py", line 787, in rmtree
    return _rmtree_unsafe(path, onerror)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\python\Lib\shutil.py", line 634, in _rmtree_unsafe
    onerror(os.unlink, fullname, sys.exc_info())
  File "D:\python\Lib\shutil.py", line 632, in _rmtree_unsafe
    os.unlink(fullname)
PermissionError: [WinError 32] 另一个程序正在使用此文件，进程无法访问。: 'D:\\pythonlianxi\\day23\\基于langchian的智慧工厂知识助手实战\\xianmu\\xiangliang\\chroma.sqlite3'
2025-10-30 09:12:34,390 - travel - INFO - Langchain代理初始化成功
2025-10-30 09:14:06,977 - chromadb.telemetry.product.posthog - INFO - Anonymized telemetry enabled. See                     https://docs.trychroma.com/telemetry for more information.
2025-10-30 09:14:10,671 - travel - INFO - Langchain代理初始化成功
2025-10-30 09:14:15,917 - httpx - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-30 09:14:20,256 - httpx - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-30 09:14:21,133 - httpx - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-30 09:14:22,542 - httpx - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-30 09:15:11,337 - httpx - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-30 09:15:12,497 - httpx - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-30 09:15:14,510 - httpx - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-30 09:16:06,198 - httpx - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-30 09:16:06,891 - httpx - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-30 09:16:08,359 - httpx - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-30 10:04:58,037 - chromadb.telemetry.product.posthog - INFO - Anonymized telemetry enabled. See                     https://docs.trychroma.com/telemetry for more information.
2025-10-30 10:05:02,835 - travel - INFO - Langchain代理初始化成功
2025-10-30 10:05:07,710 - httpx - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-30 10:05:11,765 - httpx - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-30 10:05:12,405 - httpx - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-30 10:05:13,472 - httpx - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-30 10:05:18,592 - httpx - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-30 10:05:37,096 - httpx - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-30 10:05:38,343 - httpx - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-30 10:05:39,588 - httpx - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-30 10:05:57,271 - httpx - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-30 10:05:58,019 - httpx - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-30 10:05:59,868 - httpx - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-30 10:08:12,631 - chromadb.telemetry.product.posthog - INFO - Anonymized telemetry enabled. See                     https://docs.trychroma.com/telemetry for more information.
2025-10-30 10:08:16,659 - travel - INFO - Langchain代理初始化成功
2025-10-30 10:08:25,739 - httpx - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-30 10:08:27,522 - httpx - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-30 10:10:16,097 - chromadb.telemetry.product.posthog - INFO - Anonymized telemetry enabled. See                     https://docs.trychroma.com/telemetry for more information.
2025-10-30 10:10:21,275 - travel - ERROR - Langchain代理初始化失败：(pymysql.err.OperationalError) (1045, "Access denied for user 'root'@'localhost' (using password: YES)")
(Background on this error at: https://sqlalche.me/e/20/e3q8)
2025-10-30 10:10:58,609 - chromadb.telemetry.product.posthog - INFO - Anonymized telemetry enabled. See                     https://docs.trychroma.com/telemetry for more information.
2025-10-30 10:11:01,830 - travel - INFO - Langchain代理初始化成功
2025-10-30 10:11:08,328 - httpx - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-30 10:11:09,000 - chromadb.telemetry.product.posthog - INFO - Anonymized telemetry enabled. See                     https://docs.trychroma.com/telemetry for more information.
2025-10-30 10:11:12,300 - httpx - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-30 10:11:51,821 - chromadb.telemetry.product.posthog - INFO - Anonymized telemetry enabled. See                     https://docs.trychroma.com/telemetry for more information.
2025-10-30 10:11:56,176 - travel - INFO - Langchain代理初始化成功
2025-10-30 10:12:09,700 - httpx - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-30 10:12:09,940 - chromadb.telemetry.product.posthog - INFO - Anonymized telemetry enabled. See                     https://docs.trychroma.com/telemetry for more information.
2025-10-30 10:12:13,698 - httpx - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-30 10:13:09,133 - httpx - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-30 10:13:10,065 - httpx - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-30 10:13:11,419 - httpx - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-30 10:28:55,172 - chromadb.telemetry.product.posthog - INFO - Anonymized telemetry enabled. See                     https://docs.trychroma.com/telemetry for more information.
2025-10-30 10:28:59,037 - travel - INFO - Langchain代理初始化成功
2025-10-30 10:29:08,048 - httpx - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-30 10:29:08,268 - chromadb.telemetry.product.posthog - INFO - Anonymized telemetry enabled. See                     https://docs.trychroma.com/telemetry for more information.
2025-10-30 10:29:11,841 - httpx - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-30 10:31:00,390 - httpx - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-30 10:31:01,531 - httpx - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-30 10:31:02,499 - httpx - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-30 10:35:04,569 - chromadb.telemetry.product.posthog - INFO - Anonymized telemetry enabled. See                     https://docs.trychroma.com/telemetry for more information.
2025-10-30 10:35:08,828 - travel - INFO - Langchain代理初始化成功
2025-10-30 10:36:23,598 - httpx - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-30 10:36:23,976 - chromadb.telemetry.product.posthog - INFO - Anonymized telemetry enabled. See                     https://docs.trychroma.com/telemetry for more information.
2025-10-30 10:36:28,840 - httpx - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-30 10:43:47,579 - chromadb.telemetry.product.posthog - INFO - Anonymized telemetry enabled. See                     https://docs.trychroma.com/telemetry for more information.
2025-10-30 10:43:47,671 - travel - ERROR - 添加文件到知识库失败：Error executing plan: Error sending backfill request to compactor: Error constructing hnsw segment reader: Error creating hnsw segment reader: Error loading hnsw index
2025-10-30 10:43:47,671 - travel - ERROR - Error executing plan: Error sending backfill request to compactor: Error constructing hnsw segment reader: Error creating hnsw segment reader: Error loading hnsw index
Traceback (most recent call last):
  File "D:\pythonlianxi\day23\基于langchian的智慧工厂知识助手实战\xianmu\main.py", line 110, in text_spliter_add
    test_count = vector_db._collection.count()
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\moxingxunihuanjing\mash3\Lib\site-packages\chromadb\api\models\Collection.py", line 43, in count
    return self._client._count(
           ^^^^^^^^^^^^^^^^^^^^
  File "D:\moxingxunihuanjing\mash3\Lib\site-packages\chromadb\api\rust.py", line 334, in _count
    return self.bindings.count(str(collection_id), tenant, database)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
chromadb.errors.InternalError: Error executing plan: Error sending backfill request to compactor: Error constructing hnsw segment reader: Error creating hnsw segment reader: Error loading hnsw index
2025-10-30 10:43:47,675 - travel - ERROR - 重置数据库失败：[WinError 32] 另一个程序正在使用此文件，进程无法访问。: 'D:\\pythonlianxi\\day23\\基于langchian的智慧工厂知识助手实战\\xianmu\\xiangliang\\chroma.sqlite3'
2025-10-30 10:43:47,675 - travel - ERROR - [WinError 32] 另一个程序正在使用此文件，进程无法访问。: 'D:\\pythonlianxi\\day23\\基于langchian的智慧工厂知识助手实战\\xianmu\\xiangliang\\chroma.sqlite3'
Traceback (most recent call last):
  File "D:\pythonlianxi\day23\基于langchian的智慧工厂知识助手实战\xianmu\main.py", line 110, in text_spliter_add
    test_count = vector_db._collection.count()
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\moxingxunihuanjing\mash3\Lib\site-packages\chromadb\api\models\Collection.py", line 43, in count
    return self._client._count(
           ^^^^^^^^^^^^^^^^^^^^
  File "D:\moxingxunihuanjing\mash3\Lib\site-packages\chromadb\api\rust.py", line 334, in _count
    return self.bindings.count(str(collection_id), tenant, database)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
chromadb.errors.InternalError: Error executing plan: Error sending backfill request to compactor: Error constructing hnsw segment reader: Error creating hnsw segment reader: Error loading hnsw index

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\pythonlianxi\day23\基于langchian的智慧工厂知识助手实战\xianmu\main.py", line 134, in text_spliter_add
    shutil.rmtree(kb_dir)
  File "D:\python\Lib\shutil.py", line 787, in rmtree
    return _rmtree_unsafe(path, onerror)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\python\Lib\shutil.py", line 634, in _rmtree_unsafe
    onerror(os.unlink, fullname, sys.exc_info())
  File "D:\python\Lib\shutil.py", line 632, in _rmtree_unsafe
    os.unlink(fullname)
PermissionError: [WinError 32] 另一个程序正在使用此文件，进程无法访问。: 'D:\\pythonlianxi\\day23\\基于langchian的智慧工厂知识助手实战\\xianmu\\xiangliang\\chroma.sqlite3'
2025-10-30 10:43:47,748 - travel - INFO - Langchain代理初始化成功
2025-10-30 10:43:59,270 - chromadb.telemetry.product.posthog - INFO - Anonymized telemetry enabled. See                     https://docs.trychroma.com/telemetry for more information.
2025-10-30 10:44:04,072 - travel - INFO - Langchain代理初始化成功
2025-10-30 10:44:11,659 - httpx - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-30 10:44:13,700 - httpx - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-30 10:45:42,235 - httpx - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-30 10:45:43,207 - httpx - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-30 10:45:45,139 - httpx - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-30 10:48:49,200 - chromadb.telemetry.product.posthog - INFO - Anonymized telemetry enabled. See                     https://docs.trychroma.com/telemetry for more information.
2025-10-30 10:48:51,972 - travel - INFO - Langchain代理初始化成功
2025-10-30 10:49:05,505 - httpx - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-30 10:49:07,291 - httpx - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-30 10:49:11,080 - httpx - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-30 10:49:15,012 - httpx - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-30 10:50:10,247 - chromadb.telemetry.product.posthog - INFO - Anonymized telemetry enabled. See                     https://docs.trychroma.com/telemetry for more information.
2025-10-30 10:50:14,143 - travel - INFO - Langchain代理初始化成功
2025-10-30 10:51:41,941 - httpx - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-30 10:51:44,383 - httpx - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-30 10:52:17,080 - httpx - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-30 10:52:18,246 - httpx - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-30 10:52:19,992 - httpx - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-30 11:00:36,271 - chromadb.telemetry.product.posthog - INFO - Anonymized telemetry enabled. See                     https://docs.trychroma.com/telemetry for more information.
2025-10-30 11:00:40,248 - travel - INFO - Langchain代理初始化成功
2025-10-30 11:00:49,972 - httpx - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-30 11:00:51,359 - httpx - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-30 11:38:12,753 - chromadb.telemetry.product.posthog - INFO - Anonymized telemetry enabled. See                     https://docs.trychroma.com/telemetry for more information.
2025-10-30 11:38:16,618 - travel - INFO - Langchain代理初始化成功
2025-10-30 11:38:27,578 - httpx - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-30 11:38:29,166 - httpx - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-30 11:38:31,363 - httpx - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-30 11:42:06,542 - chromadb.telemetry.product.posthog - INFO - Anonymized telemetry enabled. See                     https://docs.trychroma.com/telemetry for more information.
2025-10-30 11:42:10,351 - travel - INFO - Langchain代理初始化成功
2025-10-30 11:42:20,741 - httpx - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-30 11:42:23,480 - httpx - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-30 11:42:25,846 - httpx - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-30 11:51:05,452 - chromadb.telemetry.product.posthog - INFO - Anonymized telemetry enabled. See                     https://docs.trychroma.com/telemetry for more information.
2025-10-30 11:51:09,597 - travel - INFO - Langchain代理初始化成功
2025-10-30 11:51:40,578 - httpx - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-30 11:51:42,372 - httpx - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-30 11:53:23,890 - chromadb.telemetry.product.posthog - INFO - Anonymized telemetry enabled. See                     https://docs.trychroma.com/telemetry for more information.
2025-10-30 11:53:26,794 - travel - INFO - Langchain代理初始化成功
2025-10-30 11:53:44,683 - httpx - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-30 11:53:47,584 - httpx - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-30 11:55:12,493 - chromadb.telemetry.product.posthog - INFO - Anonymized telemetry enabled. See                     https://docs.trychroma.com/telemetry for more information.
2025-10-30 11:55:16,639 - travel - INFO - Langchain代理初始化成功
2025-10-30 11:55:32,036 - httpx - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-30 11:55:34,024 - httpx - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-30 11:57:00,130 - chromadb.telemetry.product.posthog - INFO - Anonymized telemetry enabled. See                     https://docs.trychroma.com/telemetry for more information.
2025-10-30 11:57:04,280 - travel - INFO - Langchain代理初始化成功
2025-10-30 11:57:12,364 - httpx - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-30 11:57:14,416 - httpx - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-30 11:58:02,864 - chromadb.telemetry.product.posthog - INFO - Anonymized telemetry enabled. See                     https://docs.trychroma.com/telemetry for more information.
2025-10-30 11:58:05,936 - travel - INFO - Langchain代理初始化成功
2025-10-30 11:58:13,645 - httpx - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-30 11:58:15,321 - httpx - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-30 13:58:11,543 - chromadb.telemetry.product.posthog - INFO - Anonymized telemetry enabled. See                     https://docs.trychroma.com/telemetry for more information.
2025-10-30 13:58:15,746 - travel - INFO - Langchain代理初始化成功
2025-10-30 13:58:29,103 - httpx - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-30 13:58:30,765 - httpx - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-30 14:31:17,336 - chromadb.telemetry.product.posthog - INFO - Anonymized telemetry enabled. See                     https://docs.trychroma.com/telemetry for more information.
2025-10-30 14:31:17,397 - travel - ERROR - 添加文件到知识库失败：Error executing plan: Error sending backfill request to compactor: Error constructing hnsw segment reader: Error creating hnsw segment reader: Error loading hnsw index
2025-10-30 14:31:17,397 - travel - ERROR - Error executing plan: Error sending backfill request to compactor: Error constructing hnsw segment reader: Error creating hnsw segment reader: Error loading hnsw index
Traceback (most recent call last):
  File "D:\pythonlianxi\day23\基于langchian的智慧工厂知识助手实战\xianmu\main.py", line 141, in text_spliter_add
    test_count = vector_db._collection.count()
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\moxingxunihuanjing\mash3\Lib\site-packages\chromadb\api\models\Collection.py", line 43, in count
    return self._client._count(
           ^^^^^^^^^^^^^^^^^^^^
  File "D:\moxingxunihuanjing\mash3\Lib\site-packages\chromadb\api\rust.py", line 334, in _count
    return self.bindings.count(str(collection_id), tenant, database)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
chromadb.errors.InternalError: Error executing plan: Error sending backfill request to compactor: Error constructing hnsw segment reader: Error creating hnsw segment reader: Error loading hnsw index
2025-10-30 14:31:17,399 - travel - ERROR - 重置数据库失败：[WinError 32] 另一个程序正在使用此文件，进程无法访问。: 'D:\\pythonlianxi\\day23\\基于langchian的智慧工厂知识助手实战\\xianmu\\xiangliang\\chroma.sqlite3'
2025-10-30 14:31:17,399 - travel - ERROR - [WinError 32] 另一个程序正在使用此文件，进程无法访问。: 'D:\\pythonlianxi\\day23\\基于langchian的智慧工厂知识助手实战\\xianmu\\xiangliang\\chroma.sqlite3'
Traceback (most recent call last):
  File "D:\pythonlianxi\day23\基于langchian的智慧工厂知识助手实战\xianmu\main.py", line 141, in text_spliter_add
    test_count = vector_db._collection.count()
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\moxingxunihuanjing\mash3\Lib\site-packages\chromadb\api\models\Collection.py", line 43, in count
    return self._client._count(
           ^^^^^^^^^^^^^^^^^^^^
  File "D:\moxingxunihuanjing\mash3\Lib\site-packages\chromadb\api\rust.py", line 334, in _count
    return self.bindings.count(str(collection_id), tenant, database)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
chromadb.errors.InternalError: Error executing plan: Error sending backfill request to compactor: Error constructing hnsw segment reader: Error creating hnsw segment reader: Error loading hnsw index

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\pythonlianxi\day23\基于langchian的智慧工厂知识助手实战\xianmu\main.py", line 165, in text_spliter_add
    shutil.rmtree(kb_dir)
  File "D:\python\Lib\shutil.py", line 787, in rmtree
    return _rmtree_unsafe(path, onerror)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\python\Lib\shutil.py", line 634, in _rmtree_unsafe
    onerror(os.unlink, fullname, sys.exc_info())
  File "D:\python\Lib\shutil.py", line 632, in _rmtree_unsafe
    os.unlink(fullname)
PermissionError: [WinError 32] 另一个程序正在使用此文件，进程无法访问。: 'D:\\pythonlianxi\\day23\\基于langchian的智慧工厂知识助手实战\\xianmu\\xiangliang\\chroma.sqlite3'
2025-10-30 14:31:17,434 - travel - INFO - Langchain代理初始化成功
2025-10-30 14:34:46,949 - chromadb.telemetry.product.posthog - INFO - Anonymized telemetry enabled. See                     https://docs.trychroma.com/telemetry for more information.
2025-10-30 14:34:50,820 - travel - INFO - Langchain代理初始化成功
2025-10-30 14:35:11,430 - httpx - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-30 14:35:18,491 - httpx - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-30 14:37:03,570 - chromadb.telemetry.product.posthog - INFO - Anonymized telemetry enabled. See                     https://docs.trychroma.com/telemetry for more information.
2025-10-30 14:37:06,719 - travel - INFO - Langchain代理初始化成功
2025-10-30 14:37:19,413 - httpx - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-30 14:37:21,599 - httpx - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-30 14:37:24,715 - httpx - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-30 14:43:43,060 - httpx - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-30 14:43:43,979 - httpx - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-30 14:43:45,399 - httpx - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-30 14:45:35,732 - chromadb.telemetry.product.posthog - INFO - Anonymized telemetry enabled. See                     https://docs.trychroma.com/telemetry for more information.
2025-10-30 14:45:39,015 - travel - INFO - Langchain代理初始化成功
2025-10-30 14:45:58,823 - httpx - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-30 14:46:00,375 - httpx - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-30 14:46:36,053 - httpx - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-30 14:46:37,104 - httpx - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-30 14:46:38,306 - httpx - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-30 14:47:22,391 - httpx - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-30 14:47:23,759 - httpx - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-30 14:47:25,062 - httpx - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-30 14:48:56,598 - httpx - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-30 14:48:57,956 - httpx - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-30 14:48:59,448 - httpx - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-30 14:50:03,397 - httpx - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-30 14:50:04,564 - httpx - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-30 14:50:05,614 - httpx - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-30 14:52:11,299 - httpx - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-30 14:52:12,053 - httpx - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-30 14:52:14,436 - httpx - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-30 14:59:14,485 - chromadb.telemetry.product.posthog - INFO - Anonymized telemetry enabled. See                     https://docs.trychroma.com/telemetry for more information.
2025-10-30 14:59:17,544 - travel - ERROR - 添加文件到知识库失败：File is not a zip file
2025-10-30 14:59:17,544 - travel - ERROR - File is not a zip file
Traceback (most recent call last):
  File "D:\pythonlianxi\day23\基于langchian的智慧工厂知识助手实战\xianmu\main.py", line 125, in text_spliter_add
    doc = loader.load()
          ^^^^^^^^^^^^^
  File "D:\moxingxunihuanjing\mash3\Lib\site-packages\langchain_community\document_loaders\word_document.py", line 61, in load
    page_content=docx2txt.process(self.file_path),
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\moxingxunihuanjing\mash3\Lib\site-packages\docx2txt\docx2txt.py", line 76, in process
    zipf = zipfile.ZipFile(docx)
           ^^^^^^^^^^^^^^^^^^^^^
  File "D:\python\Lib\zipfile.py", line 1312, in __init__
    self._RealGetContents()
  File "D:\python\Lib\zipfile.py", line 1379, in _RealGetContents
    raise BadZipFile("File is not a zip file")
zipfile.BadZipFile: File is not a zip file
2025-10-30 14:59:17,547 - travel - ERROR - 重置数据库失败：[WinError 32] 另一个程序正在使用此文件，进程无法访问。: 'D:\\pythonlianxi\\day23\\基于langchian的智慧工厂知识助手实战\\xianmu\\xiangliang\\chroma.sqlite3'
2025-10-30 14:59:17,547 - travel - ERROR - [WinError 32] 另一个程序正在使用此文件，进程无法访问。: 'D:\\pythonlianxi\\day23\\基于langchian的智慧工厂知识助手实战\\xianmu\\xiangliang\\chroma.sqlite3'
Traceback (most recent call last):
  File "D:\pythonlianxi\day23\基于langchian的智慧工厂知识助手实战\xianmu\main.py", line 125, in text_spliter_add
    doc = loader.load()
          ^^^^^^^^^^^^^
  File "D:\moxingxunihuanjing\mash3\Lib\site-packages\langchain_community\document_loaders\word_document.py", line 61, in load
    page_content=docx2txt.process(self.file_path),
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\moxingxunihuanjing\mash3\Lib\site-packages\docx2txt\docx2txt.py", line 76, in process
    zipf = zipfile.ZipFile(docx)
           ^^^^^^^^^^^^^^^^^^^^^
  File "D:\python\Lib\zipfile.py", line 1312, in __init__
    self._RealGetContents()
  File "D:\python\Lib\zipfile.py", line 1379, in _RealGetContents
    raise BadZipFile("File is not a zip file")
zipfile.BadZipFile: File is not a zip file

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\pythonlianxi\day23\基于langchian的智慧工厂知识助手实战\xianmu\main.py", line 165, in text_spliter_add
    shutil.rmtree(kb_dir)
  File "D:\python\Lib\shutil.py", line 787, in rmtree
    return _rmtree_unsafe(path, onerror)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\python\Lib\shutil.py", line 634, in _rmtree_unsafe
    onerror(os.unlink, fullname, sys.exc_info())
  File "D:\python\Lib\shutil.py", line 632, in _rmtree_unsafe
    os.unlink(fullname)
PermissionError: [WinError 32] 另一个程序正在使用此文件，进程无法访问。: 'D:\\pythonlianxi\\day23\\基于langchian的智慧工厂知识助手实战\\xianmu\\xiangliang\\chroma.sqlite3'
2025-10-30 14:59:19,315 - travel - INFO - Langchain代理初始化成功
2025-10-30 14:59:32,279 - httpx - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-30 14:59:33,779 - httpx - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-30 15:00:16,367 - httpx - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-30 15:00:18,487 - httpx - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-30 15:00:20,103 - httpx - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-30 15:00:49,288 - httpx - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-30 15:00:51,604 - httpx - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-30 15:00:53,678 - httpx - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-30 15:01:56,702 - httpx - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-30 15:01:57,390 - httpx - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-30 15:03:06,268 - httpx - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-30 15:03:06,958 - httpx - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-30 15:03:10,233 - httpx - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-30 15:04:26,575 - httpx - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-30 15:04:27,287 - httpx - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-30 15:04:28,750 - httpx - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-30 15:07:29,009 - httpx - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-30 15:07:29,804 - httpx - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-30 15:07:31,177 - httpx - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-30 15:07:35,270 - httpx - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-30 15:10:58,286 - chromadb.telemetry.product.posthog - INFO - Anonymized telemetry enabled. See                     https://docs.trychroma.com/telemetry for more information.
2025-10-30 15:11:01,064 - travel - ERROR - 添加文件到知识库失败：File is not a zip file
2025-10-30 15:11:01,064 - travel - ERROR - File is not a zip file
Traceback (most recent call last):
  File "D:\pythonlianxi\day23\基于langchian的智慧工厂知识助手实战\xianmu\main.py", line 125, in text_spliter_add
    doc = loader.load()
          ^^^^^^^^^^^^^
  File "D:\moxingxunihuanjing\mash3\Lib\site-packages\langchain_community\document_loaders\word_document.py", line 61, in load
    page_content=docx2txt.process(self.file_path),
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\moxingxunihuanjing\mash3\Lib\site-packages\docx2txt\docx2txt.py", line 76, in process
    zipf = zipfile.ZipFile(docx)
           ^^^^^^^^^^^^^^^^^^^^^
  File "D:\python\Lib\zipfile.py", line 1312, in __init__
    self._RealGetContents()
  File "D:\python\Lib\zipfile.py", line 1379, in _RealGetContents
    raise BadZipFile("File is not a zip file")
zipfile.BadZipFile: File is not a zip file
2025-10-30 15:11:01,068 - travel - ERROR - 重置数据库失败：[WinError 32] 另一个程序正在使用此文件，进程无法访问。: 'D:\\pythonlianxi\\day23\\基于langchian的智慧工厂知识助手实战\\xianmu\\xiangliang\\chroma.sqlite3'
2025-10-30 15:11:01,068 - travel - ERROR - [WinError 32] 另一个程序正在使用此文件，进程无法访问。: 'D:\\pythonlianxi\\day23\\基于langchian的智慧工厂知识助手实战\\xianmu\\xiangliang\\chroma.sqlite3'
Traceback (most recent call last):
  File "D:\pythonlianxi\day23\基于langchian的智慧工厂知识助手实战\xianmu\main.py", line 125, in text_spliter_add
    doc = loader.load()
          ^^^^^^^^^^^^^
  File "D:\moxingxunihuanjing\mash3\Lib\site-packages\langchain_community\document_loaders\word_document.py", line 61, in load
    page_content=docx2txt.process(self.file_path),
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\moxingxunihuanjing\mash3\Lib\site-packages\docx2txt\docx2txt.py", line 76, in process
    zipf = zipfile.ZipFile(docx)
           ^^^^^^^^^^^^^^^^^^^^^
  File "D:\python\Lib\zipfile.py", line 1312, in __init__
    self._RealGetContents()
  File "D:\python\Lib\zipfile.py", line 1379, in _RealGetContents
    raise BadZipFile("File is not a zip file")
zipfile.BadZipFile: File is not a zip file

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\pythonlianxi\day23\基于langchian的智慧工厂知识助手实战\xianmu\main.py", line 165, in text_spliter_add
    shutil.rmtree(kb_dir)
  File "D:\python\Lib\shutil.py", line 787, in rmtree
    return _rmtree_unsafe(path, onerror)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\python\Lib\shutil.py", line 634, in _rmtree_unsafe
    onerror(os.unlink, fullname, sys.exc_info())
  File "D:\python\Lib\shutil.py", line 632, in _rmtree_unsafe
    os.unlink(fullname)
PermissionError: [WinError 32] 另一个程序正在使用此文件，进程无法访问。: 'D:\\pythonlianxi\\day23\\基于langchian的智慧工厂知识助手实战\\xianmu\\xiangliang\\chroma.sqlite3'
2025-10-30 15:11:03,536 - travel - INFO - Langchain代理初始化成功
2025-10-30 15:11:09,929 - httpx - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-30 15:11:11,789 - httpx - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-30 15:11:47,280 - httpx - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-30 15:11:48,799 - httpx - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-30 15:11:50,566 - httpx - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-30 15:11:53,113 - httpx - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-30 15:12:52,042 - httpx - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-30 15:12:53,028 - httpx - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-30 15:12:55,422 - httpx - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-30 15:12:57,211 - httpx - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-30 15:21:58,478 - chromadb.telemetry.product.posthog - INFO - Anonymized telemetry enabled. See                     https://docs.trychroma.com/telemetry for more information.
2025-10-30 15:22:01,497 - travel - ERROR - 添加文件到知识库失败：File is not a zip file
2025-10-30 15:22:01,497 - travel - ERROR - File is not a zip file
Traceback (most recent call last):
  File "D:\pythonlianxi\day23\基于langchian的智慧工厂知识助手实战\xianmu\main.py", line 125, in text_spliter_add
    doc = loader.load()
          ^^^^^^^^^^^^^
  File "D:\moxingxunihuanjing\mash3\Lib\site-packages\langchain_community\document_loaders\word_document.py", line 61, in load
    page_content=docx2txt.process(self.file_path),
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\moxingxunihuanjing\mash3\Lib\site-packages\docx2txt\docx2txt.py", line 76, in process
    zipf = zipfile.ZipFile(docx)
           ^^^^^^^^^^^^^^^^^^^^^
  File "D:\python\Lib\zipfile.py", line 1312, in __init__
    self._RealGetContents()
  File "D:\python\Lib\zipfile.py", line 1379, in _RealGetContents
    raise BadZipFile("File is not a zip file")
zipfile.BadZipFile: File is not a zip file
2025-10-30 15:22:01,500 - travel - ERROR - 重置数据库失败：[WinError 32] 另一个程序正在使用此文件，进程无法访问。: 'D:\\pythonlianxi\\day23\\基于langchian的智慧工厂知识助手实战\\xianmu\\xiangliang\\chroma.sqlite3'
2025-10-30 15:22:01,500 - travel - ERROR - [WinError 32] 另一个程序正在使用此文件，进程无法访问。: 'D:\\pythonlianxi\\day23\\基于langchian的智慧工厂知识助手实战\\xianmu\\xiangliang\\chroma.sqlite3'
Traceback (most recent call last):
  File "D:\pythonlianxi\day23\基于langchian的智慧工厂知识助手实战\xianmu\main.py", line 125, in text_spliter_add
    doc = loader.load()
          ^^^^^^^^^^^^^
  File "D:\moxingxunihuanjing\mash3\Lib\site-packages\langchain_community\document_loaders\word_document.py", line 61, in load
    page_content=docx2txt.process(self.file_path),
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\moxingxunihuanjing\mash3\Lib\site-packages\docx2txt\docx2txt.py", line 76, in process
    zipf = zipfile.ZipFile(docx)
           ^^^^^^^^^^^^^^^^^^^^^
  File "D:\python\Lib\zipfile.py", line 1312, in __init__
    self._RealGetContents()
  File "D:\python\Lib\zipfile.py", line 1379, in _RealGetContents
    raise BadZipFile("File is not a zip file")
zipfile.BadZipFile: File is not a zip file

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\pythonlianxi\day23\基于langchian的智慧工厂知识助手实战\xianmu\main.py", line 165, in text_spliter_add
    shutil.rmtree(kb_dir)
  File "D:\python\Lib\shutil.py", line 787, in rmtree
    return _rmtree_unsafe(path, onerror)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\python\Lib\shutil.py", line 634, in _rmtree_unsafe
    onerror(os.unlink, fullname, sys.exc_info())
  File "D:\python\Lib\shutil.py", line 632, in _rmtree_unsafe
    os.unlink(fullname)
PermissionError: [WinError 32] 另一个程序正在使用此文件，进程无法访问。: 'D:\\pythonlianxi\\day23\\基于langchian的智慧工厂知识助手实战\\xianmu\\xiangliang\\chroma.sqlite3'
2025-10-30 15:22:03,190 - travel - INFO - Langchain代理初始化成功
2025-10-30 15:22:31,690 - chromadb.telemetry.product.posthog - INFO - Anonymized telemetry enabled. See                     https://docs.trychroma.com/telemetry for more information.
2025-10-30 15:22:34,438 - travel - ERROR - 添加文件到知识库失败：File is not a zip file
2025-10-30 15:22:34,438 - travel - ERROR - File is not a zip file
Traceback (most recent call last):
  File "D:\pythonlianxi\day23\基于langchian的智慧工厂知识助手实战\xianmu\main.py", line 125, in text_spliter_add
    doc = loader.load()
          ^^^^^^^^^^^^^
  File "D:\moxingxunihuanjing\mash3\Lib\site-packages\langchain_community\document_loaders\word_document.py", line 61, in load
    page_content=docx2txt.process(self.file_path),
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\moxingxunihuanjing\mash3\Lib\site-packages\docx2txt\docx2txt.py", line 76, in process
    zipf = zipfile.ZipFile(docx)
           ^^^^^^^^^^^^^^^^^^^^^
  File "D:\python\Lib\zipfile.py", line 1312, in __init__
    self._RealGetContents()
  File "D:\python\Lib\zipfile.py", line 1379, in _RealGetContents
    raise BadZipFile("File is not a zip file")
zipfile.BadZipFile: File is not a zip file
2025-10-30 15:22:34,441 - travel - ERROR - 重置数据库失败：[WinError 32] 另一个程序正在使用此文件，进程无法访问。: 'D:\\pythonlianxi\\day23\\基于langchian的智慧工厂知识助手实战\\xianmu\\xiangliang\\chroma.sqlite3'
2025-10-30 15:22:34,441 - travel - ERROR - [WinError 32] 另一个程序正在使用此文件，进程无法访问。: 'D:\\pythonlianxi\\day23\\基于langchian的智慧工厂知识助手实战\\xianmu\\xiangliang\\chroma.sqlite3'
Traceback (most recent call last):
  File "D:\pythonlianxi\day23\基于langchian的智慧工厂知识助手实战\xianmu\main.py", line 125, in text_spliter_add
    doc = loader.load()
          ^^^^^^^^^^^^^
  File "D:\moxingxunihuanjing\mash3\Lib\site-packages\langchain_community\document_loaders\word_document.py", line 61, in load
    page_content=docx2txt.process(self.file_path),
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\moxingxunihuanjing\mash3\Lib\site-packages\docx2txt\docx2txt.py", line 76, in process
    zipf = zipfile.ZipFile(docx)
           ^^^^^^^^^^^^^^^^^^^^^
  File "D:\python\Lib\zipfile.py", line 1312, in __init__
    self._RealGetContents()
  File "D:\python\Lib\zipfile.py", line 1379, in _RealGetContents
    raise BadZipFile("File is not a zip file")
zipfile.BadZipFile: File is not a zip file

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\pythonlianxi\day23\基于langchian的智慧工厂知识助手实战\xianmu\main.py", line 165, in text_spliter_add
    shutil.rmtree(kb_dir)
  File "D:\python\Lib\shutil.py", line 787, in rmtree
    return _rmtree_unsafe(path, onerror)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\python\Lib\shutil.py", line 634, in _rmtree_unsafe
    onerror(os.unlink, fullname, sys.exc_info())
  File "D:\python\Lib\shutil.py", line 632, in _rmtree_unsafe
    os.unlink(fullname)
PermissionError: [WinError 32] 另一个程序正在使用此文件，进程无法访问。: 'D:\\pythonlianxi\\day23\\基于langchian的智慧工厂知识助手实战\\xianmu\\xiangliang\\chroma.sqlite3'
2025-10-30 15:22:36,179 - travel - INFO - Langchain代理初始化成功
2025-10-30 15:22:54,989 - httpx - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-30 15:22:56,988 - httpx - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-30 15:22:59,461 - httpx - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-30 15:26:27,075 - chromadb.telemetry.product.posthog - INFO - Anonymized telemetry enabled. See                     https://docs.trychroma.com/telemetry for more information.
2025-10-30 15:26:30,091 - travel - ERROR - 添加文件到知识库失败：File is not a zip file
2025-10-30 15:26:30,091 - travel - ERROR - File is not a zip file
Traceback (most recent call last):
  File "D:\pythonlianxi\day23\基于langchian的智慧工厂知识助手实战\xianmu\main.py", line 125, in text_spliter_add
    doc = loader.load()
          ^^^^^^^^^^^^^
  File "D:\moxingxunihuanjing\mash3\Lib\site-packages\langchain_community\document_loaders\word_document.py", line 61, in load
    page_content=docx2txt.process(self.file_path),
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\moxingxunihuanjing\mash3\Lib\site-packages\docx2txt\docx2txt.py", line 76, in process
    zipf = zipfile.ZipFile(docx)
           ^^^^^^^^^^^^^^^^^^^^^
  File "D:\python\Lib\zipfile.py", line 1312, in __init__
    self._RealGetContents()
  File "D:\python\Lib\zipfile.py", line 1379, in _RealGetContents
    raise BadZipFile("File is not a zip file")
zipfile.BadZipFile: File is not a zip file
2025-10-30 15:26:30,093 - travel - ERROR - 重置数据库失败：[WinError 32] 另一个程序正在使用此文件，进程无法访问。: 'D:\\pythonlianxi\\day23\\基于langchian的智慧工厂知识助手实战\\xianmu\\xiangliang\\chroma.sqlite3'
2025-10-30 15:26:30,093 - travel - ERROR - [WinError 32] 另一个程序正在使用此文件，进程无法访问。: 'D:\\pythonlianxi\\day23\\基于langchian的智慧工厂知识助手实战\\xianmu\\xiangliang\\chroma.sqlite3'
Traceback (most recent call last):
  File "D:\pythonlianxi\day23\基于langchian的智慧工厂知识助手实战\xianmu\main.py", line 125, in text_spliter_add
    doc = loader.load()
          ^^^^^^^^^^^^^
  File "D:\moxingxunihuanjing\mash3\Lib\site-packages\langchain_community\document_loaders\word_document.py", line 61, in load
    page_content=docx2txt.process(self.file_path),
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\moxingxunihuanjing\mash3\Lib\site-packages\docx2txt\docx2txt.py", line 76, in process
    zipf = zipfile.ZipFile(docx)
           ^^^^^^^^^^^^^^^^^^^^^
  File "D:\python\Lib\zipfile.py", line 1312, in __init__
    self._RealGetContents()
  File "D:\python\Lib\zipfile.py", line 1379, in _RealGetContents
    raise BadZipFile("File is not a zip file")
zipfile.BadZipFile: File is not a zip file

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\pythonlianxi\day23\基于langchian的智慧工厂知识助手实战\xianmu\main.py", line 165, in text_spliter_add
    shutil.rmtree(kb_dir)
  File "D:\python\Lib\shutil.py", line 787, in rmtree
    return _rmtree_unsafe(path, onerror)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\python\Lib\shutil.py", line 634, in _rmtree_unsafe
    onerror(os.unlink, fullname, sys.exc_info())
  File "D:\python\Lib\shutil.py", line 632, in _rmtree_unsafe
    os.unlink(fullname)
PermissionError: [WinError 32] 另一个程序正在使用此文件，进程无法访问。: 'D:\\pythonlianxi\\day23\\基于langchian的智慧工厂知识助手实战\\xianmu\\xiangliang\\chroma.sqlite3'
2025-10-30 15:26:32,009 - travel - INFO - Langchain代理初始化成功
2025-10-30 15:26:54,098 - httpx - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-30 15:26:56,578 - httpx - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-30 15:26:58,495 - httpx - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-30 15:27:26,726 - chromadb.telemetry.product.posthog - INFO - Anonymized telemetry enabled. See                     https://docs.trychroma.com/telemetry for more information.
2025-10-30 15:27:29,464 - travel - ERROR - 添加文件到知识库失败：File is not a zip file
2025-10-30 15:27:29,464 - travel - ERROR - File is not a zip file
Traceback (most recent call last):
  File "D:\pythonlianxi\day23\基于langchian的智慧工厂知识助手实战\xianmu\main.py", line 125, in text_spliter_add
    doc = loader.load()
          ^^^^^^^^^^^^^
  File "D:\moxingxunihuanjing\mash3\Lib\site-packages\langchain_community\document_loaders\word_document.py", line 61, in load
    page_content=docx2txt.process(self.file_path),
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\moxingxunihuanjing\mash3\Lib\site-packages\docx2txt\docx2txt.py", line 76, in process
    zipf = zipfile.ZipFile(docx)
           ^^^^^^^^^^^^^^^^^^^^^
  File "D:\python\Lib\zipfile.py", line 1312, in __init__
    self._RealGetContents()
  File "D:\python\Lib\zipfile.py", line 1379, in _RealGetContents
    raise BadZipFile("File is not a zip file")
zipfile.BadZipFile: File is not a zip file
2025-10-30 15:27:29,466 - travel - ERROR - 重置数据库失败：[WinError 32] 另一个程序正在使用此文件，进程无法访问。: 'D:\\pythonlianxi\\day23\\基于langchian的智慧工厂知识助手实战\\xianmu\\xiangliang\\chroma.sqlite3'
2025-10-30 15:27:29,467 - travel - ERROR - [WinError 32] 另一个程序正在使用此文件，进程无法访问。: 'D:\\pythonlianxi\\day23\\基于langchian的智慧工厂知识助手实战\\xianmu\\xiangliang\\chroma.sqlite3'
Traceback (most recent call last):
  File "D:\pythonlianxi\day23\基于langchian的智慧工厂知识助手实战\xianmu\main.py", line 125, in text_spliter_add
    doc = loader.load()
          ^^^^^^^^^^^^^
  File "D:\moxingxunihuanjing\mash3\Lib\site-packages\langchain_community\document_loaders\word_document.py", line 61, in load
    page_content=docx2txt.process(self.file_path),
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\moxingxunihuanjing\mash3\Lib\site-packages\docx2txt\docx2txt.py", line 76, in process
    zipf = zipfile.ZipFile(docx)
           ^^^^^^^^^^^^^^^^^^^^^
  File "D:\python\Lib\zipfile.py", line 1312, in __init__
    self._RealGetContents()
  File "D:\python\Lib\zipfile.py", line 1379, in _RealGetContents
    raise BadZipFile("File is not a zip file")
zipfile.BadZipFile: File is not a zip file

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\pythonlianxi\day23\基于langchian的智慧工厂知识助手实战\xianmu\main.py", line 165, in text_spliter_add
    shutil.rmtree(kb_dir)
  File "D:\python\Lib\shutil.py", line 787, in rmtree
    return _rmtree_unsafe(path, onerror)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\python\Lib\shutil.py", line 634, in _rmtree_unsafe
    onerror(os.unlink, fullname, sys.exc_info())
  File "D:\python\Lib\shutil.py", line 632, in _rmtree_unsafe
    os.unlink(fullname)
PermissionError: [WinError 32] 另一个程序正在使用此文件，进程无法访问。: 'D:\\pythonlianxi\\day23\\基于langchian的智慧工厂知识助手实战\\xianmu\\xiangliang\\chroma.sqlite3'
2025-10-30 15:27:31,296 - travel - INFO - Langchain代理初始化成功
2025-10-30 15:27:47,942 - httpx - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-30 15:27:49,557 - httpx - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-30 15:28:00,335 - httpx - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-30 15:29:55,544 - chromadb.telemetry.product.posthog - INFO - Anonymized telemetry enabled. See                     https://docs.trychroma.com/telemetry for more information.
2025-10-30 15:29:58,824 - travel - ERROR - 添加文件到知识库失败：File is not a zip file
2025-10-30 15:29:58,824 - travel - ERROR - File is not a zip file
Traceback (most recent call last):
  File "D:\pythonlianxi\day23\基于langchian的智慧工厂知识助手实战\xianmu\main.py", line 125, in text_spliter_add
    doc = loader.load()
          ^^^^^^^^^^^^^
  File "D:\moxingxunihuanjing\mash3\Lib\site-packages\langchain_community\document_loaders\word_document.py", line 61, in load
    page_content=docx2txt.process(self.file_path),
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\moxingxunihuanjing\mash3\Lib\site-packages\docx2txt\docx2txt.py", line 76, in process
    zipf = zipfile.ZipFile(docx)
           ^^^^^^^^^^^^^^^^^^^^^
  File "D:\python\Lib\zipfile.py", line 1312, in __init__
    self._RealGetContents()
  File "D:\python\Lib\zipfile.py", line 1379, in _RealGetContents
    raise BadZipFile("File is not a zip file")
zipfile.BadZipFile: File is not a zip file
2025-10-30 15:29:58,827 - travel - ERROR - 重置数据库失败：[WinError 32] 另一个程序正在使用此文件，进程无法访问。: 'D:\\pythonlianxi\\day23\\基于langchian的智慧工厂知识助手实战\\xianmu\\xiangliang\\chroma.sqlite3'
2025-10-30 15:29:58,827 - travel - ERROR - [WinError 32] 另一个程序正在使用此文件，进程无法访问。: 'D:\\pythonlianxi\\day23\\基于langchian的智慧工厂知识助手实战\\xianmu\\xiangliang\\chroma.sqlite3'
Traceback (most recent call last):
  File "D:\pythonlianxi\day23\基于langchian的智慧工厂知识助手实战\xianmu\main.py", line 125, in text_spliter_add
    doc = loader.load()
          ^^^^^^^^^^^^^
  File "D:\moxingxunihuanjing\mash3\Lib\site-packages\langchain_community\document_loaders\word_document.py", line 61, in load
    page_content=docx2txt.process(self.file_path),
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\moxingxunihuanjing\mash3\Lib\site-packages\docx2txt\docx2txt.py", line 76, in process
    zipf = zipfile.ZipFile(docx)
           ^^^^^^^^^^^^^^^^^^^^^
  File "D:\python\Lib\zipfile.py", line 1312, in __init__
    self._RealGetContents()
  File "D:\python\Lib\zipfile.py", line 1379, in _RealGetContents
    raise BadZipFile("File is not a zip file")
zipfile.BadZipFile: File is not a zip file

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\pythonlianxi\day23\基于langchian的智慧工厂知识助手实战\xianmu\main.py", line 165, in text_spliter_add
    shutil.rmtree(kb_dir)
  File "D:\python\Lib\shutil.py", line 787, in rmtree
    return _rmtree_unsafe(path, onerror)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\python\Lib\shutil.py", line 634, in _rmtree_unsafe
    onerror(os.unlink, fullname, sys.exc_info())
  File "D:\python\Lib\shutil.py", line 632, in _rmtree_unsafe
    os.unlink(fullname)
PermissionError: [WinError 32] 另一个程序正在使用此文件，进程无法访问。: 'D:\\pythonlianxi\\day23\\基于langchian的智慧工厂知识助手实战\\xianmu\\xiangliang\\chroma.sqlite3'
2025-10-30 15:30:00,072 - travel - INFO - Langchain代理初始化成功
2025-10-30 15:30:19,432 - httpx - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-30 15:30:22,043 - httpx - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-30 15:30:23,969 - httpx - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-30 15:31:18,084 - httpx - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-30 15:31:19,825 - httpx - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-30 15:31:21,427 - httpx - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-30 15:34:05,444 - chromadb.telemetry.product.posthog - INFO - Anonymized telemetry enabled. See                     https://docs.trychroma.com/telemetry for more information.
2025-10-30 15:34:08,253 - travel - ERROR - 添加文件到知识库失败：File is not a zip file
2025-10-30 15:34:08,253 - travel - ERROR - File is not a zip file
Traceback (most recent call last):
  File "D:\pythonlianxi\day23\基于langchian的智慧工厂知识助手实战\xianmu\main.py", line 125, in text_spliter_add
    doc = loader.load()
          ^^^^^^^^^^^^^
  File "D:\moxingxunihuanjing\mash3\Lib\site-packages\langchain_community\document_loaders\word_document.py", line 61, in load
    page_content=docx2txt.process(self.file_path),
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\moxingxunihuanjing\mash3\Lib\site-packages\docx2txt\docx2txt.py", line 76, in process
    zipf = zipfile.ZipFile(docx)
           ^^^^^^^^^^^^^^^^^^^^^
  File "D:\python\Lib\zipfile.py", line 1312, in __init__
    self._RealGetContents()
  File "D:\python\Lib\zipfile.py", line 1379, in _RealGetContents
    raise BadZipFile("File is not a zip file")
zipfile.BadZipFile: File is not a zip file
2025-10-30 15:34:08,255 - travel - ERROR - 重置数据库失败：[WinError 32] 另一个程序正在使用此文件，进程无法访问。: 'D:\\pythonlianxi\\day23\\基于langchian的智慧工厂知识助手实战\\xianmu\\xiangliang\\chroma.sqlite3'
2025-10-30 15:34:08,255 - travel - ERROR - [WinError 32] 另一个程序正在使用此文件，进程无法访问。: 'D:\\pythonlianxi\\day23\\基于langchian的智慧工厂知识助手实战\\xianmu\\xiangliang\\chroma.sqlite3'
Traceback (most recent call last):
  File "D:\pythonlianxi\day23\基于langchian的智慧工厂知识助手实战\xianmu\main.py", line 125, in text_spliter_add
    doc = loader.load()
          ^^^^^^^^^^^^^
  File "D:\moxingxunihuanjing\mash3\Lib\site-packages\langchain_community\document_loaders\word_document.py", line 61, in load
    page_content=docx2txt.process(self.file_path),
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\moxingxunihuanjing\mash3\Lib\site-packages\docx2txt\docx2txt.py", line 76, in process
    zipf = zipfile.ZipFile(docx)
           ^^^^^^^^^^^^^^^^^^^^^
  File "D:\python\Lib\zipfile.py", line 1312, in __init__
    self._RealGetContents()
  File "D:\python\Lib\zipfile.py", line 1379, in _RealGetContents
    raise BadZipFile("File is not a zip file")
zipfile.BadZipFile: File is not a zip file

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\pythonlianxi\day23\基于langchian的智慧工厂知识助手实战\xianmu\main.py", line 165, in text_spliter_add
    shutil.rmtree(kb_dir)
  File "D:\python\Lib\shutil.py", line 787, in rmtree
    return _rmtree_unsafe(path, onerror)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\python\Lib\shutil.py", line 634, in _rmtree_unsafe
    onerror(os.unlink, fullname, sys.exc_info())
  File "D:\python\Lib\shutil.py", line 632, in _rmtree_unsafe
    os.unlink(fullname)
PermissionError: [WinError 32] 另一个程序正在使用此文件，进程无法访问。: 'D:\\pythonlianxi\\day23\\基于langchian的智慧工厂知识助手实战\\xianmu\\xiangliang\\chroma.sqlite3'
2025-10-30 15:34:09,546 - travel - INFO - Langchain代理初始化成功
2025-10-30 16:10:44,643 - chromadb.telemetry.product.posthog - INFO - Anonymized telemetry enabled. See                     https://docs.trychroma.com/telemetry for more information.
2025-10-30 16:10:48,468 - travel - ERROR - 添加文件到知识库失败：File is not a zip file
2025-10-30 16:10:48,468 - travel - ERROR - File is not a zip file
Traceback (most recent call last):
  File "D:\pythonlianxi\day23\基于langchian的智慧工厂知识助手实战\xianmu\main.py", line 125, in text_spliter_add
    doc = loader.load()
          ^^^^^^^^^^^^^
  File "D:\moxingxunihuanjing\mash3\Lib\site-packages\langchain_community\document_loaders\word_document.py", line 61, in load
    page_content=docx2txt.process(self.file_path),
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\moxingxunihuanjing\mash3\Lib\site-packages\docx2txt\docx2txt.py", line 76, in process
    zipf = zipfile.ZipFile(docx)
           ^^^^^^^^^^^^^^^^^^^^^
  File "D:\python\Lib\zipfile.py", line 1312, in __init__
    self._RealGetContents()
  File "D:\python\Lib\zipfile.py", line 1379, in _RealGetContents
    raise BadZipFile("File is not a zip file")
zipfile.BadZipFile: File is not a zip file
2025-10-30 16:10:48,470 - travel - ERROR - 重置数据库失败：[WinError 32] 另一个程序正在使用此文件，进程无法访问。: 'D:\\pythonlianxi\\day23\\基于langchian的智慧工厂知识助手实战\\xianmu\\xiangliang\\chroma.sqlite3'
2025-10-30 16:10:48,471 - travel - ERROR - [WinError 32] 另一个程序正在使用此文件，进程无法访问。: 'D:\\pythonlianxi\\day23\\基于langchian的智慧工厂知识助手实战\\xianmu\\xiangliang\\chroma.sqlite3'
Traceback (most recent call last):
  File "D:\pythonlianxi\day23\基于langchian的智慧工厂知识助手实战\xianmu\main.py", line 125, in text_spliter_add
    doc = loader.load()
          ^^^^^^^^^^^^^
  File "D:\moxingxunihuanjing\mash3\Lib\site-packages\langchain_community\document_loaders\word_document.py", line 61, in load
    page_content=docx2txt.process(self.file_path),
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\moxingxunihuanjing\mash3\Lib\site-packages\docx2txt\docx2txt.py", line 76, in process
    zipf = zipfile.ZipFile(docx)
           ^^^^^^^^^^^^^^^^^^^^^
  File "D:\python\Lib\zipfile.py", line 1312, in __init__
    self._RealGetContents()
  File "D:\python\Lib\zipfile.py", line 1379, in _RealGetContents
    raise BadZipFile("File is not a zip file")
zipfile.BadZipFile: File is not a zip file

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\pythonlianxi\day23\基于langchian的智慧工厂知识助手实战\xianmu\main.py", line 165, in text_spliter_add
    shutil.rmtree(kb_dir)
  File "D:\python\Lib\shutil.py", line 787, in rmtree
    return _rmtree_unsafe(path, onerror)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\python\Lib\shutil.py", line 634, in _rmtree_unsafe
    onerror(os.unlink, fullname, sys.exc_info())
  File "D:\python\Lib\shutil.py", line 632, in _rmtree_unsafe
    os.unlink(fullname)
PermissionError: [WinError 32] 另一个程序正在使用此文件，进程无法访问。: 'D:\\pythonlianxi\\day23\\基于langchian的智慧工厂知识助手实战\\xianmu\\xiangliang\\chroma.sqlite3'
2025-10-30 16:10:50,104 - travel - INFO - Langchain代理初始化成功
2025-10-30 16:14:02,526 - chromadb.telemetry.product.posthog - INFO - Anonymized telemetry enabled. See                     https://docs.trychroma.com/telemetry for more information.
2025-10-30 16:14:07,368 - travel - ERROR - 添加文件到知识库失败：File is not a zip file
2025-10-30 16:14:07,369 - travel - ERROR - File is not a zip file
Traceback (most recent call last):
  File "D:\pythonlianxi\day23\基于langchian的智慧工厂知识助手实战\xianmu\main.py", line 125, in text_spliter_add
    doc = loader.load()
          ^^^^^^^^^^^^^
  File "D:\moxingxunihuanjing\mash3\Lib\site-packages\langchain_community\document_loaders\word_document.py", line 61, in load
    page_content=docx2txt.process(self.file_path),
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\moxingxunihuanjing\mash3\Lib\site-packages\docx2txt\docx2txt.py", line 76, in process
    zipf = zipfile.ZipFile(docx)
           ^^^^^^^^^^^^^^^^^^^^^
  File "D:\python\Lib\zipfile.py", line 1312, in __init__
    self._RealGetContents()
  File "D:\python\Lib\zipfile.py", line 1379, in _RealGetContents
    raise BadZipFile("File is not a zip file")
zipfile.BadZipFile: File is not a zip file
2025-10-30 16:14:07,371 - travel - ERROR - 重置数据库失败：[WinError 32] 另一个程序正在使用此文件，进程无法访问。: 'D:\\pythonlianxi\\day23\\基于langchian的智慧工厂知识助手实战\\xianmu\\xiangliang\\chroma.sqlite3'
2025-10-30 16:14:07,371 - travel - ERROR - [WinError 32] 另一个程序正在使用此文件，进程无法访问。: 'D:\\pythonlianxi\\day23\\基于langchian的智慧工厂知识助手实战\\xianmu\\xiangliang\\chroma.sqlite3'
Traceback (most recent call last):
  File "D:\pythonlianxi\day23\基于langchian的智慧工厂知识助手实战\xianmu\main.py", line 125, in text_spliter_add
    doc = loader.load()
          ^^^^^^^^^^^^^
  File "D:\moxingxunihuanjing\mash3\Lib\site-packages\langchain_community\document_loaders\word_document.py", line 61, in load
    page_content=docx2txt.process(self.file_path),
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\moxingxunihuanjing\mash3\Lib\site-packages\docx2txt\docx2txt.py", line 76, in process
    zipf = zipfile.ZipFile(docx)
           ^^^^^^^^^^^^^^^^^^^^^
  File "D:\python\Lib\zipfile.py", line 1312, in __init__
    self._RealGetContents()
  File "D:\python\Lib\zipfile.py", line 1379, in _RealGetContents
    raise BadZipFile("File is not a zip file")
zipfile.BadZipFile: File is not a zip file

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\pythonlianxi\day23\基于langchian的智慧工厂知识助手实战\xianmu\main.py", line 165, in text_spliter_add
    shutil.rmtree(kb_dir)
  File "D:\python\Lib\shutil.py", line 787, in rmtree
    return _rmtree_unsafe(path, onerror)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\python\Lib\shutil.py", line 634, in _rmtree_unsafe
    onerror(os.unlink, fullname, sys.exc_info())
  File "D:\python\Lib\shutil.py", line 632, in _rmtree_unsafe
    os.unlink(fullname)
PermissionError: [WinError 32] 另一个程序正在使用此文件，进程无法访问。: 'D:\\pythonlianxi\\day23\\基于langchian的智慧工厂知识助手实战\\xianmu\\xiangliang\\chroma.sqlite3'
2025-10-30 16:14:09,306 - travel - INFO - Langchain代理初始化成功
2025-10-30 16:14:49,552 - chromadb.telemetry.product.posthog - INFO - Anonymized telemetry enabled. See                     https://docs.trychroma.com/telemetry for more information.
2025-10-30 16:14:52,596 - travel - ERROR - 添加文件到知识库失败：File is not a zip file
2025-10-30 16:14:52,596 - travel - ERROR - File is not a zip file
Traceback (most recent call last):
  File "D:\pythonlianxi\day23\基于langchian的智慧工厂知识助手实战\xianmu\main.py", line 125, in text_spliter_add
    doc = loader.load()
          ^^^^^^^^^^^^^
  File "D:\moxingxunihuanjing\mash3\Lib\site-packages\langchain_community\document_loaders\word_document.py", line 61, in load
    page_content=docx2txt.process(self.file_path),
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\moxingxunihuanjing\mash3\Lib\site-packages\docx2txt\docx2txt.py", line 76, in process
    zipf = zipfile.ZipFile(docx)
           ^^^^^^^^^^^^^^^^^^^^^
  File "D:\python\Lib\zipfile.py", line 1312, in __init__
    self._RealGetContents()
  File "D:\python\Lib\zipfile.py", line 1379, in _RealGetContents
    raise BadZipFile("File is not a zip file")
zipfile.BadZipFile: File is not a zip file
2025-10-30 16:14:52,598 - travel - ERROR - 重置数据库失败：[WinError 32] 另一个程序正在使用此文件，进程无法访问。: 'D:\\pythonlianxi\\day23\\基于langchian的智慧工厂知识助手实战\\xianmu\\xiangliang\\chroma.sqlite3'
2025-10-30 16:14:52,598 - travel - ERROR - [WinError 32] 另一个程序正在使用此文件，进程无法访问。: 'D:\\pythonlianxi\\day23\\基于langchian的智慧工厂知识助手实战\\xianmu\\xiangliang\\chroma.sqlite3'
Traceback (most recent call last):
  File "D:\pythonlianxi\day23\基于langchian的智慧工厂知识助手实战\xianmu\main.py", line 125, in text_spliter_add
    doc = loader.load()
          ^^^^^^^^^^^^^
  File "D:\moxingxunihuanjing\mash3\Lib\site-packages\langchain_community\document_loaders\word_document.py", line 61, in load
    page_content=docx2txt.process(self.file_path),
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\moxingxunihuanjing\mash3\Lib\site-packages\docx2txt\docx2txt.py", line 76, in process
    zipf = zipfile.ZipFile(docx)
           ^^^^^^^^^^^^^^^^^^^^^
  File "D:\python\Lib\zipfile.py", line 1312, in __init__
    self._RealGetContents()
  File "D:\python\Lib\zipfile.py", line 1379, in _RealGetContents
    raise BadZipFile("File is not a zip file")
zipfile.BadZipFile: File is not a zip file

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\pythonlianxi\day23\基于langchian的智慧工厂知识助手实战\xianmu\main.py", line 165, in text_spliter_add
    shutil.rmtree(kb_dir)
  File "D:\python\Lib\shutil.py", line 787, in rmtree
    return _rmtree_unsafe(path, onerror)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\python\Lib\shutil.py", line 634, in _rmtree_unsafe
    onerror(os.unlink, fullname, sys.exc_info())
  File "D:\python\Lib\shutil.py", line 632, in _rmtree_unsafe
    os.unlink(fullname)
PermissionError: [WinError 32] 另一个程序正在使用此文件，进程无法访问。: 'D:\\pythonlianxi\\day23\\基于langchian的智慧工厂知识助手实战\\xianmu\\xiangliang\\chroma.sqlite3'
2025-10-30 16:14:54,154 - travel - INFO - Langchain代理初始化成功
2025-10-30 16:17:43,104 - chromadb.telemetry.product.posthog - INFO - Anonymized telemetry enabled. See                     https://docs.trychroma.com/telemetry for more information.
2025-10-30 16:17:46,041 - travel - ERROR - 添加文件到知识库失败：File is not a zip file
2025-10-30 16:17:46,041 - travel - ERROR - File is not a zip file
Traceback (most recent call last):
  File "D:\pythonlianxi\day23\基于langchian的智慧工厂知识助手实战\xianmu\main.py", line 125, in text_spliter_add
    doc = loader.load()
          ^^^^^^^^^^^^^
  File "D:\moxingxunihuanjing\mash3\Lib\site-packages\langchain_community\document_loaders\word_document.py", line 61, in load
    page_content=docx2txt.process(self.file_path),
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\moxingxunihuanjing\mash3\Lib\site-packages\docx2txt\docx2txt.py", line 76, in process
    zipf = zipfile.ZipFile(docx)
           ^^^^^^^^^^^^^^^^^^^^^
  File "D:\python\Lib\zipfile.py", line 1312, in __init__
    self._RealGetContents()
  File "D:\python\Lib\zipfile.py", line 1379, in _RealGetContents
    raise BadZipFile("File is not a zip file")
zipfile.BadZipFile: File is not a zip file
2025-10-30 16:17:46,043 - travel - ERROR - 重置数据库失败：[WinError 32] 另一个程序正在使用此文件，进程无法访问。: 'D:\\pythonlianxi\\day23\\基于langchian的智慧工厂知识助手实战\\xianmu\\xiangliang\\chroma.sqlite3'
2025-10-30 16:17:46,043 - travel - ERROR - [WinError 32] 另一个程序正在使用此文件，进程无法访问。: 'D:\\pythonlianxi\\day23\\基于langchian的智慧工厂知识助手实战\\xianmu\\xiangliang\\chroma.sqlite3'
Traceback (most recent call last):
  File "D:\pythonlianxi\day23\基于langchian的智慧工厂知识助手实战\xianmu\main.py", line 125, in text_spliter_add
    doc = loader.load()
          ^^^^^^^^^^^^^
  File "D:\moxingxunihuanjing\mash3\Lib\site-packages\langchain_community\document_loaders\word_document.py", line 61, in load
    page_content=docx2txt.process(self.file_path),
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\moxingxunihuanjing\mash3\Lib\site-packages\docx2txt\docx2txt.py", line 76, in process
    zipf = zipfile.ZipFile(docx)
           ^^^^^^^^^^^^^^^^^^^^^
  File "D:\python\Lib\zipfile.py", line 1312, in __init__
    self._RealGetContents()
  File "D:\python\Lib\zipfile.py", line 1379, in _RealGetContents
    raise BadZipFile("File is not a zip file")
zipfile.BadZipFile: File is not a zip file

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\pythonlianxi\day23\基于langchian的智慧工厂知识助手实战\xianmu\main.py", line 165, in text_spliter_add
    shutil.rmtree(kb_dir)
  File "D:\python\Lib\shutil.py", line 787, in rmtree
    return _rmtree_unsafe(path, onerror)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\python\Lib\shutil.py", line 634, in _rmtree_unsafe
    onerror(os.unlink, fullname, sys.exc_info())
  File "D:\python\Lib\shutil.py", line 632, in _rmtree_unsafe
    os.unlink(fullname)
PermissionError: [WinError 32] 另一个程序正在使用此文件，进程无法访问。: 'D:\\pythonlianxi\\day23\\基于langchian的智慧工厂知识助手实战\\xianmu\\xiangliang\\chroma.sqlite3'
2025-10-30 16:17:47,508 - travel - INFO - Langchain代理初始化成功
2025-10-30 16:18:03,389 - httpx - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-30 16:18:21,938 - httpx - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-30 16:18:22,845 - httpx - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-30 16:18:24,744 - httpx - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-30 16:18:26,374 - httpx - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-30 16:21:47,717 - chromadb.telemetry.product.posthog - INFO - Anonymized telemetry enabled. See                     https://docs.trychroma.com/telemetry for more information.
2025-10-30 16:21:50,344 - travel - ERROR - 添加文件到知识库失败：File is not a zip file
2025-10-30 16:21:50,344 - travel - ERROR - File is not a zip file
Traceback (most recent call last):
  File "D:\pythonlianxi\day23\基于langchian的智慧工厂知识助手实战\xianmu\main.py", line 125, in text_spliter_add
    doc = loader.load()
          ^^^^^^^^^^^^^
  File "D:\moxingxunihuanjing\mash3\Lib\site-packages\langchain_community\document_loaders\word_document.py", line 61, in load
    page_content=docx2txt.process(self.file_path),
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\moxingxunihuanjing\mash3\Lib\site-packages\docx2txt\docx2txt.py", line 76, in process
    zipf = zipfile.ZipFile(docx)
           ^^^^^^^^^^^^^^^^^^^^^
  File "D:\python\Lib\zipfile.py", line 1312, in __init__
    self._RealGetContents()
  File "D:\python\Lib\zipfile.py", line 1379, in _RealGetContents
    raise BadZipFile("File is not a zip file")
zipfile.BadZipFile: File is not a zip file
2025-10-30 16:21:50,346 - travel - ERROR - 重置数据库失败：[WinError 32] 另一个程序正在使用此文件，进程无法访问。: 'D:\\pythonlianxi\\day23\\基于langchian的智慧工厂知识助手实战\\xianmu\\xiangliang\\chroma.sqlite3'
2025-10-30 16:21:50,346 - travel - ERROR - [WinError 32] 另一个程序正在使用此文件，进程无法访问。: 'D:\\pythonlianxi\\day23\\基于langchian的智慧工厂知识助手实战\\xianmu\\xiangliang\\chroma.sqlite3'
Traceback (most recent call last):
  File "D:\pythonlianxi\day23\基于langchian的智慧工厂知识助手实战\xianmu\main.py", line 125, in text_spliter_add
    doc = loader.load()
          ^^^^^^^^^^^^^
  File "D:\moxingxunihuanjing\mash3\Lib\site-packages\langchain_community\document_loaders\word_document.py", line 61, in load
    page_content=docx2txt.process(self.file_path),
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\moxingxunihuanjing\mash3\Lib\site-packages\docx2txt\docx2txt.py", line 76, in process
    zipf = zipfile.ZipFile(docx)
           ^^^^^^^^^^^^^^^^^^^^^
  File "D:\python\Lib\zipfile.py", line 1312, in __init__
    self._RealGetContents()
  File "D:\python\Lib\zipfile.py", line 1379, in _RealGetContents
    raise BadZipFile("File is not a zip file")
zipfile.BadZipFile: File is not a zip file

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\pythonlianxi\day23\基于langchian的智慧工厂知识助手实战\xianmu\main.py", line 165, in text_spliter_add
    shutil.rmtree(kb_dir)
  File "D:\python\Lib\shutil.py", line 787, in rmtree
    return _rmtree_unsafe(path, onerror)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\python\Lib\shutil.py", line 634, in _rmtree_unsafe
    onerror(os.unlink, fullname, sys.exc_info())
  File "D:\python\Lib\shutil.py", line 632, in _rmtree_unsafe
    os.unlink(fullname)
PermissionError: [WinError 32] 另一个程序正在使用此文件，进程无法访问。: 'D:\\pythonlianxi\\day23\\基于langchian的智慧工厂知识助手实战\\xianmu\\xiangliang\\chroma.sqlite3'
2025-10-30 16:21:51,840 - travel - INFO - Langchain代理初始化成功
2025-10-30 16:22:30,497 - chromadb.telemetry.product.posthog - INFO - Anonymized telemetry enabled. See                     https://docs.trychroma.com/telemetry for more information.
2025-10-30 16:22:34,182 - travel - ERROR - 添加文件到知识库失败：File is not a zip file
2025-10-30 16:22:34,183 - travel - ERROR - File is not a zip file
Traceback (most recent call last):
  File "D:\pythonlianxi\day23\基于langchian的智慧工厂知识助手实战\xianmu\main.py", line 125, in text_spliter_add
    doc = loader.load()
          ^^^^^^^^^^^^^
  File "D:\moxingxunihuanjing\mash3\Lib\site-packages\langchain_community\document_loaders\word_document.py", line 61, in load
    page_content=docx2txt.process(self.file_path),
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\moxingxunihuanjing\mash3\Lib\site-packages\docx2txt\docx2txt.py", line 76, in process
    zipf = zipfile.ZipFile(docx)
           ^^^^^^^^^^^^^^^^^^^^^
  File "D:\python\Lib\zipfile.py", line 1312, in __init__
    self._RealGetContents()
  File "D:\python\Lib\zipfile.py", line 1379, in _RealGetContents
    raise BadZipFile("File is not a zip file")
zipfile.BadZipFile: File is not a zip file
2025-10-30 16:22:34,185 - travel - ERROR - 重置数据库失败：[WinError 32] 另一个程序正在使用此文件，进程无法访问。: 'D:\\pythonlianxi\\day23\\基于langchian的智慧工厂知识助手实战\\xianmu\\xiangliang\\chroma.sqlite3'
2025-10-30 16:22:34,185 - travel - ERROR - [WinError 32] 另一个程序正在使用此文件，进程无法访问。: 'D:\\pythonlianxi\\day23\\基于langchian的智慧工厂知识助手实战\\xianmu\\xiangliang\\chroma.sqlite3'
Traceback (most recent call last):
  File "D:\pythonlianxi\day23\基于langchian的智慧工厂知识助手实战\xianmu\main.py", line 125, in text_spliter_add
    doc = loader.load()
          ^^^^^^^^^^^^^
  File "D:\moxingxunihuanjing\mash3\Lib\site-packages\langchain_community\document_loaders\word_document.py", line 61, in load
    page_content=docx2txt.process(self.file_path),
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\moxingxunihuanjing\mash3\Lib\site-packages\docx2txt\docx2txt.py", line 76, in process
    zipf = zipfile.ZipFile(docx)
           ^^^^^^^^^^^^^^^^^^^^^
  File "D:\python\Lib\zipfile.py", line 1312, in __init__
    self._RealGetContents()
  File "D:\python\Lib\zipfile.py", line 1379, in _RealGetContents
    raise BadZipFile("File is not a zip file")
zipfile.BadZipFile: File is not a zip file

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\pythonlianxi\day23\基于langchian的智慧工厂知识助手实战\xianmu\main.py", line 165, in text_spliter_add
    shutil.rmtree(kb_dir)
  File "D:\python\Lib\shutil.py", line 787, in rmtree
    return _rmtree_unsafe(path, onerror)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\python\Lib\shutil.py", line 634, in _rmtree_unsafe
    onerror(os.unlink, fullname, sys.exc_info())
  File "D:\python\Lib\shutil.py", line 632, in _rmtree_unsafe
    os.unlink(fullname)
PermissionError: [WinError 32] 另一个程序正在使用此文件，进程无法访问。: 'D:\\pythonlianxi\\day23\\基于langchian的智慧工厂知识助手实战\\xianmu\\xiangliang\\chroma.sqlite3'
2025-10-30 16:22:36,211 - travel - INFO - Langchain代理初始化成功
2025-10-30 16:23:25,226 - chromadb.telemetry.product.posthog - INFO - Anonymized telemetry enabled. See                     https://docs.trychroma.com/telemetry for more information.
2025-10-30 16:23:28,329 - travel - ERROR - 添加文件到知识库失败：File is not a zip file
2025-10-30 16:23:28,329 - travel - ERROR - File is not a zip file
Traceback (most recent call last):
  File "D:\pythonlianxi\day23\基于langchian的智慧工厂知识助手实战\xianmu\main.py", line 125, in text_spliter_add
    doc = loader.load()
          ^^^^^^^^^^^^^
  File "D:\moxingxunihuanjing\mash3\Lib\site-packages\langchain_community\document_loaders\word_document.py", line 61, in load
    page_content=docx2txt.process(self.file_path),
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\moxingxunihuanjing\mash3\Lib\site-packages\docx2txt\docx2txt.py", line 76, in process
    zipf = zipfile.ZipFile(docx)
           ^^^^^^^^^^^^^^^^^^^^^
  File "D:\python\Lib\zipfile.py", line 1312, in __init__
    self._RealGetContents()
  File "D:\python\Lib\zipfile.py", line 1379, in _RealGetContents
    raise BadZipFile("File is not a zip file")
zipfile.BadZipFile: File is not a zip file
2025-10-30 16:23:28,332 - travel - ERROR - 重置数据库失败：[WinError 32] 另一个程序正在使用此文件，进程无法访问。: 'D:\\pythonlianxi\\day23\\基于langchian的智慧工厂知识助手实战\\xianmu\\xiangliang\\chroma.sqlite3'
2025-10-30 16:23:28,332 - travel - ERROR - [WinError 32] 另一个程序正在使用此文件，进程无法访问。: 'D:\\pythonlianxi\\day23\\基于langchian的智慧工厂知识助手实战\\xianmu\\xiangliang\\chroma.sqlite3'
Traceback (most recent call last):
  File "D:\pythonlianxi\day23\基于langchian的智慧工厂知识助手实战\xianmu\main.py", line 125, in text_spliter_add
    doc = loader.load()
          ^^^^^^^^^^^^^
  File "D:\moxingxunihuanjing\mash3\Lib\site-packages\langchain_community\document_loaders\word_document.py", line 61, in load
    page_content=docx2txt.process(self.file_path),
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\moxingxunihuanjing\mash3\Lib\site-packages\docx2txt\docx2txt.py", line 76, in process
    zipf = zipfile.ZipFile(docx)
           ^^^^^^^^^^^^^^^^^^^^^
  File "D:\python\Lib\zipfile.py", line 1312, in __init__
    self._RealGetContents()
  File "D:\python\Lib\zipfile.py", line 1379, in _RealGetContents
    raise BadZipFile("File is not a zip file")
zipfile.BadZipFile: File is not a zip file

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\pythonlianxi\day23\基于langchian的智慧工厂知识助手实战\xianmu\main.py", line 165, in text_spliter_add
    shutil.rmtree(kb_dir)
  File "D:\python\Lib\shutil.py", line 787, in rmtree
    return _rmtree_unsafe(path, onerror)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\python\Lib\shutil.py", line 634, in _rmtree_unsafe
    onerror(os.unlink, fullname, sys.exc_info())
  File "D:\python\Lib\shutil.py", line 632, in _rmtree_unsafe
    os.unlink(fullname)
PermissionError: [WinError 32] 另一个程序正在使用此文件，进程无法访问。: 'D:\\pythonlianxi\\day23\\基于langchian的智慧工厂知识助手实战\\xianmu\\xiangliang\\chroma.sqlite3'
2025-10-30 16:23:30,070 - travel - INFO - Langchain代理初始化成功
2025-10-30 16:28:20,701 - chromadb.telemetry.product.posthog - INFO - Anonymized telemetry enabled. See                     https://docs.trychroma.com/telemetry for more information.
2025-10-30 16:28:23,341 - travel - ERROR - 添加文件到知识库失败：File is not a zip file
2025-10-30 16:28:23,341 - travel - ERROR - File is not a zip file
Traceback (most recent call last):
  File "D:\pythonlianxi\day23\基于langchian的智慧工厂知识助手实战\xianmu\main.py", line 125, in text_spliter_add
    doc = loader.load()
          ^^^^^^^^^^^^^
  File "D:\moxingxunihuanjing\mash3\Lib\site-packages\langchain_community\document_loaders\word_document.py", line 61, in load
    page_content=docx2txt.process(self.file_path),
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\moxingxunihuanjing\mash3\Lib\site-packages\docx2txt\docx2txt.py", line 76, in process
    zipf = zipfile.ZipFile(docx)
           ^^^^^^^^^^^^^^^^^^^^^
  File "D:\python\Lib\zipfile.py", line 1312, in __init__
    self._RealGetContents()
  File "D:\python\Lib\zipfile.py", line 1379, in _RealGetContents
    raise BadZipFile("File is not a zip file")
zipfile.BadZipFile: File is not a zip file
2025-10-30 16:28:23,344 - travel - ERROR - 重置数据库失败：[WinError 32] 另一个程序正在使用此文件，进程无法访问。: 'D:\\pythonlianxi\\day23\\基于langchian的智慧工厂知识助手实战\\xianmu\\xiangliang\\chroma.sqlite3'
2025-10-30 16:28:23,344 - travel - ERROR - [WinError 32] 另一个程序正在使用此文件，进程无法访问。: 'D:\\pythonlianxi\\day23\\基于langchian的智慧工厂知识助手实战\\xianmu\\xiangliang\\chroma.sqlite3'
Traceback (most recent call last):
  File "D:\pythonlianxi\day23\基于langchian的智慧工厂知识助手实战\xianmu\main.py", line 125, in text_spliter_add
    doc = loader.load()
          ^^^^^^^^^^^^^
  File "D:\moxingxunihuanjing\mash3\Lib\site-packages\langchain_community\document_loaders\word_document.py", line 61, in load
    page_content=docx2txt.process(self.file_path),
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\moxingxunihuanjing\mash3\Lib\site-packages\docx2txt\docx2txt.py", line 76, in process
    zipf = zipfile.ZipFile(docx)
           ^^^^^^^^^^^^^^^^^^^^^
  File "D:\python\Lib\zipfile.py", line 1312, in __init__
    self._RealGetContents()
  File "D:\python\Lib\zipfile.py", line 1379, in _RealGetContents
    raise BadZipFile("File is not a zip file")
zipfile.BadZipFile: File is not a zip file

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\pythonlianxi\day23\基于langchian的智慧工厂知识助手实战\xianmu\main.py", line 165, in text_spliter_add
    shutil.rmtree(kb_dir)
  File "D:\python\Lib\shutil.py", line 787, in rmtree
    return _rmtree_unsafe(path, onerror)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\python\Lib\shutil.py", line 634, in _rmtree_unsafe
    onerror(os.unlink, fullname, sys.exc_info())
  File "D:\python\Lib\shutil.py", line 632, in _rmtree_unsafe
    os.unlink(fullname)
PermissionError: [WinError 32] 另一个程序正在使用此文件，进程无法访问。: 'D:\\pythonlianxi\\day23\\基于langchian的智慧工厂知识助手实战\\xianmu\\xiangliang\\chroma.sqlite3'
2025-10-30 16:28:24,555 - travel - INFO - Langchain代理初始化成功
2025-10-30 16:31:07,406 - chromadb.telemetry.product.posthog - INFO - Anonymized telemetry enabled. See                     https://docs.trychroma.com/telemetry for more information.
2025-10-30 16:31:10,269 - travel - ERROR - 添加文件到知识库失败：File is not a zip file
2025-10-30 16:31:10,269 - travel - ERROR - File is not a zip file
Traceback (most recent call last):
  File "D:\pythonlianxi\day23\基于langchian的智慧工厂知识助手实战\xianmu\main.py", line 125, in text_spliter_add
    doc = loader.load()
          ^^^^^^^^^^^^^
  File "D:\moxingxunihuanjing\mash3\Lib\site-packages\langchain_community\document_loaders\word_document.py", line 61, in load
    page_content=docx2txt.process(self.file_path),
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\moxingxunihuanjing\mash3\Lib\site-packages\docx2txt\docx2txt.py", line 76, in process
    zipf = zipfile.ZipFile(docx)
           ^^^^^^^^^^^^^^^^^^^^^
  File "D:\python\Lib\zipfile.py", line 1312, in __init__
    self._RealGetContents()
  File "D:\python\Lib\zipfile.py", line 1379, in _RealGetContents
    raise BadZipFile("File is not a zip file")
zipfile.BadZipFile: File is not a zip file
2025-10-30 16:31:10,271 - travel - ERROR - 重置数据库失败：[WinError 32] 另一个程序正在使用此文件，进程无法访问。: 'D:\\pythonlianxi\\day23\\基于langchian的智慧工厂知识助手实战\\xianmu\\xiangliang\\chroma.sqlite3'
2025-10-30 16:31:10,271 - travel - ERROR - [WinError 32] 另一个程序正在使用此文件，进程无法访问。: 'D:\\pythonlianxi\\day23\\基于langchian的智慧工厂知识助手实战\\xianmu\\xiangliang\\chroma.sqlite3'
Traceback (most recent call last):
  File "D:\pythonlianxi\day23\基于langchian的智慧工厂知识助手实战\xianmu\main.py", line 125, in text_spliter_add
    doc = loader.load()
          ^^^^^^^^^^^^^
  File "D:\moxingxunihuanjing\mash3\Lib\site-packages\langchain_community\document_loaders\word_document.py", line 61, in load
    page_content=docx2txt.process(self.file_path),
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\moxingxunihuanjing\mash3\Lib\site-packages\docx2txt\docx2txt.py", line 76, in process
    zipf = zipfile.ZipFile(docx)
           ^^^^^^^^^^^^^^^^^^^^^
  File "D:\python\Lib\zipfile.py", line 1312, in __init__
    self._RealGetContents()
  File "D:\python\Lib\zipfile.py", line 1379, in _RealGetContents
    raise BadZipFile("File is not a zip file")
zipfile.BadZipFile: File is not a zip file

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\pythonlianxi\day23\基于langchian的智慧工厂知识助手实战\xianmu\main.py", line 165, in text_spliter_add
    shutil.rmtree(kb_dir)
  File "D:\python\Lib\shutil.py", line 787, in rmtree
    return _rmtree_unsafe(path, onerror)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\python\Lib\shutil.py", line 634, in _rmtree_unsafe
    onerror(os.unlink, fullname, sys.exc_info())
  File "D:\python\Lib\shutil.py", line 632, in _rmtree_unsafe
    os.unlink(fullname)
PermissionError: [WinError 32] 另一个程序正在使用此文件，进程无法访问。: 'D:\\pythonlianxi\\day23\\基于langchian的智慧工厂知识助手实战\\xianmu\\xiangliang\\chroma.sqlite3'
2025-10-30 16:31:11,690 - travel - INFO - Langchain代理初始化成功
2025-10-30 16:32:22,471 - chromadb.telemetry.product.posthog - INFO - Anonymized telemetry enabled. See                     https://docs.trychroma.com/telemetry for more information.
2025-10-30 16:32:24,800 - travel - ERROR - 添加文件到知识库失败：File is not a zip file
2025-10-30 16:32:24,800 - travel - ERROR - File is not a zip file
Traceback (most recent call last):
  File "D:\pythonlianxi\day23\基于langchian的智慧工厂知识助手实战\xianmu\main.py", line 125, in text_spliter_add
    doc = loader.load()
          ^^^^^^^^^^^^^
  File "D:\moxingxunihuanjing\mash3\Lib\site-packages\langchain_community\document_loaders\word_document.py", line 61, in load
    page_content=docx2txt.process(self.file_path),
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\moxingxunihuanjing\mash3\Lib\site-packages\docx2txt\docx2txt.py", line 76, in process
    zipf = zipfile.ZipFile(docx)
           ^^^^^^^^^^^^^^^^^^^^^
  File "D:\python\Lib\zipfile.py", line 1312, in __init__
    self._RealGetContents()
  File "D:\python\Lib\zipfile.py", line 1379, in _RealGetContents
    raise BadZipFile("File is not a zip file")
zipfile.BadZipFile: File is not a zip file
2025-10-30 16:32:24,804 - travel - ERROR - 重置数据库失败：[WinError 32] 另一个程序正在使用此文件，进程无法访问。: 'D:\\pythonlianxi\\day23\\基于langchian的智慧工厂知识助手实战\\xianmu\\xiangliang\\chroma.sqlite3'
2025-10-30 16:32:24,804 - travel - ERROR - [WinError 32] 另一个程序正在使用此文件，进程无法访问。: 'D:\\pythonlianxi\\day23\\基于langchian的智慧工厂知识助手实战\\xianmu\\xiangliang\\chroma.sqlite3'
Traceback (most recent call last):
  File "D:\pythonlianxi\day23\基于langchian的智慧工厂知识助手实战\xianmu\main.py", line 125, in text_spliter_add
    doc = loader.load()
          ^^^^^^^^^^^^^
  File "D:\moxingxunihuanjing\mash3\Lib\site-packages\langchain_community\document_loaders\word_document.py", line 61, in load
    page_content=docx2txt.process(self.file_path),
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\moxingxunihuanjing\mash3\Lib\site-packages\docx2txt\docx2txt.py", line 76, in process
    zipf = zipfile.ZipFile(docx)
           ^^^^^^^^^^^^^^^^^^^^^
  File "D:\python\Lib\zipfile.py", line 1312, in __init__
    self._RealGetContents()
  File "D:\python\Lib\zipfile.py", line 1379, in _RealGetContents
    raise BadZipFile("File is not a zip file")
zipfile.BadZipFile: File is not a zip file

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\pythonlianxi\day23\基于langchian的智慧工厂知识助手实战\xianmu\main.py", line 165, in text_spliter_add
    shutil.rmtree(kb_dir)
  File "D:\python\Lib\shutil.py", line 787, in rmtree
    return _rmtree_unsafe(path, onerror)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\python\Lib\shutil.py", line 634, in _rmtree_unsafe
    onerror(os.unlink, fullname, sys.exc_info())
  File "D:\python\Lib\shutil.py", line 632, in _rmtree_unsafe
    os.unlink(fullname)
PermissionError: [WinError 32] 另一个程序正在使用此文件，进程无法访问。: 'D:\\pythonlianxi\\day23\\基于langchian的智慧工厂知识助手实战\\xianmu\\xiangliang\\chroma.sqlite3'
2025-10-30 16:32:26,136 - travel - INFO - Langchain代理初始化成功
2025-10-30 16:44:36,315 - chromadb.telemetry.product.posthog - INFO - Anonymized telemetry enabled. See                     https://docs.trychroma.com/telemetry for more information.
2025-10-30 16:44:39,410 - travel - ERROR - 添加文件到知识库失败：File is not a zip file
2025-10-30 16:44:39,410 - travel - ERROR - File is not a zip file
Traceback (most recent call last):
  File "D:\pythonlianxi\day23\基于langchian的智慧工厂知识助手实战\xianmu\main.py", line 125, in text_spliter_add
    doc = loader.load()
          ^^^^^^^^^^^^^
  File "D:\moxingxunihuanjing\mash3\Lib\site-packages\langchain_community\document_loaders\word_document.py", line 61, in load
    page_content=docx2txt.process(self.file_path),
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\moxingxunihuanjing\mash3\Lib\site-packages\docx2txt\docx2txt.py", line 76, in process
    zipf = zipfile.ZipFile(docx)
           ^^^^^^^^^^^^^^^^^^^^^
  File "D:\python\Lib\zipfile.py", line 1312, in __init__
    self._RealGetContents()
  File "D:\python\Lib\zipfile.py", line 1379, in _RealGetContents
    raise BadZipFile("File is not a zip file")
zipfile.BadZipFile: File is not a zip file
2025-10-30 16:44:39,413 - travel - ERROR - 重置数据库失败：[WinError 32] 另一个程序正在使用此文件，进程无法访问。: 'D:\\pythonlianxi\\day23\\基于langchian的智慧工厂知识助手实战\\xianmu\\xiangliang\\chroma.sqlite3'
2025-10-30 16:44:39,413 - travel - ERROR - [WinError 32] 另一个程序正在使用此文件，进程无法访问。: 'D:\\pythonlianxi\\day23\\基于langchian的智慧工厂知识助手实战\\xianmu\\xiangliang\\chroma.sqlite3'
Traceback (most recent call last):
  File "D:\pythonlianxi\day23\基于langchian的智慧工厂知识助手实战\xianmu\main.py", line 125, in text_spliter_add
    doc = loader.load()
          ^^^^^^^^^^^^^
  File "D:\moxingxunihuanjing\mash3\Lib\site-packages\langchain_community\document_loaders\word_document.py", line 61, in load
    page_content=docx2txt.process(self.file_path),
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\moxingxunihuanjing\mash3\Lib\site-packages\docx2txt\docx2txt.py", line 76, in process
    zipf = zipfile.ZipFile(docx)
           ^^^^^^^^^^^^^^^^^^^^^
  File "D:\python\Lib\zipfile.py", line 1312, in __init__
    self._RealGetContents()
  File "D:\python\Lib\zipfile.py", line 1379, in _RealGetContents
    raise BadZipFile("File is not a zip file")
zipfile.BadZipFile: File is not a zip file

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\pythonlianxi\day23\基于langchian的智慧工厂知识助手实战\xianmu\main.py", line 165, in text_spliter_add
    shutil.rmtree(kb_dir)
  File "D:\python\Lib\shutil.py", line 787, in rmtree
    return _rmtree_unsafe(path, onerror)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\python\Lib\shutil.py", line 634, in _rmtree_unsafe
    onerror(os.unlink, fullname, sys.exc_info())
  File "D:\python\Lib\shutil.py", line 632, in _rmtree_unsafe
    os.unlink(fullname)
PermissionError: [WinError 32] 另一个程序正在使用此文件，进程无法访问。: 'D:\\pythonlianxi\\day23\\基于langchian的智慧工厂知识助手实战\\xianmu\\xiangliang\\chroma.sqlite3'
2025-10-30 16:44:40,879 - travel - INFO - Langchain代理初始化成功
2025-10-30 16:45:27,376 - httpx - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-30 16:45:31,585 - httpx - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-30 16:45:32,074 - httpx - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-30 16:45:49,258 - httpx - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-30 16:45:49,839 - httpx - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-30 16:46:14,961 - httpx - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-30 16:46:15,661 - httpx - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-30 16:46:18,578 - httpx - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-30 16:46:39,383 - httpx - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-30 16:46:40,520 - httpx - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-30 16:46:42,221 - httpx - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-30 16:49:30,797 - chromadb.telemetry.product.posthog - INFO - Anonymized telemetry enabled. See                     https://docs.trychroma.com/telemetry for more information.
2025-10-30 16:49:33,706 - travel - ERROR - 添加文件到知识库失败：File is not a zip file
2025-10-30 16:49:33,706 - travel - ERROR - File is not a zip file
Traceback (most recent call last):
  File "D:\pythonlianxi\day23\基于langchian的智慧工厂知识助手实战\xianmu\main.py", line 125, in text_spliter_add
    doc = loader.load()
          ^^^^^^^^^^^^^
  File "D:\moxingxunihuanjing\mash3\Lib\site-packages\langchain_community\document_loaders\word_document.py", line 61, in load
    page_content=docx2txt.process(self.file_path),
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\moxingxunihuanjing\mash3\Lib\site-packages\docx2txt\docx2txt.py", line 76, in process
    zipf = zipfile.ZipFile(docx)
           ^^^^^^^^^^^^^^^^^^^^^
  File "D:\python\Lib\zipfile.py", line 1312, in __init__
    self._RealGetContents()
  File "D:\python\Lib\zipfile.py", line 1379, in _RealGetContents
    raise BadZipFile("File is not a zip file")
zipfile.BadZipFile: File is not a zip file
2025-10-30 16:49:33,708 - travel - ERROR - 重置数据库失败：[WinError 32] 另一个程序正在使用此文件，进程无法访问。: 'D:\\pythonlianxi\\day23\\基于langchian的智慧工厂知识助手实战\\xianmu\\xiangliang\\chroma.sqlite3'
2025-10-30 16:49:33,708 - travel - ERROR - [WinError 32] 另一个程序正在使用此文件，进程无法访问。: 'D:\\pythonlianxi\\day23\\基于langchian的智慧工厂知识助手实战\\xianmu\\xiangliang\\chroma.sqlite3'
Traceback (most recent call last):
  File "D:\pythonlianxi\day23\基于langchian的智慧工厂知识助手实战\xianmu\main.py", line 125, in text_spliter_add
    doc = loader.load()
          ^^^^^^^^^^^^^
  File "D:\moxingxunihuanjing\mash3\Lib\site-packages\langchain_community\document_loaders\word_document.py", line 61, in load
    page_content=docx2txt.process(self.file_path),
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\moxingxunihuanjing\mash3\Lib\site-packages\docx2txt\docx2txt.py", line 76, in process
    zipf = zipfile.ZipFile(docx)
           ^^^^^^^^^^^^^^^^^^^^^
  File "D:\python\Lib\zipfile.py", line 1312, in __init__
    self._RealGetContents()
  File "D:\python\Lib\zipfile.py", line 1379, in _RealGetContents
    raise BadZipFile("File is not a zip file")
zipfile.BadZipFile: File is not a zip file

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\pythonlianxi\day23\基于langchian的智慧工厂知识助手实战\xianmu\main.py", line 165, in text_spliter_add
    shutil.rmtree(kb_dir)
  File "D:\python\Lib\shutil.py", line 787, in rmtree
    return _rmtree_unsafe(path, onerror)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\python\Lib\shutil.py", line 634, in _rmtree_unsafe
    onerror(os.unlink, fullname, sys.exc_info())
  File "D:\python\Lib\shutil.py", line 632, in _rmtree_unsafe
    os.unlink(fullname)
PermissionError: [WinError 32] 另一个程序正在使用此文件，进程无法访问。: 'D:\\pythonlianxi\\day23\\基于langchian的智慧工厂知识助手实战\\xianmu\\xiangliang\\chroma.sqlite3'
2025-10-30 16:49:35,102 - travel - INFO - Langchain代理初始化成功
2025-10-30 16:51:56,635 - httpx - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-30 16:52:04,295 - httpx - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-30 16:52:05,230 - httpx - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-30 16:52:18,200 - httpx - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-30 16:52:19,269 - httpx - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-30 16:55:06,452 - chromadb.telemetry.product.posthog - INFO - Anonymized telemetry enabled. See                     https://docs.trychroma.com/telemetry for more information.
2025-10-30 16:55:09,729 - travel - ERROR - 添加文件到知识库失败：File is not a zip file
2025-10-30 16:55:09,730 - travel - ERROR - File is not a zip file
Traceback (most recent call last):
  File "D:\pythonlianxi\day23\基于langchian的智慧工厂知识助手实战\xianmu\main.py", line 125, in text_spliter_add
    doc = loader.load()
          ^^^^^^^^^^^^^
  File "D:\moxingxunihuanjing\mash3\Lib\site-packages\langchain_community\document_loaders\word_document.py", line 61, in load
    page_content=docx2txt.process(self.file_path),
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\moxingxunihuanjing\mash3\Lib\site-packages\docx2txt\docx2txt.py", line 76, in process
    zipf = zipfile.ZipFile(docx)
           ^^^^^^^^^^^^^^^^^^^^^
  File "D:\python\Lib\zipfile.py", line 1312, in __init__
    self._RealGetContents()
  File "D:\python\Lib\zipfile.py", line 1379, in _RealGetContents
    raise BadZipFile("File is not a zip file")
zipfile.BadZipFile: File is not a zip file
2025-10-30 16:55:09,732 - travel - ERROR - 重置数据库失败：[WinError 32] 另一个程序正在使用此文件，进程无法访问。: 'D:\\pythonlianxi\\day23\\基于langchian的智慧工厂知识助手实战\\xianmu\\xiangliang\\chroma.sqlite3'
2025-10-30 16:55:09,732 - travel - ERROR - [WinError 32] 另一个程序正在使用此文件，进程无法访问。: 'D:\\pythonlianxi\\day23\\基于langchian的智慧工厂知识助手实战\\xianmu\\xiangliang\\chroma.sqlite3'
Traceback (most recent call last):
  File "D:\pythonlianxi\day23\基于langchian的智慧工厂知识助手实战\xianmu\main.py", line 125, in text_spliter_add
    doc = loader.load()
          ^^^^^^^^^^^^^
  File "D:\moxingxunihuanjing\mash3\Lib\site-packages\langchain_community\document_loaders\word_document.py", line 61, in load
    page_content=docx2txt.process(self.file_path),
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\moxingxunihuanjing\mash3\Lib\site-packages\docx2txt\docx2txt.py", line 76, in process
    zipf = zipfile.ZipFile(docx)
           ^^^^^^^^^^^^^^^^^^^^^
  File "D:\python\Lib\zipfile.py", line 1312, in __init__
    self._RealGetContents()
  File "D:\python\Lib\zipfile.py", line 1379, in _RealGetContents
    raise BadZipFile("File is not a zip file")
zipfile.BadZipFile: File is not a zip file

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\pythonlianxi\day23\基于langchian的智慧工厂知识助手实战\xianmu\main.py", line 165, in text_spliter_add
    shutil.rmtree(kb_dir)
  File "D:\python\Lib\shutil.py", line 787, in rmtree
    return _rmtree_unsafe(path, onerror)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\python\Lib\shutil.py", line 634, in _rmtree_unsafe
    onerror(os.unlink, fullname, sys.exc_info())
  File "D:\python\Lib\shutil.py", line 632, in _rmtree_unsafe
    os.unlink(fullname)
PermissionError: [WinError 32] 另一个程序正在使用此文件，进程无法访问。: 'D:\\pythonlianxi\\day23\\基于langchian的智慧工厂知识助手实战\\xianmu\\xiangliang\\chroma.sqlite3'
2025-10-30 16:55:11,596 - travel - INFO - Langchain代理初始化成功
2025-10-30 16:55:38,745 - httpx - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-30 16:56:04,585 - httpx - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-30 16:56:05,126 - httpx - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-30 17:08:11,548 - chromadb.telemetry.product.posthog - INFO - Anonymized telemetry enabled. See                     https://docs.trychroma.com/telemetry for more information.
2025-10-30 17:08:14,348 - travel - ERROR - 添加文件到知识库失败：File is not a zip file
2025-10-30 17:08:14,348 - travel - ERROR - File is not a zip file
Traceback (most recent call last):
  File "D:\pythonlianxi\day23\基于langchian的智慧工厂知识助手实战\xianmu\main.py", line 125, in text_spliter_add
    doc = loader.load()
          ^^^^^^^^^^^^^
  File "D:\moxingxunihuanjing\mash3\Lib\site-packages\langchain_community\document_loaders\word_document.py", line 61, in load
    page_content=docx2txt.process(self.file_path),
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\moxingxunihuanjing\mash3\Lib\site-packages\docx2txt\docx2txt.py", line 76, in process
    zipf = zipfile.ZipFile(docx)
           ^^^^^^^^^^^^^^^^^^^^^
  File "D:\python\Lib\zipfile.py", line 1312, in __init__
    self._RealGetContents()
  File "D:\python\Lib\zipfile.py", line 1379, in _RealGetContents
    raise BadZipFile("File is not a zip file")
zipfile.BadZipFile: File is not a zip file
2025-10-30 17:08:14,350 - travel - ERROR - 重置数据库失败：[WinError 32] 另一个程序正在使用此文件，进程无法访问。: 'D:\\pythonlianxi\\day23\\基于langchian的智慧工厂知识助手实战\\xianmu\\xiangliang\\chroma.sqlite3'
2025-10-30 17:08:14,350 - travel - ERROR - [WinError 32] 另一个程序正在使用此文件，进程无法访问。: 'D:\\pythonlianxi\\day23\\基于langchian的智慧工厂知识助手实战\\xianmu\\xiangliang\\chroma.sqlite3'
Traceback (most recent call last):
  File "D:\pythonlianxi\day23\基于langchian的智慧工厂知识助手实战\xianmu\main.py", line 125, in text_spliter_add
    doc = loader.load()
          ^^^^^^^^^^^^^
  File "D:\moxingxunihuanjing\mash3\Lib\site-packages\langchain_community\document_loaders\word_document.py", line 61, in load
    page_content=docx2txt.process(self.file_path),
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\moxingxunihuanjing\mash3\Lib\site-packages\docx2txt\docx2txt.py", line 76, in process
    zipf = zipfile.ZipFile(docx)
           ^^^^^^^^^^^^^^^^^^^^^
  File "D:\python\Lib\zipfile.py", line 1312, in __init__
    self._RealGetContents()
  File "D:\python\Lib\zipfile.py", line 1379, in _RealGetContents
    raise BadZipFile("File is not a zip file")
zipfile.BadZipFile: File is not a zip file

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\pythonlianxi\day23\基于langchian的智慧工厂知识助手实战\xianmu\main.py", line 165, in text_spliter_add
    shutil.rmtree(kb_dir)
  File "D:\python\Lib\shutil.py", line 787, in rmtree
    return _rmtree_unsafe(path, onerror)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\python\Lib\shutil.py", line 634, in _rmtree_unsafe
    onerror(os.unlink, fullname, sys.exc_info())
  File "D:\python\Lib\shutil.py", line 632, in _rmtree_unsafe
    os.unlink(fullname)
PermissionError: [WinError 32] 另一个程序正在使用此文件，进程无法访问。: 'D:\\pythonlianxi\\day23\\基于langchian的智慧工厂知识助手实战\\xianmu\\xiangliang\\chroma.sqlite3'
2025-10-30 17:08:16,065 - travel - INFO - Langchain代理初始化成功
2025-10-30 17:08:49,962 - httpx - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-30 17:08:55,553 - httpx - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-30 17:08:56,190 - httpx - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-30 17:09:05,735 - httpx - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-30 17:09:06,276 - httpx - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-30 17:14:41,565 - chromadb.telemetry.product.posthog - INFO - Anonymized telemetry enabled. See                     https://docs.trychroma.com/telemetry for more information.
2025-10-30 17:14:44,361 - travel - ERROR - 添加文件到知识库失败：File is not a zip file
2025-10-30 17:14:44,361 - travel - ERROR - File is not a zip file
Traceback (most recent call last):
  File "D:\pythonlianxi\day23\基于langchian的智慧工厂知识助手实战\xianmu\main.py", line 125, in text_spliter_add
    doc = loader.load()
          ^^^^^^^^^^^^^
  File "D:\moxingxunihuanjing\mash3\Lib\site-packages\langchain_community\document_loaders\word_document.py", line 61, in load
    page_content=docx2txt.process(self.file_path),
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\moxingxunihuanjing\mash3\Lib\site-packages\docx2txt\docx2txt.py", line 76, in process
    zipf = zipfile.ZipFile(docx)
           ^^^^^^^^^^^^^^^^^^^^^
  File "D:\python\Lib\zipfile.py", line 1312, in __init__
    self._RealGetContents()
  File "D:\python\Lib\zipfile.py", line 1379, in _RealGetContents
    raise BadZipFile("File is not a zip file")
zipfile.BadZipFile: File is not a zip file
2025-10-30 17:14:44,364 - travel - ERROR - 重置数据库失败：[WinError 32] 另一个程序正在使用此文件，进程无法访问。: 'D:\\pythonlianxi\\day23\\基于langchian的智慧工厂知识助手实战\\xianmu\\xiangliang\\chroma.sqlite3'
2025-10-30 17:14:44,364 - travel - ERROR - [WinError 32] 另一个程序正在使用此文件，进程无法访问。: 'D:\\pythonlianxi\\day23\\基于langchian的智慧工厂知识助手实战\\xianmu\\xiangliang\\chroma.sqlite3'
Traceback (most recent call last):
  File "D:\pythonlianxi\day23\基于langchian的智慧工厂知识助手实战\xianmu\main.py", line 125, in text_spliter_add
    doc = loader.load()
          ^^^^^^^^^^^^^
  File "D:\moxingxunihuanjing\mash3\Lib\site-packages\langchain_community\document_loaders\word_document.py", line 61, in load
    page_content=docx2txt.process(self.file_path),
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\moxingxunihuanjing\mash3\Lib\site-packages\docx2txt\docx2txt.py", line 76, in process
    zipf = zipfile.ZipFile(docx)
           ^^^^^^^^^^^^^^^^^^^^^
  File "D:\python\Lib\zipfile.py", line 1312, in __init__
    self._RealGetContents()
  File "D:\python\Lib\zipfile.py", line 1379, in _RealGetContents
    raise BadZipFile("File is not a zip file")
zipfile.BadZipFile: File is not a zip file

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\pythonlianxi\day23\基于langchian的智慧工厂知识助手实战\xianmu\main.py", line 165, in text_spliter_add
    shutil.rmtree(kb_dir)
  File "D:\python\Lib\shutil.py", line 787, in rmtree
    return _rmtree_unsafe(path, onerror)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\python\Lib\shutil.py", line 634, in _rmtree_unsafe
    onerror(os.unlink, fullname, sys.exc_info())
  File "D:\python\Lib\shutil.py", line 632, in _rmtree_unsafe
    os.unlink(fullname)
PermissionError: [WinError 32] 另一个程序正在使用此文件，进程无法访问。: 'D:\\pythonlianxi\\day23\\基于langchian的智慧工厂知识助手实战\\xianmu\\xiangliang\\chroma.sqlite3'
2025-10-30 17:14:46,125 - travel - INFO - Langchain代理初始化成功
2025-10-30 17:15:18,974 - httpx - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-30 17:15:28,832 - httpx - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-30 17:15:29,358 - httpx - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-30 17:16:55,437 - httpx - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-30 17:16:56,004 - httpx - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-30 17:17:06,218 - httpx - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-30 17:17:06,739 - httpx - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-30 17:19:36,913 - httpx - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-30 17:19:49,683 - httpx - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-30 17:19:50,214 - httpx - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-30 17:20:04,262 - httpx - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-30 17:20:04,650 - httpx - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-30 17:23:40,204 - chromadb.telemetry.product.posthog - INFO - Anonymized telemetry enabled. See                     https://docs.trychroma.com/telemetry for more information.
2025-10-30 17:23:43,371 - travel - ERROR - 添加文件到知识库失败：File is not a zip file
2025-10-30 17:23:43,371 - travel - ERROR - File is not a zip file
Traceback (most recent call last):
  File "D:\pythonlianxi\day23\基于langchian的智慧工厂知识助手实战\xianmu\main.py", line 125, in text_spliter_add
    doc = loader.load()
          ^^^^^^^^^^^^^
  File "D:\moxingxunihuanjing\mash3\Lib\site-packages\langchain_community\document_loaders\word_document.py", line 61, in load
    page_content=docx2txt.process(self.file_path),
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\moxingxunihuanjing\mash3\Lib\site-packages\docx2txt\docx2txt.py", line 76, in process
    zipf = zipfile.ZipFile(docx)
           ^^^^^^^^^^^^^^^^^^^^^
  File "D:\python\Lib\zipfile.py", line 1312, in __init__
    self._RealGetContents()
  File "D:\python\Lib\zipfile.py", line 1379, in _RealGetContents
    raise BadZipFile("File is not a zip file")
zipfile.BadZipFile: File is not a zip file
2025-10-30 17:23:43,374 - travel - ERROR - 重置数据库失败：[WinError 32] 另一个程序正在使用此文件，进程无法访问。: 'D:\\pythonlianxi\\day23\\基于langchian的智慧工厂知识助手实战\\xianmu\\xiangliang\\chroma.sqlite3'
2025-10-30 17:23:43,374 - travel - ERROR - [WinError 32] 另一个程序正在使用此文件，进程无法访问。: 'D:\\pythonlianxi\\day23\\基于langchian的智慧工厂知识助手实战\\xianmu\\xiangliang\\chroma.sqlite3'
Traceback (most recent call last):
  File "D:\pythonlianxi\day23\基于langchian的智慧工厂知识助手实战\xianmu\main.py", line 125, in text_spliter_add
    doc = loader.load()
          ^^^^^^^^^^^^^
  File "D:\moxingxunihuanjing\mash3\Lib\site-packages\langchain_community\document_loaders\word_document.py", line 61, in load
    page_content=docx2txt.process(self.file_path),
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\moxingxunihuanjing\mash3\Lib\site-packages\docx2txt\docx2txt.py", line 76, in process
    zipf = zipfile.ZipFile(docx)
           ^^^^^^^^^^^^^^^^^^^^^
  File "D:\python\Lib\zipfile.py", line 1312, in __init__
    self._RealGetContents()
  File "D:\python\Lib\zipfile.py", line 1379, in _RealGetContents
    raise BadZipFile("File is not a zip file")
zipfile.BadZipFile: File is not a zip file

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\pythonlianxi\day23\基于langchian的智慧工厂知识助手实战\xianmu\main.py", line 165, in text_spliter_add
    shutil.rmtree(kb_dir)
  File "D:\python\Lib\shutil.py", line 787, in rmtree
    return _rmtree_unsafe(path, onerror)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\python\Lib\shutil.py", line 634, in _rmtree_unsafe
    onerror(os.unlink, fullname, sys.exc_info())
  File "D:\python\Lib\shutil.py", line 632, in _rmtree_unsafe
    os.unlink(fullname)
PermissionError: [WinError 32] 另一个程序正在使用此文件，进程无法访问。: 'D:\\pythonlianxi\\day23\\基于langchian的智慧工厂知识助手实战\\xianmu\\xiangliang\\chroma.sqlite3'
2025-10-30 17:23:45,349 - travel - INFO - Langchain代理初始化成功
2025-10-30 17:24:03,299 - httpx - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-30 17:24:30,504 - httpx - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-30 17:24:46,069 - httpx - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-30 17:24:46,623 - httpx - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-30 17:26:51,166 - httpx - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-30 17:26:51,631 - httpx - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-30 17:27:57,151 - httpx - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-30 17:27:57,587 - httpx - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-30 18:11:18,692 - chromadb.telemetry.product.posthog - INFO - Anonymized telemetry enabled. See                     https://docs.trychroma.com/telemetry for more information.
2025-10-30 18:11:21,761 - travel - ERROR - 添加文件到知识库失败：File is not a zip file
2025-10-30 18:11:21,761 - travel - ERROR - File is not a zip file
Traceback (most recent call last):
  File "D:\pythonlianxi\day23\基于langchian的智慧工厂知识助手实战\xianmu\main.py", line 125, in text_spliter_add
    doc = loader.load()
          ^^^^^^^^^^^^^
  File "D:\moxingxunihuanjing\mash3\Lib\site-packages\langchain_community\document_loaders\word_document.py", line 61, in load
    page_content=docx2txt.process(self.file_path),
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\moxingxunihuanjing\mash3\Lib\site-packages\docx2txt\docx2txt.py", line 76, in process
    zipf = zipfile.ZipFile(docx)
           ^^^^^^^^^^^^^^^^^^^^^
  File "D:\python\Lib\zipfile.py", line 1312, in __init__
    self._RealGetContents()
  File "D:\python\Lib\zipfile.py", line 1379, in _RealGetContents
    raise BadZipFile("File is not a zip file")
zipfile.BadZipFile: File is not a zip file
2025-10-30 18:11:21,764 - travel - ERROR - 重置数据库失败：[WinError 32] 另一个程序正在使用此文件，进程无法访问。: 'D:\\pythonlianxi\\day23\\基于langchian的智慧工厂知识助手实战\\xianmu\\xiangliang\\chroma.sqlite3'
2025-10-30 18:11:21,764 - travel - ERROR - [WinError 32] 另一个程序正在使用此文件，进程无法访问。: 'D:\\pythonlianxi\\day23\\基于langchian的智慧工厂知识助手实战\\xianmu\\xiangliang\\chroma.sqlite3'
Traceback (most recent call last):
  File "D:\pythonlianxi\day23\基于langchian的智慧工厂知识助手实战\xianmu\main.py", line 125, in text_spliter_add
    doc = loader.load()
          ^^^^^^^^^^^^^
  File "D:\moxingxunihuanjing\mash3\Lib\site-packages\langchain_community\document_loaders\word_document.py", line 61, in load
    page_content=docx2txt.process(self.file_path),
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\moxingxunihuanjing\mash3\Lib\site-packages\docx2txt\docx2txt.py", line 76, in process
    zipf = zipfile.ZipFile(docx)
           ^^^^^^^^^^^^^^^^^^^^^
  File "D:\python\Lib\zipfile.py", line 1312, in __init__
    self._RealGetContents()
  File "D:\python\Lib\zipfile.py", line 1379, in _RealGetContents
    raise BadZipFile("File is not a zip file")
zipfile.BadZipFile: File is not a zip file

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\pythonlianxi\day23\基于langchian的智慧工厂知识助手实战\xianmu\main.py", line 165, in text_spliter_add
    shutil.rmtree(kb_dir)
  File "D:\python\Lib\shutil.py", line 787, in rmtree
    return _rmtree_unsafe(path, onerror)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\python\Lib\shutil.py", line 634, in _rmtree_unsafe
    onerror(os.unlink, fullname, sys.exc_info())
  File "D:\python\Lib\shutil.py", line 632, in _rmtree_unsafe
    os.unlink(fullname)
PermissionError: [WinError 32] 另一个程序正在使用此文件，进程无法访问。: 'D:\\pythonlianxi\\day23\\基于langchian的智慧工厂知识助手实战\\xianmu\\xiangliang\\chroma.sqlite3'
2025-10-30 18:11:23,125 - travel - INFO - Langchain代理初始化成功
2025-10-30 18:21:25,777 - httpx - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-30 18:21:28,886 - httpx - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-30 18:21:42,155 - backoff - INFO - Backing off send_request(...) for 0.7s (requests.exceptions.ReadTimeout: HTTPSConnectionPool(host='us.i.posthog.com', port=443): Read timed out. (read timeout=15))
2025-10-30 18:24:08,839 - httpx - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-30 18:24:09,284 - httpx - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-30 18:27:12,811 - chromadb.telemetry.product.posthog - INFO - Anonymized telemetry enabled. See                     https://docs.trychroma.com/telemetry for more information.
2025-10-30 18:27:15,701 - travel - ERROR - 添加文件到知识库失败：File is not a zip file
2025-10-30 18:27:15,701 - travel - ERROR - File is not a zip file
Traceback (most recent call last):
  File "D:\pythonlianxi\day23\基于langchian的智慧工厂知识助手实战\xianmu\main.py", line 125, in text_spliter_add
    doc = loader.load()
          ^^^^^^^^^^^^^
  File "D:\moxingxunihuanjing\mash3\Lib\site-packages\langchain_community\document_loaders\word_document.py", line 61, in load
    page_content=docx2txt.process(self.file_path),
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\moxingxunihuanjing\mash3\Lib\site-packages\docx2txt\docx2txt.py", line 76, in process
    zipf = zipfile.ZipFile(docx)
           ^^^^^^^^^^^^^^^^^^^^^
  File "D:\python\Lib\zipfile.py", line 1312, in __init__
    self._RealGetContents()
  File "D:\python\Lib\zipfile.py", line 1379, in _RealGetContents
    raise BadZipFile("File is not a zip file")
zipfile.BadZipFile: File is not a zip file
2025-10-30 18:27:15,704 - travel - ERROR - 重置数据库失败：[WinError 32] 另一个程序正在使用此文件，进程无法访问。: 'D:\\pythonlianxi\\day23\\基于langchian的智慧工厂知识助手实战\\xianmu\\xiangliang\\chroma.sqlite3'
2025-10-30 18:27:15,704 - travel - ERROR - [WinError 32] 另一个程序正在使用此文件，进程无法访问。: 'D:\\pythonlianxi\\day23\\基于langchian的智慧工厂知识助手实战\\xianmu\\xiangliang\\chroma.sqlite3'
Traceback (most recent call last):
  File "D:\pythonlianxi\day23\基于langchian的智慧工厂知识助手实战\xianmu\main.py", line 125, in text_spliter_add
    doc = loader.load()
          ^^^^^^^^^^^^^
  File "D:\moxingxunihuanjing\mash3\Lib\site-packages\langchain_community\document_loaders\word_document.py", line 61, in load
    page_content=docx2txt.process(self.file_path),
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\moxingxunihuanjing\mash3\Lib\site-packages\docx2txt\docx2txt.py", line 76, in process
    zipf = zipfile.ZipFile(docx)
           ^^^^^^^^^^^^^^^^^^^^^
  File "D:\python\Lib\zipfile.py", line 1312, in __init__
    self._RealGetContents()
  File "D:\python\Lib\zipfile.py", line 1379, in _RealGetContents
    raise BadZipFile("File is not a zip file")
zipfile.BadZipFile: File is not a zip file

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\pythonlianxi\day23\基于langchian的智慧工厂知识助手实战\xianmu\main.py", line 165, in text_spliter_add
    shutil.rmtree(kb_dir)
  File "D:\python\Lib\shutil.py", line 787, in rmtree
    return _rmtree_unsafe(path, onerror)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\python\Lib\shutil.py", line 634, in _rmtree_unsafe
    onerror(os.unlink, fullname, sys.exc_info())
  File "D:\python\Lib\shutil.py", line 632, in _rmtree_unsafe
    os.unlink(fullname)
PermissionError: [WinError 32] 另一个程序正在使用此文件，进程无法访问。: 'D:\\pythonlianxi\\day23\\基于langchian的智慧工厂知识助手实战\\xianmu\\xiangliang\\chroma.sqlite3'
2025-10-30 18:27:17,140 - travel - INFO - Langchain代理初始化成功
2025-10-30 18:27:32,724 - httpx - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-30 18:28:36,034 - httpx - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-30 18:28:37,263 - httpx - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-30 18:28:39,385 - httpx - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-30 18:28:41,172 - httpx - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-30 18:28:42,519 - httpx - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-30 18:34:28,769 - chromadb.telemetry.product.posthog - INFO - Anonymized telemetry enabled. See                     https://docs.trychroma.com/telemetry for more information.
2025-10-30 18:34:31,447 - travel - ERROR - 添加文件到知识库失败：File is not a zip file
2025-10-30 18:34:31,447 - travel - ERROR - File is not a zip file
Traceback (most recent call last):
  File "D:\pythonlianxi\day23\基于langchian的智慧工厂知识助手实战\xianmu\main.py", line 125, in text_spliter_add
    doc = loader.load()
          ^^^^^^^^^^^^^
  File "D:\moxingxunihuanjing\mash3\Lib\site-packages\langchain_community\document_loaders\word_document.py", line 61, in load
    page_content=docx2txt.process(self.file_path),
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\moxingxunihuanjing\mash3\Lib\site-packages\docx2txt\docx2txt.py", line 76, in process
    zipf = zipfile.ZipFile(docx)
           ^^^^^^^^^^^^^^^^^^^^^
  File "D:\python\Lib\zipfile.py", line 1312, in __init__
    self._RealGetContents()
  File "D:\python\Lib\zipfile.py", line 1379, in _RealGetContents
    raise BadZipFile("File is not a zip file")
zipfile.BadZipFile: File is not a zip file
2025-10-30 18:34:31,449 - travel - ERROR - 重置数据库失败：[WinError 32] 另一个程序正在使用此文件，进程无法访问。: 'D:\\pythonlianxi\\day23\\基于langchian的智慧工厂知识助手实战\\xianmu\\xiangliang\\chroma.sqlite3'
2025-10-30 18:34:31,450 - travel - ERROR - [WinError 32] 另一个程序正在使用此文件，进程无法访问。: 'D:\\pythonlianxi\\day23\\基于langchian的智慧工厂知识助手实战\\xianmu\\xiangliang\\chroma.sqlite3'
Traceback (most recent call last):
  File "D:\pythonlianxi\day23\基于langchian的智慧工厂知识助手实战\xianmu\main.py", line 125, in text_spliter_add
    doc = loader.load()
          ^^^^^^^^^^^^^
  File "D:\moxingxunihuanjing\mash3\Lib\site-packages\langchain_community\document_loaders\word_document.py", line 61, in load
    page_content=docx2txt.process(self.file_path),
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\moxingxunihuanjing\mash3\Lib\site-packages\docx2txt\docx2txt.py", line 76, in process
    zipf = zipfile.ZipFile(docx)
           ^^^^^^^^^^^^^^^^^^^^^
  File "D:\python\Lib\zipfile.py", line 1312, in __init__
    self._RealGetContents()
  File "D:\python\Lib\zipfile.py", line 1379, in _RealGetContents
    raise BadZipFile("File is not a zip file")
zipfile.BadZipFile: File is not a zip file

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\pythonlianxi\day23\基于langchian的智慧工厂知识助手实战\xianmu\main.py", line 165, in text_spliter_add
    shutil.rmtree(kb_dir)
  File "D:\python\Lib\shutil.py", line 787, in rmtree
    return _rmtree_unsafe(path, onerror)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\python\Lib\shutil.py", line 634, in _rmtree_unsafe
    onerror(os.unlink, fullname, sys.exc_info())
  File "D:\python\Lib\shutil.py", line 632, in _rmtree_unsafe
    os.unlink(fullname)
PermissionError: [WinError 32] 另一个程序正在使用此文件，进程无法访问。: 'D:\\pythonlianxi\\day23\\基于langchian的智慧工厂知识助手实战\\xianmu\\xiangliang\\chroma.sqlite3'
2025-10-30 18:34:33,045 - travel - INFO - Langchain代理初始化成功
2025-10-30 18:34:47,060 - httpx - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-30 18:39:59,668 - chromadb.telemetry.product.posthog - INFO - Anonymized telemetry enabled. See                     https://docs.trychroma.com/telemetry for more information.
2025-10-30 18:40:02,216 - travel - ERROR - 添加文件到知识库失败：File is not a zip file
2025-10-30 18:40:02,216 - travel - ERROR - File is not a zip file
Traceback (most recent call last):
  File "D:\pythonlianxi\day23\基于langchian的智慧工厂知识助手实战\xianmu\main.py", line 125, in text_spliter_add
    doc = loader.load()
          ^^^^^^^^^^^^^
  File "D:\moxingxunihuanjing\mash3\Lib\site-packages\langchain_community\document_loaders\word_document.py", line 61, in load
    page_content=docx2txt.process(self.file_path),
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\moxingxunihuanjing\mash3\Lib\site-packages\docx2txt\docx2txt.py", line 76, in process
    zipf = zipfile.ZipFile(docx)
           ^^^^^^^^^^^^^^^^^^^^^
  File "D:\python\Lib\zipfile.py", line 1312, in __init__
    self._RealGetContents()
  File "D:\python\Lib\zipfile.py", line 1379, in _RealGetContents
    raise BadZipFile("File is not a zip file")
zipfile.BadZipFile: File is not a zip file
2025-10-30 18:40:02,219 - travel - ERROR - 重置数据库失败：[WinError 32] 另一个程序正在使用此文件，进程无法访问。: 'D:\\pythonlianxi\\day23\\基于langchian的智慧工厂知识助手实战\\xianmu\\xiangliang\\chroma.sqlite3'
2025-10-30 18:40:02,219 - travel - ERROR - [WinError 32] 另一个程序正在使用此文件，进程无法访问。: 'D:\\pythonlianxi\\day23\\基于langchian的智慧工厂知识助手实战\\xianmu\\xiangliang\\chroma.sqlite3'
Traceback (most recent call last):
  File "D:\pythonlianxi\day23\基于langchian的智慧工厂知识助手实战\xianmu\main.py", line 125, in text_spliter_add
    doc = loader.load()
          ^^^^^^^^^^^^^
  File "D:\moxingxunihuanjing\mash3\Lib\site-packages\langchain_community\document_loaders\word_document.py", line 61, in load
    page_content=docx2txt.process(self.file_path),
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\moxingxunihuanjing\mash3\Lib\site-packages\docx2txt\docx2txt.py", line 76, in process
    zipf = zipfile.ZipFile(docx)
           ^^^^^^^^^^^^^^^^^^^^^
  File "D:\python\Lib\zipfile.py", line 1312, in __init__
    self._RealGetContents()
  File "D:\python\Lib\zipfile.py", line 1379, in _RealGetContents
    raise BadZipFile("File is not a zip file")
zipfile.BadZipFile: File is not a zip file

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\pythonlianxi\day23\基于langchian的智慧工厂知识助手实战\xianmu\main.py", line 165, in text_spliter_add
    shutil.rmtree(kb_dir)
  File "D:\python\Lib\shutil.py", line 787, in rmtree
    return _rmtree_unsafe(path, onerror)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\python\Lib\shutil.py", line 634, in _rmtree_unsafe
    onerror(os.unlink, fullname, sys.exc_info())
  File "D:\python\Lib\shutil.py", line 632, in _rmtree_unsafe
    os.unlink(fullname)
PermissionError: [WinError 32] 另一个程序正在使用此文件，进程无法访问。: 'D:\\pythonlianxi\\day23\\基于langchian的智慧工厂知识助手实战\\xianmu\\xiangliang\\chroma.sqlite3'
2025-10-30 18:40:03,736 - travel - INFO - Langchain代理初始化成功
2025-10-30 18:40:28,204 - httpx - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-30 18:40:30,605 - httpx - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-30 18:40:32,302 - httpx - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-30 18:42:05,573 - httpx - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-30 18:42:06,564 - httpx - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-30 18:42:07,880 - httpx - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-30 18:46:39,215 - chromadb.telemetry.product.posthog - INFO - Anonymized telemetry enabled. See                     https://docs.trychroma.com/telemetry for more information.
2025-10-30 18:46:41,704 - travel - ERROR - 添加文件到知识库失败：File is not a zip file
2025-10-30 18:46:41,704 - travel - ERROR - File is not a zip file
Traceback (most recent call last):
  File "D:\pythonlianxi\day23\基于langchian的智慧工厂知识助手实战\xianmu\main.py", line 125, in text_spliter_add
    doc = loader.load()
          ^^^^^^^^^^^^^
  File "D:\moxingxunihuanjing\mash3\Lib\site-packages\langchain_community\document_loaders\word_document.py", line 61, in load
    page_content=docx2txt.process(self.file_path),
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\moxingxunihuanjing\mash3\Lib\site-packages\docx2txt\docx2txt.py", line 76, in process
    zipf = zipfile.ZipFile(docx)
           ^^^^^^^^^^^^^^^^^^^^^
  File "D:\python\Lib\zipfile.py", line 1312, in __init__
    self._RealGetContents()
  File "D:\python\Lib\zipfile.py", line 1379, in _RealGetContents
    raise BadZipFile("File is not a zip file")
zipfile.BadZipFile: File is not a zip file
2025-10-30 18:46:41,706 - travel - ERROR - 重置数据库失败：[WinError 32] 另一个程序正在使用此文件，进程无法访问。: 'D:\\pythonlianxi\\day23\\基于langchian的智慧工厂知识助手实战\\xianmu\\xiangliang\\chroma.sqlite3'
2025-10-30 18:46:41,706 - travel - ERROR - [WinError 32] 另一个程序正在使用此文件，进程无法访问。: 'D:\\pythonlianxi\\day23\\基于langchian的智慧工厂知识助手实战\\xianmu\\xiangliang\\chroma.sqlite3'
Traceback (most recent call last):
  File "D:\pythonlianxi\day23\基于langchian的智慧工厂知识助手实战\xianmu\main.py", line 125, in text_spliter_add
    doc = loader.load()
          ^^^^^^^^^^^^^
  File "D:\moxingxunihuanjing\mash3\Lib\site-packages\langchain_community\document_loaders\word_document.py", line 61, in load
    page_content=docx2txt.process(self.file_path),
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\moxingxunihuanjing\mash3\Lib\site-packages\docx2txt\docx2txt.py", line 76, in process
    zipf = zipfile.ZipFile(docx)
           ^^^^^^^^^^^^^^^^^^^^^
  File "D:\python\Lib\zipfile.py", line 1312, in __init__
    self._RealGetContents()
  File "D:\python\Lib\zipfile.py", line 1379, in _RealGetContents
    raise BadZipFile("File is not a zip file")
zipfile.BadZipFile: File is not a zip file

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\pythonlianxi\day23\基于langchian的智慧工厂知识助手实战\xianmu\main.py", line 165, in text_spliter_add
    shutil.rmtree(kb_dir)
  File "D:\python\Lib\shutil.py", line 787, in rmtree
    return _rmtree_unsafe(path, onerror)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\python\Lib\shutil.py", line 634, in _rmtree_unsafe
    onerror(os.unlink, fullname, sys.exc_info())
  File "D:\python\Lib\shutil.py", line 632, in _rmtree_unsafe
    os.unlink(fullname)
PermissionError: [WinError 32] 另一个程序正在使用此文件，进程无法访问。: 'D:\\pythonlianxi\\day23\\基于langchian的智慧工厂知识助手实战\\xianmu\\xiangliang\\chroma.sqlite3'
2025-10-30 18:46:43,363 - travel - INFO - Langchain代理初始化成功
2025-10-30 18:47:11,333 - httpx - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-30 18:47:13,856 - httpx - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-30 18:47:16,264 - httpx - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-30 19:21:24,943 - chromadb.telemetry.product.posthog - INFO - Anonymized telemetry enabled. See                     https://docs.trychroma.com/telemetry for more information.
2025-10-30 19:21:27,683 - travel - ERROR - 添加文件到知识库失败：File is not a zip file
2025-10-30 19:21:27,683 - travel - ERROR - File is not a zip file
Traceback (most recent call last):
  File "D:\pythonlianxi\day23\基于langchian的智慧工厂知识助手实战\xianmu\main.py", line 125, in text_spliter_add
    doc = loader.load()
          ^^^^^^^^^^^^^
  File "D:\moxingxunihuanjing\mash3\Lib\site-packages\langchain_community\document_loaders\word_document.py", line 61, in load
    page_content=docx2txt.process(self.file_path),
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\moxingxunihuanjing\mash3\Lib\site-packages\docx2txt\docx2txt.py", line 76, in process
    zipf = zipfile.ZipFile(docx)
           ^^^^^^^^^^^^^^^^^^^^^
  File "D:\python\Lib\zipfile.py", line 1312, in __init__
    self._RealGetContents()
  File "D:\python\Lib\zipfile.py", line 1379, in _RealGetContents
    raise BadZipFile("File is not a zip file")
zipfile.BadZipFile: File is not a zip file
2025-10-30 19:21:27,686 - travel - ERROR - 重置数据库失败：[WinError 32] 另一个程序正在使用此文件，进程无法访问。: 'D:\\pythonlianxi\\day23\\基于langchian的智慧工厂知识助手实战\\xianmu\\xiangliang\\chroma.sqlite3'
2025-10-30 19:21:27,686 - travel - ERROR - [WinError 32] 另一个程序正在使用此文件，进程无法访问。: 'D:\\pythonlianxi\\day23\\基于langchian的智慧工厂知识助手实战\\xianmu\\xiangliang\\chroma.sqlite3'
Traceback (most recent call last):
  File "D:\pythonlianxi\day23\基于langchian的智慧工厂知识助手实战\xianmu\main.py", line 125, in text_spliter_add
    doc = loader.load()
          ^^^^^^^^^^^^^
  File "D:\moxingxunihuanjing\mash3\Lib\site-packages\langchain_community\document_loaders\word_document.py", line 61, in load
    page_content=docx2txt.process(self.file_path),
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\moxingxunihuanjing\mash3\Lib\site-packages\docx2txt\docx2txt.py", line 76, in process
    zipf = zipfile.ZipFile(docx)
           ^^^^^^^^^^^^^^^^^^^^^
  File "D:\python\Lib\zipfile.py", line 1312, in __init__
    self._RealGetContents()
  File "D:\python\Lib\zipfile.py", line 1379, in _RealGetContents
    raise BadZipFile("File is not a zip file")
zipfile.BadZipFile: File is not a zip file

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\pythonlianxi\day23\基于langchian的智慧工厂知识助手实战\xianmu\main.py", line 165, in text_spliter_add
    shutil.rmtree(kb_dir)
  File "D:\python\Lib\shutil.py", line 787, in rmtree
    return _rmtree_unsafe(path, onerror)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\python\Lib\shutil.py", line 634, in _rmtree_unsafe
    onerror(os.unlink, fullname, sys.exc_info())
  File "D:\python\Lib\shutil.py", line 632, in _rmtree_unsafe
    os.unlink(fullname)
PermissionError: [WinError 32] 另一个程序正在使用此文件，进程无法访问。: 'D:\\pythonlianxi\\day23\\基于langchian的智慧工厂知识助手实战\\xianmu\\xiangliang\\chroma.sqlite3'
2025-10-30 19:21:27,688 - travel - ERROR - 添加文件到知识库失败：File is not a zip file
2025-10-30 19:21:27,688 - travel - ERROR - File is not a zip file
Traceback (most recent call last):
  File "D:\pythonlianxi\day23\基于langchian的智慧工厂知识助手实战\xianmu\main.py", line 125, in text_spliter_add
    doc = loader.load()
          ^^^^^^^^^^^^^
  File "D:\moxingxunihuanjing\mash3\Lib\site-packages\langchain_community\document_loaders\word_document.py", line 61, in load
    page_content=docx2txt.process(self.file_path),
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\moxingxunihuanjing\mash3\Lib\site-packages\docx2txt\docx2txt.py", line 76, in process
    zipf = zipfile.ZipFile(docx)
           ^^^^^^^^^^^^^^^^^^^^^
  File "D:\python\Lib\zipfile.py", line 1312, in __init__
    self._RealGetContents()
  File "D:\python\Lib\zipfile.py", line 1379, in _RealGetContents
    raise BadZipFile("File is not a zip file")
zipfile.BadZipFile: File is not a zip file
2025-10-30 19:21:27,689 - travel - ERROR - 重置数据库失败：[WinError 32] 另一个程序正在使用此文件，进程无法访问。: 'D:\\pythonlianxi\\day23\\基于langchian的智慧工厂知识助手实战\\xianmu\\xiangliang\\chroma.sqlite3'
2025-10-30 19:21:27,689 - travel - ERROR - [WinError 32] 另一个程序正在使用此文件，进程无法访问。: 'D:\\pythonlianxi\\day23\\基于langchian的智慧工厂知识助手实战\\xianmu\\xiangliang\\chroma.sqlite3'
Traceback (most recent call last):
  File "D:\pythonlianxi\day23\基于langchian的智慧工厂知识助手实战\xianmu\main.py", line 125, in text_spliter_add
    doc = loader.load()
          ^^^^^^^^^^^^^
  File "D:\moxingxunihuanjing\mash3\Lib\site-packages\langchain_community\document_loaders\word_document.py", line 61, in load
    page_content=docx2txt.process(self.file_path),
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\moxingxunihuanjing\mash3\Lib\site-packages\docx2txt\docx2txt.py", line 76, in process
    zipf = zipfile.ZipFile(docx)
           ^^^^^^^^^^^^^^^^^^^^^
  File "D:\python\Lib\zipfile.py", line 1312, in __init__
    self._RealGetContents()
  File "D:\python\Lib\zipfile.py", line 1379, in _RealGetContents
    raise BadZipFile("File is not a zip file")
zipfile.BadZipFile: File is not a zip file

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\pythonlianxi\day23\基于langchian的智慧工厂知识助手实战\xianmu\main.py", line 165, in text_spliter_add
    shutil.rmtree(kb_dir)
  File "D:\python\Lib\shutil.py", line 787, in rmtree
    return _rmtree_unsafe(path, onerror)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\python\Lib\shutil.py", line 634, in _rmtree_unsafe
    onerror(os.unlink, fullname, sys.exc_info())
  File "D:\python\Lib\shutil.py", line 632, in _rmtree_unsafe
    os.unlink(fullname)
PermissionError: [WinError 32] 另一个程序正在使用此文件，进程无法访问。: 'D:\\pythonlianxi\\day23\\基于langchian的智慧工厂知识助手实战\\xianmu\\xiangliang\\chroma.sqlite3'
2025-10-30 19:21:29,439 - travel - INFO - Langchain代理初始化成功
2025-10-30 19:22:41,723 - chromadb.telemetry.product.posthog - INFO - Anonymized telemetry enabled. See                     https://docs.trychroma.com/telemetry for more information.
2025-10-30 19:22:44,548 - travel - ERROR - 添加文件到知识库失败：File is not a zip file
2025-10-30 19:22:44,548 - travel - ERROR - File is not a zip file
Traceback (most recent call last):
  File "D:\pythonlianxi\day23\基于langchian的智慧工厂知识助手实战\xianmu\main.py", line 125, in text_spliter_add
    doc = loader.load()
          ^^^^^^^^^^^^^
  File "D:\moxingxunihuanjing\mash3\Lib\site-packages\langchain_community\document_loaders\word_document.py", line 61, in load
    page_content=docx2txt.process(self.file_path),
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\moxingxunihuanjing\mash3\Lib\site-packages\docx2txt\docx2txt.py", line 76, in process
    zipf = zipfile.ZipFile(docx)
           ^^^^^^^^^^^^^^^^^^^^^
  File "D:\python\Lib\zipfile.py", line 1312, in __init__
    self._RealGetContents()
  File "D:\python\Lib\zipfile.py", line 1379, in _RealGetContents
    raise BadZipFile("File is not a zip file")
zipfile.BadZipFile: File is not a zip file
2025-10-30 19:22:44,551 - travel - ERROR - 重置数据库失败：[WinError 32] 另一个程序正在使用此文件，进程无法访问。: 'D:\\pythonlianxi\\day23\\基于langchian的智慧工厂知识助手实战\\xianmu\\xiangliang\\chroma.sqlite3'
2025-10-30 19:22:44,551 - travel - ERROR - [WinError 32] 另一个程序正在使用此文件，进程无法访问。: 'D:\\pythonlianxi\\day23\\基于langchian的智慧工厂知识助手实战\\xianmu\\xiangliang\\chroma.sqlite3'
Traceback (most recent call last):
  File "D:\pythonlianxi\day23\基于langchian的智慧工厂知识助手实战\xianmu\main.py", line 125, in text_spliter_add
    doc = loader.load()
          ^^^^^^^^^^^^^
  File "D:\moxingxunihuanjing\mash3\Lib\site-packages\langchain_community\document_loaders\word_document.py", line 61, in load
    page_content=docx2txt.process(self.file_path),
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\moxingxunihuanjing\mash3\Lib\site-packages\docx2txt\docx2txt.py", line 76, in process
    zipf = zipfile.ZipFile(docx)
           ^^^^^^^^^^^^^^^^^^^^^
  File "D:\python\Lib\zipfile.py", line 1312, in __init__
    self._RealGetContents()
  File "D:\python\Lib\zipfile.py", line 1379, in _RealGetContents
    raise BadZipFile("File is not a zip file")
zipfile.BadZipFile: File is not a zip file

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\pythonlianxi\day23\基于langchian的智慧工厂知识助手实战\xianmu\main.py", line 165, in text_spliter_add
    shutil.rmtree(kb_dir)
  File "D:\python\Lib\shutil.py", line 787, in rmtree
    return _rmtree_unsafe(path, onerror)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\python\Lib\shutil.py", line 634, in _rmtree_unsafe
    onerror(os.unlink, fullname, sys.exc_info())
  File "D:\python\Lib\shutil.py", line 632, in _rmtree_unsafe
    os.unlink(fullname)
PermissionError: [WinError 32] 另一个程序正在使用此文件，进程无法访问。: 'D:\\pythonlianxi\\day23\\基于langchian的智慧工厂知识助手实战\\xianmu\\xiangliang\\chroma.sqlite3'
2025-10-30 19:22:44,552 - travel - ERROR - 添加文件到知识库失败：File is not a zip file
2025-10-30 19:22:44,552 - travel - ERROR - File is not a zip file
Traceback (most recent call last):
  File "D:\pythonlianxi\day23\基于langchian的智慧工厂知识助手实战\xianmu\main.py", line 125, in text_spliter_add
    doc = loader.load()
          ^^^^^^^^^^^^^
  File "D:\moxingxunihuanjing\mash3\Lib\site-packages\langchain_community\document_loaders\word_document.py", line 61, in load
    page_content=docx2txt.process(self.file_path),
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\moxingxunihuanjing\mash3\Lib\site-packages\docx2txt\docx2txt.py", line 76, in process
    zipf = zipfile.ZipFile(docx)
           ^^^^^^^^^^^^^^^^^^^^^
  File "D:\python\Lib\zipfile.py", line 1312, in __init__
    self._RealGetContents()
  File "D:\python\Lib\zipfile.py", line 1379, in _RealGetContents
    raise BadZipFile("File is not a zip file")
zipfile.BadZipFile: File is not a zip file
2025-10-30 19:22:44,554 - travel - ERROR - 重置数据库失败：[WinError 32] 另一个程序正在使用此文件，进程无法访问。: 'D:\\pythonlianxi\\day23\\基于langchian的智慧工厂知识助手实战\\xianmu\\xiangliang\\chroma.sqlite3'
2025-10-30 19:22:44,554 - travel - ERROR - [WinError 32] 另一个程序正在使用此文件，进程无法访问。: 'D:\\pythonlianxi\\day23\\基于langchian的智慧工厂知识助手实战\\xianmu\\xiangliang\\chroma.sqlite3'
Traceback (most recent call last):
  File "D:\pythonlianxi\day23\基于langchian的智慧工厂知识助手实战\xianmu\main.py", line 125, in text_spliter_add
    doc = loader.load()
          ^^^^^^^^^^^^^
  File "D:\moxingxunihuanjing\mash3\Lib\site-packages\langchain_community\document_loaders\word_document.py", line 61, in load
    page_content=docx2txt.process(self.file_path),
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\moxingxunihuanjing\mash3\Lib\site-packages\docx2txt\docx2txt.py", line 76, in process
    zipf = zipfile.ZipFile(docx)
           ^^^^^^^^^^^^^^^^^^^^^
  File "D:\python\Lib\zipfile.py", line 1312, in __init__
    self._RealGetContents()
  File "D:\python\Lib\zipfile.py", line 1379, in _RealGetContents
    raise BadZipFile("File is not a zip file")
zipfile.BadZipFile: File is not a zip file

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\pythonlianxi\day23\基于langchian的智慧工厂知识助手实战\xianmu\main.py", line 165, in text_spliter_add
    shutil.rmtree(kb_dir)
  File "D:\python\Lib\shutil.py", line 787, in rmtree
    return _rmtree_unsafe(path, onerror)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\python\Lib\shutil.py", line 634, in _rmtree_unsafe
    onerror(os.unlink, fullname, sys.exc_info())
  File "D:\python\Lib\shutil.py", line 632, in _rmtree_unsafe
    os.unlink(fullname)
PermissionError: [WinError 32] 另一个程序正在使用此文件，进程无法访问。: 'D:\\pythonlianxi\\day23\\基于langchian的智慧工厂知识助手实战\\xianmu\\xiangliang\\chroma.sqlite3'
2025-10-30 19:22:46,156 - travel - INFO - Langchain代理初始化成功
2025-10-30 19:25:03,845 - chromadb.telemetry.product.posthog - INFO - Anonymized telemetry enabled. See                     https://docs.trychroma.com/telemetry for more information.
2025-10-30 19:25:06,960 - travel - ERROR - 添加文件到知识库失败：File is not a zip file
2025-10-30 19:25:06,960 - travel - ERROR - File is not a zip file
Traceback (most recent call last):
  File "D:\pythonlianxi\day23\基于langchian的智慧工厂知识助手实战\xianmu\main.py", line 125, in text_spliter_add
    doc = loader.load()
          ^^^^^^^^^^^^^
  File "D:\moxingxunihuanjing\mash3\Lib\site-packages\langchain_community\document_loaders\word_document.py", line 61, in load
    page_content=docx2txt.process(self.file_path),
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\moxingxunihuanjing\mash3\Lib\site-packages\docx2txt\docx2txt.py", line 76, in process
    zipf = zipfile.ZipFile(docx)
           ^^^^^^^^^^^^^^^^^^^^^
  File "D:\python\Lib\zipfile.py", line 1312, in __init__
    self._RealGetContents()
  File "D:\python\Lib\zipfile.py", line 1379, in _RealGetContents
    raise BadZipFile("File is not a zip file")
zipfile.BadZipFile: File is not a zip file
2025-10-30 19:25:06,963 - travel - ERROR - 重置数据库失败：[WinError 32] 另一个程序正在使用此文件，进程无法访问。: 'D:\\pythonlianxi\\day23\\基于langchian的智慧工厂知识助手实战\\xianmu\\xiangliang\\chroma.sqlite3'
2025-10-30 19:25:06,963 - travel - ERROR - [WinError 32] 另一个程序正在使用此文件，进程无法访问。: 'D:\\pythonlianxi\\day23\\基于langchian的智慧工厂知识助手实战\\xianmu\\xiangliang\\chroma.sqlite3'
Traceback (most recent call last):
  File "D:\pythonlianxi\day23\基于langchian的智慧工厂知识助手实战\xianmu\main.py", line 125, in text_spliter_add
    doc = loader.load()
          ^^^^^^^^^^^^^
  File "D:\moxingxunihuanjing\mash3\Lib\site-packages\langchain_community\document_loaders\word_document.py", line 61, in load
    page_content=docx2txt.process(self.file_path),
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\moxingxunihuanjing\mash3\Lib\site-packages\docx2txt\docx2txt.py", line 76, in process
    zipf = zipfile.ZipFile(docx)
           ^^^^^^^^^^^^^^^^^^^^^
  File "D:\python\Lib\zipfile.py", line 1312, in __init__
    self._RealGetContents()
  File "D:\python\Lib\zipfile.py", line 1379, in _RealGetContents
    raise BadZipFile("File is not a zip file")
zipfile.BadZipFile: File is not a zip file

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\pythonlianxi\day23\基于langchian的智慧工厂知识助手实战\xianmu\main.py", line 165, in text_spliter_add
    shutil.rmtree(kb_dir)
  File "D:\python\Lib\shutil.py", line 787, in rmtree
    return _rmtree_unsafe(path, onerror)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\python\Lib\shutil.py", line 634, in _rmtree_unsafe
    onerror(os.unlink, fullname, sys.exc_info())
  File "D:\python\Lib\shutil.py", line 632, in _rmtree_unsafe
    os.unlink(fullname)
PermissionError: [WinError 32] 另一个程序正在使用此文件，进程无法访问。: 'D:\\pythonlianxi\\day23\\基于langchian的智慧工厂知识助手实战\\xianmu\\xiangliang\\chroma.sqlite3'
2025-10-30 19:25:06,965 - travel - ERROR - 添加文件到知识库失败：File is not a zip file
2025-10-30 19:25:06,965 - travel - ERROR - File is not a zip file
Traceback (most recent call last):
  File "D:\pythonlianxi\day23\基于langchian的智慧工厂知识助手实战\xianmu\main.py", line 125, in text_spliter_add
    doc = loader.load()
          ^^^^^^^^^^^^^
  File "D:\moxingxunihuanjing\mash3\Lib\site-packages\langchain_community\document_loaders\word_document.py", line 61, in load
    page_content=docx2txt.process(self.file_path),
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\moxingxunihuanjing\mash3\Lib\site-packages\docx2txt\docx2txt.py", line 76, in process
    zipf = zipfile.ZipFile(docx)
           ^^^^^^^^^^^^^^^^^^^^^
  File "D:\python\Lib\zipfile.py", line 1312, in __init__
    self._RealGetContents()
  File "D:\python\Lib\zipfile.py", line 1379, in _RealGetContents
    raise BadZipFile("File is not a zip file")
zipfile.BadZipFile: File is not a zip file
2025-10-30 19:25:06,967 - travel - ERROR - 重置数据库失败：[WinError 32] 另一个程序正在使用此文件，进程无法访问。: 'D:\\pythonlianxi\\day23\\基于langchian的智慧工厂知识助手实战\\xianmu\\xiangliang\\chroma.sqlite3'
2025-10-30 19:25:06,967 - travel - ERROR - [WinError 32] 另一个程序正在使用此文件，进程无法访问。: 'D:\\pythonlianxi\\day23\\基于langchian的智慧工厂知识助手实战\\xianmu\\xiangliang\\chroma.sqlite3'
Traceback (most recent call last):
  File "D:\pythonlianxi\day23\基于langchian的智慧工厂知识助手实战\xianmu\main.py", line 125, in text_spliter_add
    doc = loader.load()
          ^^^^^^^^^^^^^
  File "D:\moxingxunihuanjing\mash3\Lib\site-packages\langchain_community\document_loaders\word_document.py", line 61, in load
    page_content=docx2txt.process(self.file_path),
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\moxingxunihuanjing\mash3\Lib\site-packages\docx2txt\docx2txt.py", line 76, in process
    zipf = zipfile.ZipFile(docx)
           ^^^^^^^^^^^^^^^^^^^^^
  File "D:\python\Lib\zipfile.py", line 1312, in __init__
    self._RealGetContents()
  File "D:\python\Lib\zipfile.py", line 1379, in _RealGetContents
    raise BadZipFile("File is not a zip file")
zipfile.BadZipFile: File is not a zip file

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\pythonlianxi\day23\基于langchian的智慧工厂知识助手实战\xianmu\main.py", line 165, in text_spliter_add
    shutil.rmtree(kb_dir)
  File "D:\python\Lib\shutil.py", line 787, in rmtree
    return _rmtree_unsafe(path, onerror)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\python\Lib\shutil.py", line 634, in _rmtree_unsafe
    onerror(os.unlink, fullname, sys.exc_info())
  File "D:\python\Lib\shutil.py", line 632, in _rmtree_unsafe
    os.unlink(fullname)
PermissionError: [WinError 32] 另一个程序正在使用此文件，进程无法访问。: 'D:\\pythonlianxi\\day23\\基于langchian的智慧工厂知识助手实战\\xianmu\\xiangliang\\chroma.sqlite3'
2025-10-30 19:25:08,807 - travel - INFO - Langchain代理初始化成功
2025-10-30 19:30:31,751 - chromadb.telemetry.product.posthog - INFO - Anonymized telemetry enabled. See                     https://docs.trychroma.com/telemetry for more information.
2025-10-30 19:30:35,043 - travel - ERROR - 添加文件到知识库失败：File is not a zip file
2025-10-30 19:30:35,043 - travel - ERROR - File is not a zip file
Traceback (most recent call last):
  File "D:\pythonlianxi\day23\基于langchian的智慧工厂知识助手实战\xianmu\main.py", line 125, in text_spliter_add
    doc = loader.load()
          ^^^^^^^^^^^^^
  File "D:\moxingxunihuanjing\mash3\Lib\site-packages\langchain_community\document_loaders\word_document.py", line 61, in load
    page_content=docx2txt.process(self.file_path),
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\moxingxunihuanjing\mash3\Lib\site-packages\docx2txt\docx2txt.py", line 76, in process
    zipf = zipfile.ZipFile(docx)
           ^^^^^^^^^^^^^^^^^^^^^
  File "D:\python\Lib\zipfile.py", line 1312, in __init__
    self._RealGetContents()
  File "D:\python\Lib\zipfile.py", line 1379, in _RealGetContents
    raise BadZipFile("File is not a zip file")
zipfile.BadZipFile: File is not a zip file
2025-10-30 19:30:35,046 - travel - ERROR - 重置数据库失败：[WinError 32] 另一个程序正在使用此文件，进程无法访问。: 'D:\\pythonlianxi\\day23\\基于langchian的智慧工厂知识助手实战\\xianmu\\xiangliang\\chroma.sqlite3'
2025-10-30 19:30:35,046 - travel - ERROR - [WinError 32] 另一个程序正在使用此文件，进程无法访问。: 'D:\\pythonlianxi\\day23\\基于langchian的智慧工厂知识助手实战\\xianmu\\xiangliang\\chroma.sqlite3'
Traceback (most recent call last):
  File "D:\pythonlianxi\day23\基于langchian的智慧工厂知识助手实战\xianmu\main.py", line 125, in text_spliter_add
    doc = loader.load()
          ^^^^^^^^^^^^^
  File "D:\moxingxunihuanjing\mash3\Lib\site-packages\langchain_community\document_loaders\word_document.py", line 61, in load
    page_content=docx2txt.process(self.file_path),
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\moxingxunihuanjing\mash3\Lib\site-packages\docx2txt\docx2txt.py", line 76, in process
    zipf = zipfile.ZipFile(docx)
           ^^^^^^^^^^^^^^^^^^^^^
  File "D:\python\Lib\zipfile.py", line 1312, in __init__
    self._RealGetContents()
  File "D:\python\Lib\zipfile.py", line 1379, in _RealGetContents
    raise BadZipFile("File is not a zip file")
zipfile.BadZipFile: File is not a zip file

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\pythonlianxi\day23\基于langchian的智慧工厂知识助手实战\xianmu\main.py", line 165, in text_spliter_add
    shutil.rmtree(kb_dir)
  File "D:\python\Lib\shutil.py", line 787, in rmtree
    return _rmtree_unsafe(path, onerror)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\python\Lib\shutil.py", line 634, in _rmtree_unsafe
    onerror(os.unlink, fullname, sys.exc_info())
  File "D:\python\Lib\shutil.py", line 632, in _rmtree_unsafe
    os.unlink(fullname)
PermissionError: [WinError 32] 另一个程序正在使用此文件，进程无法访问。: 'D:\\pythonlianxi\\day23\\基于langchian的智慧工厂知识助手实战\\xianmu\\xiangliang\\chroma.sqlite3'
2025-10-30 19:30:35,049 - travel - ERROR - 添加文件到知识库失败：File is not a zip file
2025-10-30 19:30:35,049 - travel - ERROR - File is not a zip file
Traceback (most recent call last):
  File "D:\pythonlianxi\day23\基于langchian的智慧工厂知识助手实战\xianmu\main.py", line 125, in text_spliter_add
    doc = loader.load()
          ^^^^^^^^^^^^^
  File "D:\moxingxunihuanjing\mash3\Lib\site-packages\langchain_community\document_loaders\word_document.py", line 61, in load
    page_content=docx2txt.process(self.file_path),
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\moxingxunihuanjing\mash3\Lib\site-packages\docx2txt\docx2txt.py", line 76, in process
    zipf = zipfile.ZipFile(docx)
           ^^^^^^^^^^^^^^^^^^^^^
  File "D:\python\Lib\zipfile.py", line 1312, in __init__
    self._RealGetContents()
  File "D:\python\Lib\zipfile.py", line 1379, in _RealGetContents
    raise BadZipFile("File is not a zip file")
zipfile.BadZipFile: File is not a zip file
2025-10-30 19:30:35,050 - travel - ERROR - 重置数据库失败：[WinError 32] 另一个程序正在使用此文件，进程无法访问。: 'D:\\pythonlianxi\\day23\\基于langchian的智慧工厂知识助手实战\\xianmu\\xiangliang\\chroma.sqlite3'
2025-10-30 19:30:35,050 - travel - ERROR - [WinError 32] 另一个程序正在使用此文件，进程无法访问。: 'D:\\pythonlianxi\\day23\\基于langchian的智慧工厂知识助手实战\\xianmu\\xiangliang\\chroma.sqlite3'
Traceback (most recent call last):
  File "D:\pythonlianxi\day23\基于langchian的智慧工厂知识助手实战\xianmu\main.py", line 125, in text_spliter_add
    doc = loader.load()
          ^^^^^^^^^^^^^
  File "D:\moxingxunihuanjing\mash3\Lib\site-packages\langchain_community\document_loaders\word_document.py", line 61, in load
    page_content=docx2txt.process(self.file_path),
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\moxingxunihuanjing\mash3\Lib\site-packages\docx2txt\docx2txt.py", line 76, in process
    zipf = zipfile.ZipFile(docx)
           ^^^^^^^^^^^^^^^^^^^^^
  File "D:\python\Lib\zipfile.py", line 1312, in __init__
    self._RealGetContents()
  File "D:\python\Lib\zipfile.py", line 1379, in _RealGetContents
    raise BadZipFile("File is not a zip file")
zipfile.BadZipFile: File is not a zip file

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\pythonlianxi\day23\基于langchian的智慧工厂知识助手实战\xianmu\main.py", line 165, in text_spliter_add
    shutil.rmtree(kb_dir)
  File "D:\python\Lib\shutil.py", line 787, in rmtree
    return _rmtree_unsafe(path, onerror)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\python\Lib\shutil.py", line 634, in _rmtree_unsafe
    onerror(os.unlink, fullname, sys.exc_info())
  File "D:\python\Lib\shutil.py", line 632, in _rmtree_unsafe
    os.unlink(fullname)
PermissionError: [WinError 32] 另一个程序正在使用此文件，进程无法访问。: 'D:\\pythonlianxi\\day23\\基于langchian的智慧工厂知识助手实战\\xianmu\\xiangliang\\chroma.sqlite3'
2025-10-30 19:30:36,846 - travel - INFO - Langchain代理初始化成功
2025-10-30 19:30:53,931 - httpx - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-30 19:30:56,479 - httpx - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-30 19:30:58,240 - httpx - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-30 19:31:58,781 - chromadb.telemetry.product.posthog - INFO - Anonymized telemetry enabled. See                     https://docs.trychroma.com/telemetry for more information.
2025-10-30 19:32:01,111 - travel - ERROR - 添加文件到知识库失败：File is not a zip file
2025-10-30 19:32:01,112 - travel - ERROR - File is not a zip file
Traceback (most recent call last):
  File "D:\pythonlianxi\day23\基于langchian的智慧工厂知识助手实战\xianmu\main.py", line 125, in text_spliter_add
    doc = loader.load()
          ^^^^^^^^^^^^^
  File "D:\moxingxunihuanjing\mash3\Lib\site-packages\langchain_community\document_loaders\word_document.py", line 61, in load
    page_content=docx2txt.process(self.file_path),
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\moxingxunihuanjing\mash3\Lib\site-packages\docx2txt\docx2txt.py", line 76, in process
    zipf = zipfile.ZipFile(docx)
           ^^^^^^^^^^^^^^^^^^^^^
  File "D:\python\Lib\zipfile.py", line 1312, in __init__
    self._RealGetContents()
  File "D:\python\Lib\zipfile.py", line 1379, in _RealGetContents
    raise BadZipFile("File is not a zip file")
zipfile.BadZipFile: File is not a zip file
2025-10-30 19:32:01,114 - travel - ERROR - 重置数据库失败：[WinError 32] 另一个程序正在使用此文件，进程无法访问。: 'D:\\pythonlianxi\\day23\\基于langchian的智慧工厂知识助手实战\\xianmu\\xiangliang\\chroma.sqlite3'
2025-10-30 19:32:01,114 - travel - ERROR - [WinError 32] 另一个程序正在使用此文件，进程无法访问。: 'D:\\pythonlianxi\\day23\\基于langchian的智慧工厂知识助手实战\\xianmu\\xiangliang\\chroma.sqlite3'
Traceback (most recent call last):
  File "D:\pythonlianxi\day23\基于langchian的智慧工厂知识助手实战\xianmu\main.py", line 125, in text_spliter_add
    doc = loader.load()
          ^^^^^^^^^^^^^
  File "D:\moxingxunihuanjing\mash3\Lib\site-packages\langchain_community\document_loaders\word_document.py", line 61, in load
    page_content=docx2txt.process(self.file_path),
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\moxingxunihuanjing\mash3\Lib\site-packages\docx2txt\docx2txt.py", line 76, in process
    zipf = zipfile.ZipFile(docx)
           ^^^^^^^^^^^^^^^^^^^^^
  File "D:\python\Lib\zipfile.py", line 1312, in __init__
    self._RealGetContents()
  File "D:\python\Lib\zipfile.py", line 1379, in _RealGetContents
    raise BadZipFile("File is not a zip file")
zipfile.BadZipFile: File is not a zip file

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\pythonlianxi\day23\基于langchian的智慧工厂知识助手实战\xianmu\main.py", line 165, in text_spliter_add
    shutil.rmtree(kb_dir)
  File "D:\python\Lib\shutil.py", line 787, in rmtree
    return _rmtree_unsafe(path, onerror)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\python\Lib\shutil.py", line 634, in _rmtree_unsafe
    onerror(os.unlink, fullname, sys.exc_info())
  File "D:\python\Lib\shutil.py", line 632, in _rmtree_unsafe
    os.unlink(fullname)
PermissionError: [WinError 32] 另一个程序正在使用此文件，进程无法访问。: 'D:\\pythonlianxi\\day23\\基于langchian的智慧工厂知识助手实战\\xianmu\\xiangliang\\chroma.sqlite3'
2025-10-30 19:32:01,116 - travel - ERROR - 添加文件到知识库失败：File is not a zip file
2025-10-30 19:32:01,116 - travel - ERROR - File is not a zip file
Traceback (most recent call last):
  File "D:\pythonlianxi\day23\基于langchian的智慧工厂知识助手实战\xianmu\main.py", line 125, in text_spliter_add
    doc = loader.load()
          ^^^^^^^^^^^^^
  File "D:\moxingxunihuanjing\mash3\Lib\site-packages\langchain_community\document_loaders\word_document.py", line 61, in load
    page_content=docx2txt.process(self.file_path),
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\moxingxunihuanjing\mash3\Lib\site-packages\docx2txt\docx2txt.py", line 76, in process
    zipf = zipfile.ZipFile(docx)
           ^^^^^^^^^^^^^^^^^^^^^
  File "D:\python\Lib\zipfile.py", line 1312, in __init__
    self._RealGetContents()
  File "D:\python\Lib\zipfile.py", line 1379, in _RealGetContents
    raise BadZipFile("File is not a zip file")
zipfile.BadZipFile: File is not a zip file
2025-10-30 19:32:01,118 - travel - ERROR - 重置数据库失败：[WinError 32] 另一个程序正在使用此文件，进程无法访问。: 'D:\\pythonlianxi\\day23\\基于langchian的智慧工厂知识助手实战\\xianmu\\xiangliang\\chroma.sqlite3'
2025-10-30 19:32:01,118 - travel - ERROR - [WinError 32] 另一个程序正在使用此文件，进程无法访问。: 'D:\\pythonlianxi\\day23\\基于langchian的智慧工厂知识助手实战\\xianmu\\xiangliang\\chroma.sqlite3'
Traceback (most recent call last):
  File "D:\pythonlianxi\day23\基于langchian的智慧工厂知识助手实战\xianmu\main.py", line 125, in text_spliter_add
    doc = loader.load()
          ^^^^^^^^^^^^^
  File "D:\moxingxunihuanjing\mash3\Lib\site-packages\langchain_community\document_loaders\word_document.py", line 61, in load
    page_content=docx2txt.process(self.file_path),
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\moxingxunihuanjing\mash3\Lib\site-packages\docx2txt\docx2txt.py", line 76, in process
    zipf = zipfile.ZipFile(docx)
           ^^^^^^^^^^^^^^^^^^^^^
  File "D:\python\Lib\zipfile.py", line 1312, in __init__
    self._RealGetContents()
  File "D:\python\Lib\zipfile.py", line 1379, in _RealGetContents
    raise BadZipFile("File is not a zip file")
zipfile.BadZipFile: File is not a zip file

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\pythonlianxi\day23\基于langchian的智慧工厂知识助手实战\xianmu\main.py", line 165, in text_spliter_add
    shutil.rmtree(kb_dir)
  File "D:\python\Lib\shutil.py", line 787, in rmtree
    return _rmtree_unsafe(path, onerror)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\python\Lib\shutil.py", line 634, in _rmtree_unsafe
    onerror(os.unlink, fullname, sys.exc_info())
  File "D:\python\Lib\shutil.py", line 632, in _rmtree_unsafe
    os.unlink(fullname)
PermissionError: [WinError 32] 另一个程序正在使用此文件，进程无法访问。: 'D:\\pythonlianxi\\day23\\基于langchian的智慧工厂知识助手实战\\xianmu\\xiangliang\\chroma.sqlite3'
2025-10-30 19:32:02,813 - travel - INFO - Langchain代理初始化成功
2025-10-30 19:32:38,511 - chromadb.telemetry.product.posthog - INFO - Anonymized telemetry enabled. See                     https://docs.trychroma.com/telemetry for more information.
2025-10-30 19:32:40,647 - travel - ERROR - 添加文件到知识库失败：File is not a zip file
2025-10-30 19:32:40,647 - travel - ERROR - File is not a zip file
Traceback (most recent call last):
  File "D:\pythonlianxi\day23\基于langchian的智慧工厂知识助手实战\xianmu\main.py", line 125, in text_spliter_add
    doc = loader.load()
          ^^^^^^^^^^^^^
  File "D:\moxingxunihuanjing\mash3\Lib\site-packages\langchain_community\document_loaders\word_document.py", line 61, in load
    page_content=docx2txt.process(self.file_path),
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\moxingxunihuanjing\mash3\Lib\site-packages\docx2txt\docx2txt.py", line 76, in process
    zipf = zipfile.ZipFile(docx)
           ^^^^^^^^^^^^^^^^^^^^^
  File "D:\python\Lib\zipfile.py", line 1312, in __init__
    self._RealGetContents()
  File "D:\python\Lib\zipfile.py", line 1379, in _RealGetContents
    raise BadZipFile("File is not a zip file")
zipfile.BadZipFile: File is not a zip file
2025-10-30 19:32:40,650 - travel - ERROR - 重置数据库失败：[WinError 32] 另一个程序正在使用此文件，进程无法访问。: 'D:\\pythonlianxi\\day23\\基于langchian的智慧工厂知识助手实战\\xianmu\\xiangliang\\chroma.sqlite3'
2025-10-30 19:32:40,650 - travel - ERROR - [WinError 32] 另一个程序正在使用此文件，进程无法访问。: 'D:\\pythonlianxi\\day23\\基于langchian的智慧工厂知识助手实战\\xianmu\\xiangliang\\chroma.sqlite3'
Traceback (most recent call last):
  File "D:\pythonlianxi\day23\基于langchian的智慧工厂知识助手实战\xianmu\main.py", line 125, in text_spliter_add
    doc = loader.load()
          ^^^^^^^^^^^^^
  File "D:\moxingxunihuanjing\mash3\Lib\site-packages\langchain_community\document_loaders\word_document.py", line 61, in load
    page_content=docx2txt.process(self.file_path),
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\moxingxunihuanjing\mash3\Lib\site-packages\docx2txt\docx2txt.py", line 76, in process
    zipf = zipfile.ZipFile(docx)
           ^^^^^^^^^^^^^^^^^^^^^
  File "D:\python\Lib\zipfile.py", line 1312, in __init__
    self._RealGetContents()
  File "D:\python\Lib\zipfile.py", line 1379, in _RealGetContents
    raise BadZipFile("File is not a zip file")
zipfile.BadZipFile: File is not a zip file

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\pythonlianxi\day23\基于langchian的智慧工厂知识助手实战\xianmu\main.py", line 165, in text_spliter_add
    shutil.rmtree(kb_dir)
  File "D:\python\Lib\shutil.py", line 787, in rmtree
    return _rmtree_unsafe(path, onerror)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\python\Lib\shutil.py", line 634, in _rmtree_unsafe
    onerror(os.unlink, fullname, sys.exc_info())
  File "D:\python\Lib\shutil.py", line 632, in _rmtree_unsafe
    os.unlink(fullname)
PermissionError: [WinError 32] 另一个程序正在使用此文件，进程无法访问。: 'D:\\pythonlianxi\\day23\\基于langchian的智慧工厂知识助手实战\\xianmu\\xiangliang\\chroma.sqlite3'
2025-10-30 19:32:40,651 - travel - ERROR - 添加文件到知识库失败：File is not a zip file
2025-10-30 19:32:40,652 - travel - ERROR - File is not a zip file
Traceback (most recent call last):
  File "D:\pythonlianxi\day23\基于langchian的智慧工厂知识助手实战\xianmu\main.py", line 125, in text_spliter_add
    doc = loader.load()
          ^^^^^^^^^^^^^
  File "D:\moxingxunihuanjing\mash3\Lib\site-packages\langchain_community\document_loaders\word_document.py", line 61, in load
    page_content=docx2txt.process(self.file_path),
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\moxingxunihuanjing\mash3\Lib\site-packages\docx2txt\docx2txt.py", line 76, in process
    zipf = zipfile.ZipFile(docx)
           ^^^^^^^^^^^^^^^^^^^^^
  File "D:\python\Lib\zipfile.py", line 1312, in __init__
    self._RealGetContents()
  File "D:\python\Lib\zipfile.py", line 1379, in _RealGetContents
    raise BadZipFile("File is not a zip file")
zipfile.BadZipFile: File is not a zip file
2025-10-30 19:32:40,653 - travel - ERROR - 重置数据库失败：[WinError 32] 另一个程序正在使用此文件，进程无法访问。: 'D:\\pythonlianxi\\day23\\基于langchian的智慧工厂知识助手实战\\xianmu\\xiangliang\\chroma.sqlite3'
2025-10-30 19:32:40,653 - travel - ERROR - [WinError 32] 另一个程序正在使用此文件，进程无法访问。: 'D:\\pythonlianxi\\day23\\基于langchian的智慧工厂知识助手实战\\xianmu\\xiangliang\\chroma.sqlite3'
Traceback (most recent call last):
  File "D:\pythonlianxi\day23\基于langchian的智慧工厂知识助手实战\xianmu\main.py", line 125, in text_spliter_add
    doc = loader.load()
          ^^^^^^^^^^^^^
  File "D:\moxingxunihuanjing\mash3\Lib\site-packages\langchain_community\document_loaders\word_document.py", line 61, in load
    page_content=docx2txt.process(self.file_path),
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\moxingxunihuanjing\mash3\Lib\site-packages\docx2txt\docx2txt.py", line 76, in process
    zipf = zipfile.ZipFile(docx)
           ^^^^^^^^^^^^^^^^^^^^^
  File "D:\python\Lib\zipfile.py", line 1312, in __init__
    self._RealGetContents()
  File "D:\python\Lib\zipfile.py", line 1379, in _RealGetContents
    raise BadZipFile("File is not a zip file")
zipfile.BadZipFile: File is not a zip file

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\pythonlianxi\day23\基于langchian的智慧工厂知识助手实战\xianmu\main.py", line 165, in text_spliter_add
    shutil.rmtree(kb_dir)
  File "D:\python\Lib\shutil.py", line 787, in rmtree
    return _rmtree_unsafe(path, onerror)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\python\Lib\shutil.py", line 634, in _rmtree_unsafe
    onerror(os.unlink, fullname, sys.exc_info())
  File "D:\python\Lib\shutil.py", line 632, in _rmtree_unsafe
    os.unlink(fullname)
PermissionError: [WinError 32] 另一个程序正在使用此文件，进程无法访问。: 'D:\\pythonlianxi\\day23\\基于langchian的智慧工厂知识助手实战\\xianmu\\xiangliang\\chroma.sqlite3'
2025-10-30 19:32:41,951 - travel - INFO - Langchain代理初始化成功
2025-10-30 19:33:04,062 - httpx - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-30 19:33:05,721 - httpx - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-30 19:33:13,995 - httpx - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-30 19:34:20,379 - httpx - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-30 19:34:21,406 - httpx - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-30 19:34:22,797 - httpx - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-30 19:37:48,588 - httpx - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-30 19:37:49,437 - httpx - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-30 19:37:51,008 - httpx - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-30 19:38:24,527 - httpx - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-30 19:38:25,547 - httpx - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-30 19:38:27,156 - httpx - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-30 19:41:12,906 - httpx - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-30 19:41:14,050 - httpx - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-30 19:41:16,028 - httpx - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-30 19:59:21,707 - chromadb.telemetry.product.posthog - INFO - Anonymized telemetry enabled. See                     https://docs.trychroma.com/telemetry for more information.
2025-10-30 19:59:23,679 - travel - ERROR - 添加文件到知识库失败：File is not a zip file
2025-10-30 19:59:23,679 - travel - ERROR - File is not a zip file
Traceback (most recent call last):
  File "D:\pythonlianxi\day23\基于langchian的智慧工厂知识助手实战\xianmu\main.py", line 125, in text_spliter_add
    doc = loader.load()
          ^^^^^^^^^^^^^
  File "D:\moxingxunihuanjing\mash3\Lib\site-packages\langchain_community\document_loaders\word_document.py", line 61, in load
    page_content=docx2txt.process(self.file_path),
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\moxingxunihuanjing\mash3\Lib\site-packages\docx2txt\docx2txt.py", line 76, in process
    zipf = zipfile.ZipFile(docx)
           ^^^^^^^^^^^^^^^^^^^^^
  File "D:\python\Lib\zipfile.py", line 1312, in __init__
    self._RealGetContents()
  File "D:\python\Lib\zipfile.py", line 1379, in _RealGetContents
    raise BadZipFile("File is not a zip file")
zipfile.BadZipFile: File is not a zip file
2025-10-30 19:59:23,681 - travel - ERROR - 重置数据库失败：[WinError 32] 另一个程序正在使用此文件，进程无法访问。: 'D:\\pythonlianxi\\day23\\基于langchian的智慧工厂知识助手实战\\xianmu\\xiangliang\\chroma.sqlite3'
2025-10-30 19:59:23,681 - travel - ERROR - [WinError 32] 另一个程序正在使用此文件，进程无法访问。: 'D:\\pythonlianxi\\day23\\基于langchian的智慧工厂知识助手实战\\xianmu\\xiangliang\\chroma.sqlite3'
Traceback (most recent call last):
  File "D:\pythonlianxi\day23\基于langchian的智慧工厂知识助手实战\xianmu\main.py", line 125, in text_spliter_add
    doc = loader.load()
          ^^^^^^^^^^^^^
  File "D:\moxingxunihuanjing\mash3\Lib\site-packages\langchain_community\document_loaders\word_document.py", line 61, in load
    page_content=docx2txt.process(self.file_path),
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\moxingxunihuanjing\mash3\Lib\site-packages\docx2txt\docx2txt.py", line 76, in process
    zipf = zipfile.ZipFile(docx)
           ^^^^^^^^^^^^^^^^^^^^^
  File "D:\python\Lib\zipfile.py", line 1312, in __init__
    self._RealGetContents()
  File "D:\python\Lib\zipfile.py", line 1379, in _RealGetContents
    raise BadZipFile("File is not a zip file")
zipfile.BadZipFile: File is not a zip file

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\pythonlianxi\day23\基于langchian的智慧工厂知识助手实战\xianmu\main.py", line 165, in text_spliter_add
    shutil.rmtree(kb_dir)
  File "D:\python\Lib\shutil.py", line 787, in rmtree
    return _rmtree_unsafe(path, onerror)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\python\Lib\shutil.py", line 634, in _rmtree_unsafe
    onerror(os.unlink, fullname, sys.exc_info())
  File "D:\python\Lib\shutil.py", line 632, in _rmtree_unsafe
    os.unlink(fullname)
PermissionError: [WinError 32] 另一个程序正在使用此文件，进程无法访问。: 'D:\\pythonlianxi\\day23\\基于langchian的智慧工厂知识助手实战\\xianmu\\xiangliang\\chroma.sqlite3'
2025-10-30 19:59:24,846 - travel - INFO - Langchain代理初始化成功
2025-10-30 19:59:47,162 - httpx - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-30 20:00:06,092 - httpx - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-30 20:00:07,222 - httpx - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-30 20:00:10,579 - httpx - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-30 20:09:29,656 - chromadb.telemetry.product.posthog - INFO - Anonymized telemetry enabled. See                     https://docs.trychroma.com/telemetry for more information.
2025-10-30 20:09:31,296 - travel - ERROR - 添加文件到知识库失败：File is not a zip file
2025-10-30 20:09:31,296 - travel - ERROR - File is not a zip file
Traceback (most recent call last):
  File "D:\pythonlianxi\day23\基于langchian的智慧工厂知识助手实战\xianmu\main.py", line 125, in text_spliter_add
    doc = loader.load()
          ^^^^^^^^^^^^^
  File "D:\moxingxunihuanjing\mash3\Lib\site-packages\langchain_community\document_loaders\word_document.py", line 61, in load
    page_content=docx2txt.process(self.file_path),
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\moxingxunihuanjing\mash3\Lib\site-packages\docx2txt\docx2txt.py", line 76, in process
    zipf = zipfile.ZipFile(docx)
           ^^^^^^^^^^^^^^^^^^^^^
  File "D:\python\Lib\zipfile.py", line 1312, in __init__
    self._RealGetContents()
  File "D:\python\Lib\zipfile.py", line 1379, in _RealGetContents
    raise BadZipFile("File is not a zip file")
zipfile.BadZipFile: File is not a zip file
2025-10-30 20:09:31,298 - travel - ERROR - 重置数据库失败：[WinError 32] 另一个程序正在使用此文件，进程无法访问。: 'D:\\pythonlianxi\\day23\\基于langchian的智慧工厂知识助手实战\\xianmu\\xiangliang\\chroma.sqlite3'
2025-10-30 20:09:31,298 - travel - ERROR - [WinError 32] 另一个程序正在使用此文件，进程无法访问。: 'D:\\pythonlianxi\\day23\\基于langchian的智慧工厂知识助手实战\\xianmu\\xiangliang\\chroma.sqlite3'
Traceback (most recent call last):
  File "D:\pythonlianxi\day23\基于langchian的智慧工厂知识助手实战\xianmu\main.py", line 125, in text_spliter_add
    doc = loader.load()
          ^^^^^^^^^^^^^
  File "D:\moxingxunihuanjing\mash3\Lib\site-packages\langchain_community\document_loaders\word_document.py", line 61, in load
    page_content=docx2txt.process(self.file_path),
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\moxingxunihuanjing\mash3\Lib\site-packages\docx2txt\docx2txt.py", line 76, in process
    zipf = zipfile.ZipFile(docx)
           ^^^^^^^^^^^^^^^^^^^^^
  File "D:\python\Lib\zipfile.py", line 1312, in __init__
    self._RealGetContents()
  File "D:\python\Lib\zipfile.py", line 1379, in _RealGetContents
    raise BadZipFile("File is not a zip file")
zipfile.BadZipFile: File is not a zip file

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\pythonlianxi\day23\基于langchian的智慧工厂知识助手实战\xianmu\main.py", line 165, in text_spliter_add
    shutil.rmtree(kb_dir)
  File "D:\python\Lib\shutil.py", line 787, in rmtree
    return _rmtree_unsafe(path, onerror)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\python\Lib\shutil.py", line 634, in _rmtree_unsafe
    onerror(os.unlink, fullname, sys.exc_info())
  File "D:\python\Lib\shutil.py", line 632, in _rmtree_unsafe
    os.unlink(fullname)
PermissionError: [WinError 32] 另一个程序正在使用此文件，进程无法访问。: 'D:\\pythonlianxi\\day23\\基于langchian的智慧工厂知识助手实战\\xianmu\\xiangliang\\chroma.sqlite3'
2025-10-30 20:09:32,550 - travel - INFO - Langchain代理初始化成功
2025-10-30 20:09:48,474 - httpx - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-30 20:09:49,876 - httpx - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-30 20:16:10,044 - chromadb.telemetry.product.posthog - INFO - Anonymized telemetry enabled. See                     https://docs.trychroma.com/telemetry for more information.
2025-10-30 20:16:10,310 - travel - ERROR - 添加文件到知识库失败：'_type'
2025-10-30 20:16:10,311 - travel - ERROR - '_type'
Traceback (most recent call last):
  File "G:\xwechat_files\wxid_cljs8n445yat22_40a5\msg\file\2025-10\智能ai导游系统\xianmu\main.py", line 137, in text_spliter_add
    vector_db = Chroma(
                ^^^^^^^
  File "E:\linkyw\linkyw\Lib\site-packages\langchain_chroma\vectorstores.py", line 342, in __init__
    self.__ensure_collection()
  File "E:\linkyw\linkyw\Lib\site-packages\langchain_chroma\vectorstores.py", line 349, in __ensure_collection
    self._chroma_collection = self._client.get_or_create_collection(
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\linkyw\linkyw\Lib\site-packages\chromadb\api\client.py", line 194, in get_or_create_collection
    model = self._server.get_or_create_collection(
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\linkyw\linkyw\Lib\site-packages\chromadb\telemetry\opentelemetry\__init__.py", line 150, in wrapper
    return f(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^
  File "E:\linkyw\linkyw\Lib\site-packages\chromadb\api\segment.py", line 103, in wrapper
    return self._rate_limit_enforcer.rate_limit(func)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\linkyw\linkyw\Lib\site-packages\chromadb\rate_limit\simple_rate_limit\__init__.py", line 24, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "E:\linkyw\linkyw\Lib\site-packages\chromadb\api\segment.py", line 288, in get_or_create_collection
    return self.create_collection(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\linkyw\linkyw\Lib\site-packages\chromadb\telemetry\opentelemetry\__init__.py", line 150, in wrapper
    return f(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^
  File "E:\linkyw\linkyw\Lib\site-packages\chromadb\api\segment.py", line 103, in wrapper
    return self._rate_limit_enforcer.rate_limit(func)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\linkyw\linkyw\Lib\site-packages\chromadb\rate_limit\simple_rate_limit\__init__.py", line 24, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "E:\linkyw\linkyw\Lib\site-packages\chromadb\api\segment.py", line 242, in create_collection
    coll, created = self._sysdb.create_collection(
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\linkyw\linkyw\Lib\site-packages\chromadb\telemetry\opentelemetry\__init__.py", line 150, in wrapper
    return f(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^
  File "E:\linkyw\linkyw\Lib\site-packages\chromadb\db\mixins\sysdb.py", line 294, in create_collection
    existing = self.get_collections(name=name, tenant=tenant, database=database)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\linkyw\linkyw\Lib\site-packages\chromadb\telemetry\opentelemetry\__init__.py", line 150, in wrapper
    return f(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^
  File "E:\linkyw\linkyw\Lib\site-packages\chromadb\db\mixins\sysdb.py", line 521, in get_collections
    configuration = self._load_config_from_json_str_and_migrate(
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\linkyw\linkyw\Lib\site-packages\chromadb\db\mixins\sysdb.py", line 886, in _load_config_from_json_str_and_migrate
    return CollectionConfigurationInternal.from_json_str(json_str)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\linkyw\linkyw\Lib\site-packages\chromadb\api\configuration.py", line 188, in from_json_str
    return cls.from_json(config_json)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\linkyw\linkyw\Lib\site-packages\chromadb\api\configuration.py", line 209, in from_json
    f"Trying to instantiate configuration of type {cls.__name__} from JSON with type {json_map['_type']}"
                                                                                      ~~~~~~~~^^^^^^^^^
KeyError: '_type'
2025-10-30 20:16:10,381 - travel - ERROR - 重置数据库失败：[WinError 32] 另一个程序正在使用此文件，进程无法访问。: 'G:\\xwechat_files\\wxid_cljs8n445yat22_40a5\\msg\\file\\2025-10\\智能ai导游系统\\xianmu\\xiangliang\\chroma.sqlite3'
2025-10-30 20:16:10,382 - travel - ERROR - [WinError 32] 另一个程序正在使用此文件，进程无法访问。: 'G:\\xwechat_files\\wxid_cljs8n445yat22_40a5\\msg\\file\\2025-10\\智能ai导游系统\\xianmu\\xiangliang\\chroma.sqlite3'
Traceback (most recent call last):
  File "G:\xwechat_files\wxid_cljs8n445yat22_40a5\msg\file\2025-10\智能ai导游系统\xianmu\main.py", line 137, in text_spliter_add
    vector_db = Chroma(
                ^^^^^^^
  File "E:\linkyw\linkyw\Lib\site-packages\langchain_chroma\vectorstores.py", line 342, in __init__
    self.__ensure_collection()
  File "E:\linkyw\linkyw\Lib\site-packages\langchain_chroma\vectorstores.py", line 349, in __ensure_collection
    self._chroma_collection = self._client.get_or_create_collection(
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\linkyw\linkyw\Lib\site-packages\chromadb\api\client.py", line 194, in get_or_create_collection
    model = self._server.get_or_create_collection(
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\linkyw\linkyw\Lib\site-packages\chromadb\telemetry\opentelemetry\__init__.py", line 150, in wrapper
    return f(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^
  File "E:\linkyw\linkyw\Lib\site-packages\chromadb\api\segment.py", line 103, in wrapper
    return self._rate_limit_enforcer.rate_limit(func)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\linkyw\linkyw\Lib\site-packages\chromadb\rate_limit\simple_rate_limit\__init__.py", line 24, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "E:\linkyw\linkyw\Lib\site-packages\chromadb\api\segment.py", line 288, in get_or_create_collection
    return self.create_collection(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\linkyw\linkyw\Lib\site-packages\chromadb\telemetry\opentelemetry\__init__.py", line 150, in wrapper
    return f(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^
  File "E:\linkyw\linkyw\Lib\site-packages\chromadb\api\segment.py", line 103, in wrapper
    return self._rate_limit_enforcer.rate_limit(func)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\linkyw\linkyw\Lib\site-packages\chromadb\rate_limit\simple_rate_limit\__init__.py", line 24, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "E:\linkyw\linkyw\Lib\site-packages\chromadb\api\segment.py", line 242, in create_collection
    coll, created = self._sysdb.create_collection(
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\linkyw\linkyw\Lib\site-packages\chromadb\telemetry\opentelemetry\__init__.py", line 150, in wrapper
    return f(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^
  File "E:\linkyw\linkyw\Lib\site-packages\chromadb\db\mixins\sysdb.py", line 294, in create_collection
    existing = self.get_collections(name=name, tenant=tenant, database=database)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\linkyw\linkyw\Lib\site-packages\chromadb\telemetry\opentelemetry\__init__.py", line 150, in wrapper
    return f(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^
  File "E:\linkyw\linkyw\Lib\site-packages\chromadb\db\mixins\sysdb.py", line 521, in get_collections
    configuration = self._load_config_from_json_str_and_migrate(
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\linkyw\linkyw\Lib\site-packages\chromadb\db\mixins\sysdb.py", line 886, in _load_config_from_json_str_and_migrate
    return CollectionConfigurationInternal.from_json_str(json_str)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\linkyw\linkyw\Lib\site-packages\chromadb\api\configuration.py", line 188, in from_json_str
    return cls.from_json(config_json)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\linkyw\linkyw\Lib\site-packages\chromadb\api\configuration.py", line 209, in from_json
    f"Trying to instantiate configuration of type {cls.__name__} from JSON with type {json_map['_type']}"
                                                                                      ~~~~~~~~^^^^^^^^^
KeyError: '_type'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "G:\xwechat_files\wxid_cljs8n445yat22_40a5\msg\file\2025-10\智能ai导游系统\xianmu\main.py", line 165, in text_spliter_add
    shutil.rmtree(kb_dir)
  File "C:\Users\link\AppData\Local\Programs\Python\Python311\Lib\shutil.py", line 787, in rmtree
    return _rmtree_unsafe(path, onerror)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\link\AppData\Local\Programs\Python\Python311\Lib\shutil.py", line 634, in _rmtree_unsafe
    onerror(os.unlink, fullname, sys.exc_info())
  File "C:\Users\link\AppData\Local\Programs\Python\Python311\Lib\shutil.py", line 632, in _rmtree_unsafe
    os.unlink(fullname)
PermissionError: [WinError 32] 另一个程序正在使用此文件，进程无法访问。: 'G:\\xwechat_files\\wxid_cljs8n445yat22_40a5\\msg\\file\\2025-10\\智能ai导游系统\\xianmu\\xiangliang\\chroma.sqlite3'
2025-10-30 20:16:10,386 - travel - ERROR - 添加文件到知识库失败：File is not a zip file
2025-10-30 20:16:10,386 - travel - ERROR - File is not a zip file
Traceback (most recent call last):
  File "G:\xwechat_files\wxid_cljs8n445yat22_40a5\msg\file\2025-10\智能ai导游系统\xianmu\main.py", line 125, in text_spliter_add
    doc = loader.load()
          ^^^^^^^^^^^^^
  File "E:\linkyw\linkyw\Lib\site-packages\langchain_community\document_loaders\word_document.py", line 61, in load
    page_content=docx2txt.process(self.file_path),
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\linkyw\linkyw\Lib\site-packages\docx2txt\docx2txt.py", line 76, in process
    zipf = zipfile.ZipFile(docx)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\link\AppData\Local\Programs\Python\Python311\Lib\zipfile.py", line 1312, in __init__
    self._RealGetContents()
  File "C:\Users\link\AppData\Local\Programs\Python\Python311\Lib\zipfile.py", line 1379, in _RealGetContents
    raise BadZipFile("File is not a zip file")
zipfile.BadZipFile: File is not a zip file
2025-10-30 20:16:10,408 - travel - ERROR - 重置数据库失败：[WinError 32] 另一个程序正在使用此文件，进程无法访问。: 'G:\\xwechat_files\\wxid_cljs8n445yat22_40a5\\msg\\file\\2025-10\\智能ai导游系统\\xianmu\\xiangliang\\chroma.sqlite3'
2025-10-30 20:16:10,408 - travel - ERROR - [WinError 32] 另一个程序正在使用此文件，进程无法访问。: 'G:\\xwechat_files\\wxid_cljs8n445yat22_40a5\\msg\\file\\2025-10\\智能ai导游系统\\xianmu\\xiangliang\\chroma.sqlite3'
Traceback (most recent call last):
  File "G:\xwechat_files\wxid_cljs8n445yat22_40a5\msg\file\2025-10\智能ai导游系统\xianmu\main.py", line 125, in text_spliter_add
    doc = loader.load()
          ^^^^^^^^^^^^^
  File "E:\linkyw\linkyw\Lib\site-packages\langchain_community\document_loaders\word_document.py", line 61, in load
    page_content=docx2txt.process(self.file_path),
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\linkyw\linkyw\Lib\site-packages\docx2txt\docx2txt.py", line 76, in process
    zipf = zipfile.ZipFile(docx)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\link\AppData\Local\Programs\Python\Python311\Lib\zipfile.py", line 1312, in __init__
    self._RealGetContents()
  File "C:\Users\link\AppData\Local\Programs\Python\Python311\Lib\zipfile.py", line 1379, in _RealGetContents
    raise BadZipFile("File is not a zip file")
zipfile.BadZipFile: File is not a zip file

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "G:\xwechat_files\wxid_cljs8n445yat22_40a5\msg\file\2025-10\智能ai导游系统\xianmu\main.py", line 165, in text_spliter_add
    shutil.rmtree(kb_dir)
  File "C:\Users\link\AppData\Local\Programs\Python\Python311\Lib\shutil.py", line 787, in rmtree
    return _rmtree_unsafe(path, onerror)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\link\AppData\Local\Programs\Python\Python311\Lib\shutil.py", line 634, in _rmtree_unsafe
    onerror(os.unlink, fullname, sys.exc_info())
  File "C:\Users\link\AppData\Local\Programs\Python\Python311\Lib\shutil.py", line 632, in _rmtree_unsafe
    os.unlink(fullname)
PermissionError: [WinError 32] 另一个程序正在使用此文件，进程无法访问。: 'G:\\xwechat_files\\wxid_cljs8n445yat22_40a5\\msg\\file\\2025-10\\智能ai导游系统\\xianmu\\xiangliang\\chroma.sqlite3'
2025-10-30 20:16:10,420 - travel - ERROR - 添加文件到知识库失败：'_type'
2025-10-30 20:16:10,420 - travel - ERROR - '_type'
Traceback (most recent call last):
  File "G:\xwechat_files\wxid_cljs8n445yat22_40a5\msg\file\2025-10\智能ai导游系统\xianmu\main.py", line 137, in text_spliter_add
    vector_db = Chroma(
                ^^^^^^^
  File "E:\linkyw\linkyw\Lib\site-packages\langchain_chroma\vectorstores.py", line 342, in __init__
    self.__ensure_collection()
  File "E:\linkyw\linkyw\Lib\site-packages\langchain_chroma\vectorstores.py", line 349, in __ensure_collection
    self._chroma_collection = self._client.get_or_create_collection(
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\linkyw\linkyw\Lib\site-packages\chromadb\api\client.py", line 194, in get_or_create_collection
    model = self._server.get_or_create_collection(
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\linkyw\linkyw\Lib\site-packages\chromadb\telemetry\opentelemetry\__init__.py", line 150, in wrapper
    return f(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^
  File "E:\linkyw\linkyw\Lib\site-packages\chromadb\api\segment.py", line 103, in wrapper
    return self._rate_limit_enforcer.rate_limit(func)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\linkyw\linkyw\Lib\site-packages\chromadb\rate_limit\simple_rate_limit\__init__.py", line 24, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "E:\linkyw\linkyw\Lib\site-packages\chromadb\api\segment.py", line 288, in get_or_create_collection
    return self.create_collection(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\linkyw\linkyw\Lib\site-packages\chromadb\telemetry\opentelemetry\__init__.py", line 150, in wrapper
    return f(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^
  File "E:\linkyw\linkyw\Lib\site-packages\chromadb\api\segment.py", line 103, in wrapper
    return self._rate_limit_enforcer.rate_limit(func)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\linkyw\linkyw\Lib\site-packages\chromadb\rate_limit\simple_rate_limit\__init__.py", line 24, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "E:\linkyw\linkyw\Lib\site-packages\chromadb\api\segment.py", line 242, in create_collection
    coll, created = self._sysdb.create_collection(
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\linkyw\linkyw\Lib\site-packages\chromadb\telemetry\opentelemetry\__init__.py", line 150, in wrapper
    return f(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^
  File "E:\linkyw\linkyw\Lib\site-packages\chromadb\db\mixins\sysdb.py", line 294, in create_collection
    existing = self.get_collections(name=name, tenant=tenant, database=database)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\linkyw\linkyw\Lib\site-packages\chromadb\telemetry\opentelemetry\__init__.py", line 150, in wrapper
    return f(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^
  File "E:\linkyw\linkyw\Lib\site-packages\chromadb\db\mixins\sysdb.py", line 521, in get_collections
    configuration = self._load_config_from_json_str_and_migrate(
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\linkyw\linkyw\Lib\site-packages\chromadb\db\mixins\sysdb.py", line 886, in _load_config_from_json_str_and_migrate
    return CollectionConfigurationInternal.from_json_str(json_str)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\linkyw\linkyw\Lib\site-packages\chromadb\api\configuration.py", line 188, in from_json_str
    return cls.from_json(config_json)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\linkyw\linkyw\Lib\site-packages\chromadb\api\configuration.py", line 209, in from_json
    f"Trying to instantiate configuration of type {cls.__name__} from JSON with type {json_map['_type']}"
                                                                                      ~~~~~~~~^^^^^^^^^
KeyError: '_type'
2025-10-30 20:16:10,422 - travel - ERROR - 重置数据库失败：[WinError 32] 另一个程序正在使用此文件，进程无法访问。: 'G:\\xwechat_files\\wxid_cljs8n445yat22_40a5\\msg\\file\\2025-10\\智能ai导游系统\\xianmu\\xiangliang\\chroma.sqlite3'
2025-10-30 20:16:10,422 - travel - ERROR - [WinError 32] 另一个程序正在使用此文件，进程无法访问。: 'G:\\xwechat_files\\wxid_cljs8n445yat22_40a5\\msg\\file\\2025-10\\智能ai导游系统\\xianmu\\xiangliang\\chroma.sqlite3'
Traceback (most recent call last):
  File "G:\xwechat_files\wxid_cljs8n445yat22_40a5\msg\file\2025-10\智能ai导游系统\xianmu\main.py", line 137, in text_spliter_add
    vector_db = Chroma(
                ^^^^^^^
  File "E:\linkyw\linkyw\Lib\site-packages\langchain_chroma\vectorstores.py", line 342, in __init__
    self.__ensure_collection()
  File "E:\linkyw\linkyw\Lib\site-packages\langchain_chroma\vectorstores.py", line 349, in __ensure_collection
    self._chroma_collection = self._client.get_or_create_collection(
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\linkyw\linkyw\Lib\site-packages\chromadb\api\client.py", line 194, in get_or_create_collection
    model = self._server.get_or_create_collection(
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\linkyw\linkyw\Lib\site-packages\chromadb\telemetry\opentelemetry\__init__.py", line 150, in wrapper
    return f(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^
  File "E:\linkyw\linkyw\Lib\site-packages\chromadb\api\segment.py", line 103, in wrapper
    return self._rate_limit_enforcer.rate_limit(func)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\linkyw\linkyw\Lib\site-packages\chromadb\rate_limit\simple_rate_limit\__init__.py", line 24, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "E:\linkyw\linkyw\Lib\site-packages\chromadb\api\segment.py", line 288, in get_or_create_collection
    return self.create_collection(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\linkyw\linkyw\Lib\site-packages\chromadb\telemetry\opentelemetry\__init__.py", line 150, in wrapper
    return f(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^
  File "E:\linkyw\linkyw\Lib\site-packages\chromadb\api\segment.py", line 103, in wrapper
    return self._rate_limit_enforcer.rate_limit(func)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\linkyw\linkyw\Lib\site-packages\chromadb\rate_limit\simple_rate_limit\__init__.py", line 24, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "E:\linkyw\linkyw\Lib\site-packages\chromadb\api\segment.py", line 242, in create_collection
    coll, created = self._sysdb.create_collection(
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\linkyw\linkyw\Lib\site-packages\chromadb\telemetry\opentelemetry\__init__.py", line 150, in wrapper
    return f(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^
  File "E:\linkyw\linkyw\Lib\site-packages\chromadb\db\mixins\sysdb.py", line 294, in create_collection
    existing = self.get_collections(name=name, tenant=tenant, database=database)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\linkyw\linkyw\Lib\site-packages\chromadb\telemetry\opentelemetry\__init__.py", line 150, in wrapper
    return f(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^
  File "E:\linkyw\linkyw\Lib\site-packages\chromadb\db\mixins\sysdb.py", line 521, in get_collections
    configuration = self._load_config_from_json_str_and_migrate(
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\linkyw\linkyw\Lib\site-packages\chromadb\db\mixins\sysdb.py", line 886, in _load_config_from_json_str_and_migrate
    return CollectionConfigurationInternal.from_json_str(json_str)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\linkyw\linkyw\Lib\site-packages\chromadb\api\configuration.py", line 188, in from_json_str
    return cls.from_json(config_json)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\linkyw\linkyw\Lib\site-packages\chromadb\api\configuration.py", line 209, in from_json
    f"Trying to instantiate configuration of type {cls.__name__} from JSON with type {json_map['_type']}"
                                                                                      ~~~~~~~~^^^^^^^^^
KeyError: '_type'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "G:\xwechat_files\wxid_cljs8n445yat22_40a5\msg\file\2025-10\智能ai导游系统\xianmu\main.py", line 165, in text_spliter_add
    shutil.rmtree(kb_dir)
  File "C:\Users\link\AppData\Local\Programs\Python\Python311\Lib\shutil.py", line 787, in rmtree
    return _rmtree_unsafe(path, onerror)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\link\AppData\Local\Programs\Python\Python311\Lib\shutil.py", line 634, in _rmtree_unsafe
    onerror(os.unlink, fullname, sys.exc_info())
  File "C:\Users\link\AppData\Local\Programs\Python\Python311\Lib\shutil.py", line 632, in _rmtree_unsafe
    os.unlink(fullname)
PermissionError: [WinError 32] 另一个程序正在使用此文件，进程无法访问。: 'G:\\xwechat_files\\wxid_cljs8n445yat22_40a5\\msg\\file\\2025-10\\智能ai导游系统\\xianmu\\xiangliang\\chroma.sqlite3'
2025-10-30 20:16:10,436 - travel - ERROR - 添加文件到知识库失败：'_type'
2025-10-30 20:16:10,436 - travel - ERROR - '_type'
Traceback (most recent call last):
  File "G:\xwechat_files\wxid_cljs8n445yat22_40a5\msg\file\2025-10\智能ai导游系统\xianmu\main.py", line 137, in text_spliter_add
    vector_db = Chroma(
                ^^^^^^^
  File "E:\linkyw\linkyw\Lib\site-packages\langchain_chroma\vectorstores.py", line 342, in __init__
    self.__ensure_collection()
  File "E:\linkyw\linkyw\Lib\site-packages\langchain_chroma\vectorstores.py", line 349, in __ensure_collection
    self._chroma_collection = self._client.get_or_create_collection(
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\linkyw\linkyw\Lib\site-packages\chromadb\api\client.py", line 194, in get_or_create_collection
    model = self._server.get_or_create_collection(
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\linkyw\linkyw\Lib\site-packages\chromadb\telemetry\opentelemetry\__init__.py", line 150, in wrapper
    return f(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^
  File "E:\linkyw\linkyw\Lib\site-packages\chromadb\api\segment.py", line 103, in wrapper
    return self._rate_limit_enforcer.rate_limit(func)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\linkyw\linkyw\Lib\site-packages\chromadb\rate_limit\simple_rate_limit\__init__.py", line 24, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "E:\linkyw\linkyw\Lib\site-packages\chromadb\api\segment.py", line 288, in get_or_create_collection
    return self.create_collection(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\linkyw\linkyw\Lib\site-packages\chromadb\telemetry\opentelemetry\__init__.py", line 150, in wrapper
    return f(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^
  File "E:\linkyw\linkyw\Lib\site-packages\chromadb\api\segment.py", line 103, in wrapper
    return self._rate_limit_enforcer.rate_limit(func)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\linkyw\linkyw\Lib\site-packages\chromadb\rate_limit\simple_rate_limit\__init__.py", line 24, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "E:\linkyw\linkyw\Lib\site-packages\chromadb\api\segment.py", line 242, in create_collection
    coll, created = self._sysdb.create_collection(
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\linkyw\linkyw\Lib\site-packages\chromadb\telemetry\opentelemetry\__init__.py", line 150, in wrapper
    return f(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^
  File "E:\linkyw\linkyw\Lib\site-packages\chromadb\db\mixins\sysdb.py", line 294, in create_collection
    existing = self.get_collections(name=name, tenant=tenant, database=database)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\linkyw\linkyw\Lib\site-packages\chromadb\telemetry\opentelemetry\__init__.py", line 150, in wrapper
    return f(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^
  File "E:\linkyw\linkyw\Lib\site-packages\chromadb\db\mixins\sysdb.py", line 521, in get_collections
    configuration = self._load_config_from_json_str_and_migrate(
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\linkyw\linkyw\Lib\site-packages\chromadb\db\mixins\sysdb.py", line 886, in _load_config_from_json_str_and_migrate
    return CollectionConfigurationInternal.from_json_str(json_str)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\linkyw\linkyw\Lib\site-packages\chromadb\api\configuration.py", line 188, in from_json_str
    return cls.from_json(config_json)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\linkyw\linkyw\Lib\site-packages\chromadb\api\configuration.py", line 209, in from_json
    f"Trying to instantiate configuration of type {cls.__name__} from JSON with type {json_map['_type']}"
                                                                                      ~~~~~~~~^^^^^^^^^
KeyError: '_type'
2025-10-30 20:16:10,437 - travel - ERROR - 重置数据库失败：[WinError 32] 另一个程序正在使用此文件，进程无法访问。: 'G:\\xwechat_files\\wxid_cljs8n445yat22_40a5\\msg\\file\\2025-10\\智能ai导游系统\\xianmu\\xiangliang\\chroma.sqlite3'
2025-10-30 20:16:10,437 - travel - ERROR - [WinError 32] 另一个程序正在使用此文件，进程无法访问。: 'G:\\xwechat_files\\wxid_cljs8n445yat22_40a5\\msg\\file\\2025-10\\智能ai导游系统\\xianmu\\xiangliang\\chroma.sqlite3'
Traceback (most recent call last):
  File "G:\xwechat_files\wxid_cljs8n445yat22_40a5\msg\file\2025-10\智能ai导游系统\xianmu\main.py", line 137, in text_spliter_add
    vector_db = Chroma(
                ^^^^^^^
  File "E:\linkyw\linkyw\Lib\site-packages\langchain_chroma\vectorstores.py", line 342, in __init__
    self.__ensure_collection()
  File "E:\linkyw\linkyw\Lib\site-packages\langchain_chroma\vectorstores.py", line 349, in __ensure_collection
    self._chroma_collection = self._client.get_or_create_collection(
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\linkyw\linkyw\Lib\site-packages\chromadb\api\client.py", line 194, in get_or_create_collection
    model = self._server.get_or_create_collection(
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\linkyw\linkyw\Lib\site-packages\chromadb\telemetry\opentelemetry\__init__.py", line 150, in wrapper
    return f(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^
  File "E:\linkyw\linkyw\Lib\site-packages\chromadb\api\segment.py", line 103, in wrapper
    return self._rate_limit_enforcer.rate_limit(func)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\linkyw\linkyw\Lib\site-packages\chromadb\rate_limit\simple_rate_limit\__init__.py", line 24, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "E:\linkyw\linkyw\Lib\site-packages\chromadb\api\segment.py", line 288, in get_or_create_collection
    return self.create_collection(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\linkyw\linkyw\Lib\site-packages\chromadb\telemetry\opentelemetry\__init__.py", line 150, in wrapper
    return f(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^
  File "E:\linkyw\linkyw\Lib\site-packages\chromadb\api\segment.py", line 103, in wrapper
    return self._rate_limit_enforcer.rate_limit(func)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\linkyw\linkyw\Lib\site-packages\chromadb\rate_limit\simple_rate_limit\__init__.py", line 24, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "E:\linkyw\linkyw\Lib\site-packages\chromadb\api\segment.py", line 242, in create_collection
    coll, created = self._sysdb.create_collection(
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\linkyw\linkyw\Lib\site-packages\chromadb\telemetry\opentelemetry\__init__.py", line 150, in wrapper
    return f(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^
  File "E:\linkyw\linkyw\Lib\site-packages\chromadb\db\mixins\sysdb.py", line 294, in create_collection
    existing = self.get_collections(name=name, tenant=tenant, database=database)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\linkyw\linkyw\Lib\site-packages\chromadb\telemetry\opentelemetry\__init__.py", line 150, in wrapper
    return f(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^
  File "E:\linkyw\linkyw\Lib\site-packages\chromadb\db\mixins\sysdb.py", line 521, in get_collections
    configuration = self._load_config_from_json_str_and_migrate(
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\linkyw\linkyw\Lib\site-packages\chromadb\db\mixins\sysdb.py", line 886, in _load_config_from_json_str_and_migrate
    return CollectionConfigurationInternal.from_json_str(json_str)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\linkyw\linkyw\Lib\site-packages\chromadb\api\configuration.py", line 188, in from_json_str
    return cls.from_json(config_json)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\linkyw\linkyw\Lib\site-packages\chromadb\api\configuration.py", line 209, in from_json
    f"Trying to instantiate configuration of type {cls.__name__} from JSON with type {json_map['_type']}"
                                                                                      ~~~~~~~~^^^^^^^^^
KeyError: '_type'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "G:\xwechat_files\wxid_cljs8n445yat22_40a5\msg\file\2025-10\智能ai导游系统\xianmu\main.py", line 165, in text_spliter_add
    shutil.rmtree(kb_dir)
  File "C:\Users\link\AppData\Local\Programs\Python\Python311\Lib\shutil.py", line 787, in rmtree
    return _rmtree_unsafe(path, onerror)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\link\AppData\Local\Programs\Python\Python311\Lib\shutil.py", line 634, in _rmtree_unsafe
    onerror(os.unlink, fullname, sys.exc_info())
  File "C:\Users\link\AppData\Local\Programs\Python\Python311\Lib\shutil.py", line 632, in _rmtree_unsafe
    os.unlink(fullname)
PermissionError: [WinError 32] 另一个程序正在使用此文件，进程无法访问。: 'G:\\xwechat_files\\wxid_cljs8n445yat22_40a5\\msg\\file\\2025-10\\智能ai导游系统\\xianmu\\xiangliang\\chroma.sqlite3'
2025-10-30 20:16:10,450 - travel - ERROR - 添加文件到知识库失败：'_type'
2025-10-30 20:16:10,450 - travel - ERROR - '_type'
Traceback (most recent call last):
  File "G:\xwechat_files\wxid_cljs8n445yat22_40a5\msg\file\2025-10\智能ai导游系统\xianmu\main.py", line 137, in text_spliter_add
    vector_db = Chroma(
                ^^^^^^^
  File "E:\linkyw\linkyw\Lib\site-packages\langchain_chroma\vectorstores.py", line 342, in __init__
    self.__ensure_collection()
  File "E:\linkyw\linkyw\Lib\site-packages\langchain_chroma\vectorstores.py", line 349, in __ensure_collection
    self._chroma_collection = self._client.get_or_create_collection(
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\linkyw\linkyw\Lib\site-packages\chromadb\api\client.py", line 194, in get_or_create_collection
    model = self._server.get_or_create_collection(
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\linkyw\linkyw\Lib\site-packages\chromadb\telemetry\opentelemetry\__init__.py", line 150, in wrapper
    return f(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^
  File "E:\linkyw\linkyw\Lib\site-packages\chromadb\api\segment.py", line 103, in wrapper
    return self._rate_limit_enforcer.rate_limit(func)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\linkyw\linkyw\Lib\site-packages\chromadb\rate_limit\simple_rate_limit\__init__.py", line 24, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "E:\linkyw\linkyw\Lib\site-packages\chromadb\api\segment.py", line 288, in get_or_create_collection
    return self.create_collection(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\linkyw\linkyw\Lib\site-packages\chromadb\telemetry\opentelemetry\__init__.py", line 150, in wrapper
    return f(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^
  File "E:\linkyw\linkyw\Lib\site-packages\chromadb\api\segment.py", line 103, in wrapper
    return self._rate_limit_enforcer.rate_limit(func)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\linkyw\linkyw\Lib\site-packages\chromadb\rate_limit\simple_rate_limit\__init__.py", line 24, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "E:\linkyw\linkyw\Lib\site-packages\chromadb\api\segment.py", line 242, in create_collection
    coll, created = self._sysdb.create_collection(
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\linkyw\linkyw\Lib\site-packages\chromadb\telemetry\opentelemetry\__init__.py", line 150, in wrapper
    return f(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^
  File "E:\linkyw\linkyw\Lib\site-packages\chromadb\db\mixins\sysdb.py", line 294, in create_collection
    existing = self.get_collections(name=name, tenant=tenant, database=database)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\linkyw\linkyw\Lib\site-packages\chromadb\telemetry\opentelemetry\__init__.py", line 150, in wrapper
    return f(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^
  File "E:\linkyw\linkyw\Lib\site-packages\chromadb\db\mixins\sysdb.py", line 521, in get_collections
    configuration = self._load_config_from_json_str_and_migrate(
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\linkyw\linkyw\Lib\site-packages\chromadb\db\mixins\sysdb.py", line 886, in _load_config_from_json_str_and_migrate
    return CollectionConfigurationInternal.from_json_str(json_str)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\linkyw\linkyw\Lib\site-packages\chromadb\api\configuration.py", line 188, in from_json_str
    return cls.from_json(config_json)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\linkyw\linkyw\Lib\site-packages\chromadb\api\configuration.py", line 209, in from_json
    f"Trying to instantiate configuration of type {cls.__name__} from JSON with type {json_map['_type']}"
                                                                                      ~~~~~~~~^^^^^^^^^
KeyError: '_type'
2025-10-30 20:16:10,452 - travel - ERROR - 重置数据库失败：[WinError 32] 另一个程序正在使用此文件，进程无法访问。: 'G:\\xwechat_files\\wxid_cljs8n445yat22_40a5\\msg\\file\\2025-10\\智能ai导游系统\\xianmu\\xiangliang\\chroma.sqlite3'
2025-10-30 20:16:10,452 - travel - ERROR - [WinError 32] 另一个程序正在使用此文件，进程无法访问。: 'G:\\xwechat_files\\wxid_cljs8n445yat22_40a5\\msg\\file\\2025-10\\智能ai导游系统\\xianmu\\xiangliang\\chroma.sqlite3'
Traceback (most recent call last):
  File "G:\xwechat_files\wxid_cljs8n445yat22_40a5\msg\file\2025-10\智能ai导游系统\xianmu\main.py", line 137, in text_spliter_add
    vector_db = Chroma(
                ^^^^^^^
  File "E:\linkyw\linkyw\Lib\site-packages\langchain_chroma\vectorstores.py", line 342, in __init__
    self.__ensure_collection()
  File "E:\linkyw\linkyw\Lib\site-packages\langchain_chroma\vectorstores.py", line 349, in __ensure_collection
    self._chroma_collection = self._client.get_or_create_collection(
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\linkyw\linkyw\Lib\site-packages\chromadb\api\client.py", line 194, in get_or_create_collection
    model = self._server.get_or_create_collection(
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\linkyw\linkyw\Lib\site-packages\chromadb\telemetry\opentelemetry\__init__.py", line 150, in wrapper
    return f(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^
  File "E:\linkyw\linkyw\Lib\site-packages\chromadb\api\segment.py", line 103, in wrapper
    return self._rate_limit_enforcer.rate_limit(func)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\linkyw\linkyw\Lib\site-packages\chromadb\rate_limit\simple_rate_limit\__init__.py", line 24, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "E:\linkyw\linkyw\Lib\site-packages\chromadb\api\segment.py", line 288, in get_or_create_collection
    return self.create_collection(
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\linkyw\linkyw\Lib\site-packages\chromadb\telemetry\opentelemetry\__init__.py", line 150, in wrapper
    return f(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^
  File "E:\linkyw\linkyw\Lib\site-packages\chromadb\api\segment.py", line 103, in wrapper
    return self._rate_limit_enforcer.rate_limit(func)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\linkyw\linkyw\Lib\site-packages\chromadb\rate_limit\simple_rate_limit\__init__.py", line 24, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "E:\linkyw\linkyw\Lib\site-packages\chromadb\api\segment.py", line 242, in create_collection
    coll, created = self._sysdb.create_collection(
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\linkyw\linkyw\Lib\site-packages\chromadb\telemetry\opentelemetry\__init__.py", line 150, in wrapper
    return f(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^
  File "E:\linkyw\linkyw\Lib\site-packages\chromadb\db\mixins\sysdb.py", line 294, in create_collection
    existing = self.get_collections(name=name, tenant=tenant, database=database)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\linkyw\linkyw\Lib\site-packages\chromadb\telemetry\opentelemetry\__init__.py", line 150, in wrapper
    return f(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^
  File "E:\linkyw\linkyw\Lib\site-packages\chromadb\db\mixins\sysdb.py", line 521, in get_collections
    configuration = self._load_config_from_json_str_and_migrate(
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\linkyw\linkyw\Lib\site-packages\chromadb\db\mixins\sysdb.py", line 886, in _load_config_from_json_str_and_migrate
    return CollectionConfigurationInternal.from_json_str(json_str)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\linkyw\linkyw\Lib\site-packages\chromadb\api\configuration.py", line 188, in from_json_str
    return cls.from_json(config_json)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\linkyw\linkyw\Lib\site-packages\chromadb\api\configuration.py", line 209, in from_json
    f"Trying to instantiate configuration of type {cls.__name__} from JSON with type {json_map['_type']}"
                                                                                      ~~~~~~~~^^^^^^^^^
KeyError: '_type'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "G:\xwechat_files\wxid_cljs8n445yat22_40a5\msg\file\2025-10\智能ai导游系统\xianmu\main.py", line 165, in text_spliter_add
    shutil.rmtree(kb_dir)
  File "C:\Users\link\AppData\Local\Programs\Python\Python311\Lib\shutil.py", line 787, in rmtree
    return _rmtree_unsafe(path, onerror)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\link\AppData\Local\Programs\Python\Python311\Lib\shutil.py", line 634, in _rmtree_unsafe
    onerror(os.unlink, fullname, sys.exc_info())
  File "C:\Users\link\AppData\Local\Programs\Python\Python311\Lib\shutil.py", line 632, in _rmtree_unsafe
    os.unlink(fullname)
PermissionError: [WinError 32] 另一个程序正在使用此文件，进程无法访问。: 'G:\\xwechat_files\\wxid_cljs8n445yat22_40a5\\msg\\file\\2025-10\\智能ai导游系统\\xianmu\\xiangliang\\chroma.sqlite3'
2025-10-30 20:16:10,514 - travel - INFO - Langchain代理初始化成功
2025-10-30 20:16:42,666 - chromadb.telemetry.product.posthog - INFO - Anonymized telemetry enabled. See                     https://docs.trychroma.com/telemetry for more information.
2025-10-30 20:16:44,869 - travel - ERROR - 添加文件到知识库失败：File is not a zip file
2025-10-30 20:16:44,869 - travel - ERROR - File is not a zip file
Traceback (most recent call last):
  File "G:\xwechat_files\wxid_cljs8n445yat22_40a5\msg\file\2025-10\智能ai导游系统\xianmu\main.py", line 125, in text_spliter_add
    doc = loader.load()
          ^^^^^^^^^^^^^
  File "E:\linkyw\linkyw\Lib\site-packages\langchain_community\document_loaders\word_document.py", line 61, in load
    page_content=docx2txt.process(self.file_path),
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\linkyw\linkyw\Lib\site-packages\docx2txt\docx2txt.py", line 76, in process
    zipf = zipfile.ZipFile(docx)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\link\AppData\Local\Programs\Python\Python311\Lib\zipfile.py", line 1312, in __init__
    self._RealGetContents()
  File "C:\Users\link\AppData\Local\Programs\Python\Python311\Lib\zipfile.py", line 1379, in _RealGetContents
    raise BadZipFile("File is not a zip file")
zipfile.BadZipFile: File is not a zip file
2025-10-30 20:16:44,871 - travel - ERROR - 重置数据库失败：[WinError 32] 另一个程序正在使用此文件，进程无法访问。: 'G:\\xwechat_files\\wxid_cljs8n445yat22_40a5\\msg\\file\\2025-10\\智能ai导游系统\\xianmu\\xiangliang\\chroma.sqlite3'
2025-10-30 20:16:44,871 - travel - ERROR - [WinError 32] 另一个程序正在使用此文件，进程无法访问。: 'G:\\xwechat_files\\wxid_cljs8n445yat22_40a5\\msg\\file\\2025-10\\智能ai导游系统\\xianmu\\xiangliang\\chroma.sqlite3'
Traceback (most recent call last):
  File "G:\xwechat_files\wxid_cljs8n445yat22_40a5\msg\file\2025-10\智能ai导游系统\xianmu\main.py", line 125, in text_spliter_add
    doc = loader.load()
          ^^^^^^^^^^^^^
  File "E:\linkyw\linkyw\Lib\site-packages\langchain_community\document_loaders\word_document.py", line 61, in load
    page_content=docx2txt.process(self.file_path),
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\linkyw\linkyw\Lib\site-packages\docx2txt\docx2txt.py", line 76, in process
    zipf = zipfile.ZipFile(docx)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\link\AppData\Local\Programs\Python\Python311\Lib\zipfile.py", line 1312, in __init__
    self._RealGetContents()
  File "C:\Users\link\AppData\Local\Programs\Python\Python311\Lib\zipfile.py", line 1379, in _RealGetContents
    raise BadZipFile("File is not a zip file")
zipfile.BadZipFile: File is not a zip file

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "G:\xwechat_files\wxid_cljs8n445yat22_40a5\msg\file\2025-10\智能ai导游系统\xianmu\main.py", line 165, in text_spliter_add
    shutil.rmtree(kb_dir)
  File "C:\Users\link\AppData\Local\Programs\Python\Python311\Lib\shutil.py", line 787, in rmtree
    return _rmtree_unsafe(path, onerror)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\link\AppData\Local\Programs\Python\Python311\Lib\shutil.py", line 634, in _rmtree_unsafe
    onerror(os.unlink, fullname, sys.exc_info())
  File "C:\Users\link\AppData\Local\Programs\Python\Python311\Lib\shutil.py", line 632, in _rmtree_unsafe
    os.unlink(fullname)
PermissionError: [WinError 32] 另一个程序正在使用此文件，进程无法访问。: 'G:\\xwechat_files\\wxid_cljs8n445yat22_40a5\\msg\\file\\2025-10\\智能ai导游系统\\xianmu\\xiangliang\\chroma.sqlite3'
2025-10-30 20:16:46,172 - travel - INFO - Langchain代理初始化成功
2025-10-30 20:18:04,022 - httpx - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-30 20:18:05,593 - httpx - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-30 20:18:33,648 - httpx - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-30 20:18:34,324 - httpx - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-30 20:18:35,531 - httpx - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-30 20:20:16,289 - chromadb.telemetry.product.posthog - INFO - Anonymized telemetry enabled. See                     https://docs.trychroma.com/telemetry for more information.
2025-10-30 20:20:18,003 - travel - ERROR - 添加文件到知识库失败：File is not a zip file
2025-10-30 20:20:18,003 - travel - ERROR - File is not a zip file
Traceback (most recent call last):
  File "G:\xwechat_files\wxid_cljs8n445yat22_40a5\msg\file\2025-10\智能ai导游系统\xianmu\main.py", line 125, in text_spliter_add
    doc = loader.load()
          ^^^^^^^^^^^^^
  File "E:\linkyw\linkyw\Lib\site-packages\langchain_community\document_loaders\word_document.py", line 61, in load
    page_content=docx2txt.process(self.file_path),
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\linkyw\linkyw\Lib\site-packages\docx2txt\docx2txt.py", line 76, in process
    zipf = zipfile.ZipFile(docx)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\link\AppData\Local\Programs\Python\Python311\Lib\zipfile.py", line 1312, in __init__
    self._RealGetContents()
  File "C:\Users\link\AppData\Local\Programs\Python\Python311\Lib\zipfile.py", line 1379, in _RealGetContents
    raise BadZipFile("File is not a zip file")
zipfile.BadZipFile: File is not a zip file
2025-10-30 20:20:18,006 - travel - ERROR - 重置数据库失败：[WinError 32] 另一个程序正在使用此文件，进程无法访问。: 'G:\\xwechat_files\\wxid_cljs8n445yat22_40a5\\msg\\file\\2025-10\\智能ai导游系统\\xianmu\\xiangliang\\chroma.sqlite3'
2025-10-30 20:20:18,006 - travel - ERROR - [WinError 32] 另一个程序正在使用此文件，进程无法访问。: 'G:\\xwechat_files\\wxid_cljs8n445yat22_40a5\\msg\\file\\2025-10\\智能ai导游系统\\xianmu\\xiangliang\\chroma.sqlite3'
Traceback (most recent call last):
  File "G:\xwechat_files\wxid_cljs8n445yat22_40a5\msg\file\2025-10\智能ai导游系统\xianmu\main.py", line 125, in text_spliter_add
    doc = loader.load()
          ^^^^^^^^^^^^^
  File "E:\linkyw\linkyw\Lib\site-packages\langchain_community\document_loaders\word_document.py", line 61, in load
    page_content=docx2txt.process(self.file_path),
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\linkyw\linkyw\Lib\site-packages\docx2txt\docx2txt.py", line 76, in process
    zipf = zipfile.ZipFile(docx)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\link\AppData\Local\Programs\Python\Python311\Lib\zipfile.py", line 1312, in __init__
    self._RealGetContents()
  File "C:\Users\link\AppData\Local\Programs\Python\Python311\Lib\zipfile.py", line 1379, in _RealGetContents
    raise BadZipFile("File is not a zip file")
zipfile.BadZipFile: File is not a zip file

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "G:\xwechat_files\wxid_cljs8n445yat22_40a5\msg\file\2025-10\智能ai导游系统\xianmu\main.py", line 165, in text_spliter_add
    shutil.rmtree(kb_dir)
  File "C:\Users\link\AppData\Local\Programs\Python\Python311\Lib\shutil.py", line 787, in rmtree
    return _rmtree_unsafe(path, onerror)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\link\AppData\Local\Programs\Python\Python311\Lib\shutil.py", line 634, in _rmtree_unsafe
    onerror(os.unlink, fullname, sys.exc_info())
  File "C:\Users\link\AppData\Local\Programs\Python\Python311\Lib\shutil.py", line 632, in _rmtree_unsafe
    os.unlink(fullname)
PermissionError: [WinError 32] 另一个程序正在使用此文件，进程无法访问。: 'G:\\xwechat_files\\wxid_cljs8n445yat22_40a5\\msg\\file\\2025-10\\智能ai导游系统\\xianmu\\xiangliang\\chroma.sqlite3'
2025-10-30 20:20:18,105 - dashscope - ERROR - 
2025-10-30 20:20:22,680 - chromadb.telemetry.product.posthog - INFO - Anonymized telemetry enabled. See                     https://docs.trychroma.com/telemetry for more information.
2025-10-30 20:20:24,406 - travel - ERROR - 添加文件到知识库失败：File is not a zip file
2025-10-30 20:20:24,406 - travel - ERROR - File is not a zip file
Traceback (most recent call last):
  File "G:\xwechat_files\wxid_cljs8n445yat22_40a5\msg\file\2025-10\智能ai导游系统\xianmu\main.py", line 125, in text_spliter_add
    doc = loader.load()
          ^^^^^^^^^^^^^
  File "E:\linkyw\linkyw\Lib\site-packages\langchain_community\document_loaders\word_document.py", line 61, in load
    page_content=docx2txt.process(self.file_path),
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\linkyw\linkyw\Lib\site-packages\docx2txt\docx2txt.py", line 76, in process
    zipf = zipfile.ZipFile(docx)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\link\AppData\Local\Programs\Python\Python311\Lib\zipfile.py", line 1312, in __init__
    self._RealGetContents()
  File "C:\Users\link\AppData\Local\Programs\Python\Python311\Lib\zipfile.py", line 1379, in _RealGetContents
    raise BadZipFile("File is not a zip file")
zipfile.BadZipFile: File is not a zip file
2025-10-30 20:20:24,408 - travel - ERROR - 重置数据库失败：[WinError 32] 另一个程序正在使用此文件，进程无法访问。: 'G:\\xwechat_files\\wxid_cljs8n445yat22_40a5\\msg\\file\\2025-10\\智能ai导游系统\\xianmu\\xiangliang\\chroma.sqlite3'
2025-10-30 20:20:24,408 - travel - ERROR - [WinError 32] 另一个程序正在使用此文件，进程无法访问。: 'G:\\xwechat_files\\wxid_cljs8n445yat22_40a5\\msg\\file\\2025-10\\智能ai导游系统\\xianmu\\xiangliang\\chroma.sqlite3'
Traceback (most recent call last):
  File "G:\xwechat_files\wxid_cljs8n445yat22_40a5\msg\file\2025-10\智能ai导游系统\xianmu\main.py", line 125, in text_spliter_add
    doc = loader.load()
          ^^^^^^^^^^^^^
  File "E:\linkyw\linkyw\Lib\site-packages\langchain_community\document_loaders\word_document.py", line 61, in load
    page_content=docx2txt.process(self.file_path),
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\linkyw\linkyw\Lib\site-packages\docx2txt\docx2txt.py", line 76, in process
    zipf = zipfile.ZipFile(docx)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\link\AppData\Local\Programs\Python\Python311\Lib\zipfile.py", line 1312, in __init__
    self._RealGetContents()
  File "C:\Users\link\AppData\Local\Programs\Python\Python311\Lib\zipfile.py", line 1379, in _RealGetContents
    raise BadZipFile("File is not a zip file")
zipfile.BadZipFile: File is not a zip file

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "G:\xwechat_files\wxid_cljs8n445yat22_40a5\msg\file\2025-10\智能ai导游系统\xianmu\main.py", line 165, in text_spliter_add
    shutil.rmtree(kb_dir)
  File "C:\Users\link\AppData\Local\Programs\Python\Python311\Lib\shutil.py", line 787, in rmtree
    return _rmtree_unsafe(path, onerror)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\link\AppData\Local\Programs\Python\Python311\Lib\shutil.py", line 634, in _rmtree_unsafe
    onerror(os.unlink, fullname, sys.exc_info())
  File "C:\Users\link\AppData\Local\Programs\Python\Python311\Lib\shutil.py", line 632, in _rmtree_unsafe
    os.unlink(fullname)
PermissionError: [WinError 32] 另一个程序正在使用此文件，进程无法访问。: 'G:\\xwechat_files\\wxid_cljs8n445yat22_40a5\\msg\\file\\2025-10\\智能ai导游系统\\xianmu\\xiangliang\\chroma.sqlite3'
2025-10-30 20:20:25,403 - travel - INFO - Langchain代理初始化成功
2025-10-30 20:20:35,476 - httpx - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-30 20:20:37,422 - httpx - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-30 20:21:39,266 - httpx - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-30 20:21:39,724 - httpx - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-30 20:21:41,669 - httpx - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-30 20:21:42,095 - httpx - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-30 20:21:44,105 - httpx - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-30 20:21:44,482 - httpx - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-30 20:21:46,585 - httpx - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-30 20:21:46,987 - httpx - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-30 20:21:49,623 - httpx - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-30 20:21:50,476 - httpx - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-30 20:21:52,638 - httpx - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-30 20:23:14,449 - chromadb.telemetry.product.posthog - INFO - Anonymized telemetry enabled. See                     https://docs.trychroma.com/telemetry for more information.
2025-10-30 20:23:16,320 - travel - ERROR - 添加文件到知识库失败：File is not a zip file
2025-10-30 20:23:16,320 - travel - ERROR - File is not a zip file
Traceback (most recent call last):
  File "G:\xwechat_files\wxid_cljs8n445yat22_40a5\msg\file\2025-10\智能ai导游系统\xianmu\main.py", line 125, in text_spliter_add
    doc = loader.load()
          ^^^^^^^^^^^^^
  File "E:\linkyw\linkyw\Lib\site-packages\langchain_community\document_loaders\word_document.py", line 61, in load
    page_content=docx2txt.process(self.file_path),
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\linkyw\linkyw\Lib\site-packages\docx2txt\docx2txt.py", line 76, in process
    zipf = zipfile.ZipFile(docx)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\link\AppData\Local\Programs\Python\Python311\Lib\zipfile.py", line 1312, in __init__
    self._RealGetContents()
  File "C:\Users\link\AppData\Local\Programs\Python\Python311\Lib\zipfile.py", line 1379, in _RealGetContents
    raise BadZipFile("File is not a zip file")
zipfile.BadZipFile: File is not a zip file
2025-10-30 20:23:16,321 - travel - ERROR - 重置数据库失败：[WinError 32] 另一个程序正在使用此文件，进程无法访问。: 'G:\\xwechat_files\\wxid_cljs8n445yat22_40a5\\msg\\file\\2025-10\\智能ai导游系统\\xianmu\\xiangliang\\chroma.sqlite3'
2025-10-30 20:23:16,321 - travel - ERROR - [WinError 32] 另一个程序正在使用此文件，进程无法访问。: 'G:\\xwechat_files\\wxid_cljs8n445yat22_40a5\\msg\\file\\2025-10\\智能ai导游系统\\xianmu\\xiangliang\\chroma.sqlite3'
Traceback (most recent call last):
  File "G:\xwechat_files\wxid_cljs8n445yat22_40a5\msg\file\2025-10\智能ai导游系统\xianmu\main.py", line 125, in text_spliter_add
    doc = loader.load()
          ^^^^^^^^^^^^^
  File "E:\linkyw\linkyw\Lib\site-packages\langchain_community\document_loaders\word_document.py", line 61, in load
    page_content=docx2txt.process(self.file_path),
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\linkyw\linkyw\Lib\site-packages\docx2txt\docx2txt.py", line 76, in process
    zipf = zipfile.ZipFile(docx)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\link\AppData\Local\Programs\Python\Python311\Lib\zipfile.py", line 1312, in __init__
    self._RealGetContents()
  File "C:\Users\link\AppData\Local\Programs\Python\Python311\Lib\zipfile.py", line 1379, in _RealGetContents
    raise BadZipFile("File is not a zip file")
zipfile.BadZipFile: File is not a zip file

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "G:\xwechat_files\wxid_cljs8n445yat22_40a5\msg\file\2025-10\智能ai导游系统\xianmu\main.py", line 165, in text_spliter_add
    shutil.rmtree(kb_dir)
  File "C:\Users\link\AppData\Local\Programs\Python\Python311\Lib\shutil.py", line 787, in rmtree
    return _rmtree_unsafe(path, onerror)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\link\AppData\Local\Programs\Python\Python311\Lib\shutil.py", line 634, in _rmtree_unsafe
    onerror(os.unlink, fullname, sys.exc_info())
  File "C:\Users\link\AppData\Local\Programs\Python\Python311\Lib\shutil.py", line 632, in _rmtree_unsafe
    os.unlink(fullname)
PermissionError: [WinError 32] 另一个程序正在使用此文件，进程无法访问。: 'G:\\xwechat_files\\wxid_cljs8n445yat22_40a5\\msg\\file\\2025-10\\智能ai导游系统\\xianmu\\xiangliang\\chroma.sqlite3'
2025-10-30 20:23:17,521 - travel - INFO - Langchain代理初始化成功
2025-10-30 20:23:31,854 - httpx - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-30 20:23:32,941 - httpx - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-30 20:26:02,619 - chromadb.telemetry.product.posthog - INFO - Anonymized telemetry enabled. See                     https://docs.trychroma.com/telemetry for more information.
2025-10-30 20:26:04,926 - travel - ERROR - 添加文件到知识库失败：File is not a zip file
2025-10-30 20:26:04,926 - travel - ERROR - File is not a zip file
Traceback (most recent call last):
  File "G:\xwechat_files\wxid_cljs8n445yat22_40a5\msg\file\2025-10\智能ai导游系统\xianmu\main.py", line 125, in text_spliter_add
    doc = loader.load()
          ^^^^^^^^^^^^^
  File "E:\linkyw\linkyw\Lib\site-packages\langchain_community\document_loaders\word_document.py", line 61, in load
    page_content=docx2txt.process(self.file_path),
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\linkyw\linkyw\Lib\site-packages\docx2txt\docx2txt.py", line 76, in process
    zipf = zipfile.ZipFile(docx)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\link\AppData\Local\Programs\Python\Python311\Lib\zipfile.py", line 1312, in __init__
    self._RealGetContents()
  File "C:\Users\link\AppData\Local\Programs\Python\Python311\Lib\zipfile.py", line 1379, in _RealGetContents
    raise BadZipFile("File is not a zip file")
zipfile.BadZipFile: File is not a zip file
2025-10-30 20:26:04,927 - travel - ERROR - 重置数据库失败：[WinError 32] 另一个程序正在使用此文件，进程无法访问。: 'G:\\xwechat_files\\wxid_cljs8n445yat22_40a5\\msg\\file\\2025-10\\智能ai导游系统\\xianmu\\xiangliang\\chroma.sqlite3'
2025-10-30 20:26:04,927 - travel - ERROR - [WinError 32] 另一个程序正在使用此文件，进程无法访问。: 'G:\\xwechat_files\\wxid_cljs8n445yat22_40a5\\msg\\file\\2025-10\\智能ai导游系统\\xianmu\\xiangliang\\chroma.sqlite3'
Traceback (most recent call last):
  File "G:\xwechat_files\wxid_cljs8n445yat22_40a5\msg\file\2025-10\智能ai导游系统\xianmu\main.py", line 125, in text_spliter_add
    doc = loader.load()
          ^^^^^^^^^^^^^
  File "E:\linkyw\linkyw\Lib\site-packages\langchain_community\document_loaders\word_document.py", line 61, in load
    page_content=docx2txt.process(self.file_path),
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\linkyw\linkyw\Lib\site-packages\docx2txt\docx2txt.py", line 76, in process
    zipf = zipfile.ZipFile(docx)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\link\AppData\Local\Programs\Python\Python311\Lib\zipfile.py", line 1312, in __init__
    self._RealGetContents()
  File "C:\Users\link\AppData\Local\Programs\Python\Python311\Lib\zipfile.py", line 1379, in _RealGetContents
    raise BadZipFile("File is not a zip file")
zipfile.BadZipFile: File is not a zip file

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "G:\xwechat_files\wxid_cljs8n445yat22_40a5\msg\file\2025-10\智能ai导游系统\xianmu\main.py", line 165, in text_spliter_add
    shutil.rmtree(kb_dir)
  File "C:\Users\link\AppData\Local\Programs\Python\Python311\Lib\shutil.py", line 787, in rmtree
    return _rmtree_unsafe(path, onerror)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\link\AppData\Local\Programs\Python\Python311\Lib\shutil.py", line 634, in _rmtree_unsafe
    onerror(os.unlink, fullname, sys.exc_info())
  File "C:\Users\link\AppData\Local\Programs\Python\Python311\Lib\shutil.py", line 632, in _rmtree_unsafe
    os.unlink(fullname)
PermissionError: [WinError 32] 另一个程序正在使用此文件，进程无法访问。: 'G:\\xwechat_files\\wxid_cljs8n445yat22_40a5\\msg\\file\\2025-10\\智能ai导游系统\\xianmu\\xiangliang\\chroma.sqlite3'
2025-10-30 20:26:06,627 - travel - INFO - Langchain代理初始化成功
2025-10-30 20:26:16,382 - httpx - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-30 20:26:17,780 - httpx - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-30 20:26:43,600 - httpx - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-30 20:26:44,399 - httpx - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-30 20:26:45,815 - httpx - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-30 20:28:13,665 - chromadb.telemetry.product.posthog - INFO - Anonymized telemetry enabled. See                     https://docs.trychroma.com/telemetry for more information.
2025-10-30 20:28:15,370 - travel - ERROR - 添加文件到知识库失败：File is not a zip file
2025-10-30 20:28:15,370 - travel - ERROR - File is not a zip file
Traceback (most recent call last):
  File "G:\xwechat_files\wxid_cljs8n445yat22_40a5\msg\file\2025-10\智能ai导游系统\xianmu\main.py", line 125, in text_spliter_add
    doc = loader.load()
          ^^^^^^^^^^^^^
  File "E:\linkyw\linkyw\Lib\site-packages\langchain_community\document_loaders\word_document.py", line 61, in load
    page_content=docx2txt.process(self.file_path),
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\linkyw\linkyw\Lib\site-packages\docx2txt\docx2txt.py", line 76, in process
    zipf = zipfile.ZipFile(docx)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\link\AppData\Local\Programs\Python\Python311\Lib\zipfile.py", line 1312, in __init__
    self._RealGetContents()
  File "C:\Users\link\AppData\Local\Programs\Python\Python311\Lib\zipfile.py", line 1379, in _RealGetContents
    raise BadZipFile("File is not a zip file")
zipfile.BadZipFile: File is not a zip file
2025-10-30 20:28:15,372 - travel - ERROR - 重置数据库失败：[WinError 32] 另一个程序正在使用此文件，进程无法访问。: 'G:\\xwechat_files\\wxid_cljs8n445yat22_40a5\\msg\\file\\2025-10\\智能ai导游系统\\xianmu\\xiangliang\\chroma.sqlite3'
2025-10-30 20:28:15,372 - travel - ERROR - [WinError 32] 另一个程序正在使用此文件，进程无法访问。: 'G:\\xwechat_files\\wxid_cljs8n445yat22_40a5\\msg\\file\\2025-10\\智能ai导游系统\\xianmu\\xiangliang\\chroma.sqlite3'
Traceback (most recent call last):
  File "G:\xwechat_files\wxid_cljs8n445yat22_40a5\msg\file\2025-10\智能ai导游系统\xianmu\main.py", line 125, in text_spliter_add
    doc = loader.load()
          ^^^^^^^^^^^^^
  File "E:\linkyw\linkyw\Lib\site-packages\langchain_community\document_loaders\word_document.py", line 61, in load
    page_content=docx2txt.process(self.file_path),
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\linkyw\linkyw\Lib\site-packages\docx2txt\docx2txt.py", line 76, in process
    zipf = zipfile.ZipFile(docx)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\link\AppData\Local\Programs\Python\Python311\Lib\zipfile.py", line 1312, in __init__
    self._RealGetContents()
  File "C:\Users\link\AppData\Local\Programs\Python\Python311\Lib\zipfile.py", line 1379, in _RealGetContents
    raise BadZipFile("File is not a zip file")
zipfile.BadZipFile: File is not a zip file

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "G:\xwechat_files\wxid_cljs8n445yat22_40a5\msg\file\2025-10\智能ai导游系统\xianmu\main.py", line 165, in text_spliter_add
    shutil.rmtree(kb_dir)
  File "C:\Users\link\AppData\Local\Programs\Python\Python311\Lib\shutil.py", line 787, in rmtree
    return _rmtree_unsafe(path, onerror)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\link\AppData\Local\Programs\Python\Python311\Lib\shutil.py", line 634, in _rmtree_unsafe
    onerror(os.unlink, fullname, sys.exc_info())
  File "C:\Users\link\AppData\Local\Programs\Python\Python311\Lib\shutil.py", line 632, in _rmtree_unsafe
    os.unlink(fullname)
PermissionError: [WinError 32] 另一个程序正在使用此文件，进程无法访问。: 'G:\\xwechat_files\\wxid_cljs8n445yat22_40a5\\msg\\file\\2025-10\\智能ai导游系统\\xianmu\\xiangliang\\chroma.sqlite3'
2025-10-30 20:28:16,469 - travel - INFO - Langchain代理初始化成功
2025-10-30 20:28:33,603 - httpx - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-30 20:28:34,743 - httpx - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-30 20:30:03,682 - chromadb.telemetry.product.posthog - INFO - Anonymized telemetry enabled. See                     https://docs.trychroma.com/telemetry for more information.
2025-10-30 20:30:05,505 - travel - ERROR - 添加文件到知识库失败：File is not a zip file
2025-10-30 20:30:05,505 - travel - ERROR - File is not a zip file
Traceback (most recent call last):
  File "G:\xwechat_files\wxid_cljs8n445yat22_40a5\msg\file\2025-10\智能ai导游系统\xianmu\main.py", line 125, in text_spliter_add
    doc = loader.load()
          ^^^^^^^^^^^^^
  File "E:\linkyw\linkyw\Lib\site-packages\langchain_community\document_loaders\word_document.py", line 61, in load
    page_content=docx2txt.process(self.file_path),
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\linkyw\linkyw\Lib\site-packages\docx2txt\docx2txt.py", line 76, in process
    zipf = zipfile.ZipFile(docx)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\link\AppData\Local\Programs\Python\Python311\Lib\zipfile.py", line 1312, in __init__
    self._RealGetContents()
  File "C:\Users\link\AppData\Local\Programs\Python\Python311\Lib\zipfile.py", line 1379, in _RealGetContents
    raise BadZipFile("File is not a zip file")
zipfile.BadZipFile: File is not a zip file
2025-10-30 20:30:05,507 - travel - ERROR - 重置数据库失败：[WinError 32] 另一个程序正在使用此文件，进程无法访问。: 'G:\\xwechat_files\\wxid_cljs8n445yat22_40a5\\msg\\file\\2025-10\\智能ai导游系统\\xianmu\\xiangliang\\chroma.sqlite3'
2025-10-30 20:30:05,507 - travel - ERROR - [WinError 32] 另一个程序正在使用此文件，进程无法访问。: 'G:\\xwechat_files\\wxid_cljs8n445yat22_40a5\\msg\\file\\2025-10\\智能ai导游系统\\xianmu\\xiangliang\\chroma.sqlite3'
Traceback (most recent call last):
  File "G:\xwechat_files\wxid_cljs8n445yat22_40a5\msg\file\2025-10\智能ai导游系统\xianmu\main.py", line 125, in text_spliter_add
    doc = loader.load()
          ^^^^^^^^^^^^^
  File "E:\linkyw\linkyw\Lib\site-packages\langchain_community\document_loaders\word_document.py", line 61, in load
    page_content=docx2txt.process(self.file_path),
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\linkyw\linkyw\Lib\site-packages\docx2txt\docx2txt.py", line 76, in process
    zipf = zipfile.ZipFile(docx)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\link\AppData\Local\Programs\Python\Python311\Lib\zipfile.py", line 1312, in __init__
    self._RealGetContents()
  File "C:\Users\link\AppData\Local\Programs\Python\Python311\Lib\zipfile.py", line 1379, in _RealGetContents
    raise BadZipFile("File is not a zip file")
zipfile.BadZipFile: File is not a zip file

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "G:\xwechat_files\wxid_cljs8n445yat22_40a5\msg\file\2025-10\智能ai导游系统\xianmu\main.py", line 165, in text_spliter_add
    shutil.rmtree(kb_dir)
  File "C:\Users\link\AppData\Local\Programs\Python\Python311\Lib\shutil.py", line 787, in rmtree
    return _rmtree_unsafe(path, onerror)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\link\AppData\Local\Programs\Python\Python311\Lib\shutil.py", line 634, in _rmtree_unsafe
    onerror(os.unlink, fullname, sys.exc_info())
  File "C:\Users\link\AppData\Local\Programs\Python\Python311\Lib\shutil.py", line 632, in _rmtree_unsafe
    os.unlink(fullname)
PermissionError: [WinError 32] 另一个程序正在使用此文件，进程无法访问。: 'G:\\xwechat_files\\wxid_cljs8n445yat22_40a5\\msg\\file\\2025-10\\智能ai导游系统\\xianmu\\xiangliang\\chroma.sqlite3'
2025-10-30 20:30:06,731 - travel - INFO - Langchain代理初始化成功
2025-10-30 20:30:17,006 - httpx - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-30 20:30:21,186 - httpx - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-30 20:35:14,274 - chromadb.telemetry.product.posthog - INFO - Anonymized telemetry enabled. See                     https://docs.trychroma.com/telemetry for more information.
2025-10-30 20:35:15,850 - travel - ERROR - 添加文件到知识库失败：File is not a zip file
2025-10-30 20:35:15,851 - travel - ERROR - File is not a zip file
Traceback (most recent call last):
  File "G:\xwechat_files\wxid_cljs8n445yat22_40a5\msg\file\2025-10\智能ai导游系统\xianmu\main.py", line 125, in text_spliter_add
    doc = loader.load()
          ^^^^^^^^^^^^^
  File "E:\linkyw\linkyw\Lib\site-packages\langchain_community\document_loaders\word_document.py", line 61, in load
    page_content=docx2txt.process(self.file_path),
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\linkyw\linkyw\Lib\site-packages\docx2txt\docx2txt.py", line 76, in process
    zipf = zipfile.ZipFile(docx)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\link\AppData\Local\Programs\Python\Python311\Lib\zipfile.py", line 1312, in __init__
    self._RealGetContents()
  File "C:\Users\link\AppData\Local\Programs\Python\Python311\Lib\zipfile.py", line 1379, in _RealGetContents
    raise BadZipFile("File is not a zip file")
zipfile.BadZipFile: File is not a zip file
2025-10-30 20:35:15,855 - travel - ERROR - 重置数据库失败：[WinError 32] 另一个程序正在使用此文件，进程无法访问。: 'G:\\xwechat_files\\wxid_cljs8n445yat22_40a5\\msg\\file\\2025-10\\智能ai导游系统\\xianmu\\xiangliang\\chroma.sqlite3'
2025-10-30 20:35:15,855 - travel - ERROR - [WinError 32] 另一个程序正在使用此文件，进程无法访问。: 'G:\\xwechat_files\\wxid_cljs8n445yat22_40a5\\msg\\file\\2025-10\\智能ai导游系统\\xianmu\\xiangliang\\chroma.sqlite3'
Traceback (most recent call last):
  File "G:\xwechat_files\wxid_cljs8n445yat22_40a5\msg\file\2025-10\智能ai导游系统\xianmu\main.py", line 125, in text_spliter_add
    doc = loader.load()
          ^^^^^^^^^^^^^
  File "E:\linkyw\linkyw\Lib\site-packages\langchain_community\document_loaders\word_document.py", line 61, in load
    page_content=docx2txt.process(self.file_path),
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\linkyw\linkyw\Lib\site-packages\docx2txt\docx2txt.py", line 76, in process
    zipf = zipfile.ZipFile(docx)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\link\AppData\Local\Programs\Python\Python311\Lib\zipfile.py", line 1312, in __init__
    self._RealGetContents()
  File "C:\Users\link\AppData\Local\Programs\Python\Python311\Lib\zipfile.py", line 1379, in _RealGetContents
    raise BadZipFile("File is not a zip file")
zipfile.BadZipFile: File is not a zip file

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "G:\xwechat_files\wxid_cljs8n445yat22_40a5\msg\file\2025-10\智能ai导游系统\xianmu\main.py", line 165, in text_spliter_add
    shutil.rmtree(kb_dir)
  File "C:\Users\link\AppData\Local\Programs\Python\Python311\Lib\shutil.py", line 787, in rmtree
    return _rmtree_unsafe(path, onerror)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\link\AppData\Local\Programs\Python\Python311\Lib\shutil.py", line 634, in _rmtree_unsafe
    onerror(os.unlink, fullname, sys.exc_info())
  File "C:\Users\link\AppData\Local\Programs\Python\Python311\Lib\shutil.py", line 632, in _rmtree_unsafe
    os.unlink(fullname)
PermissionError: [WinError 32] 另一个程序正在使用此文件，进程无法访问。: 'G:\\xwechat_files\\wxid_cljs8n445yat22_40a5\\msg\\file\\2025-10\\智能ai导游系统\\xianmu\\xiangliang\\chroma.sqlite3'
2025-10-30 20:35:16,824 - travel - INFO - Langchain代理初始化成功
2025-10-30 20:35:26,353 - httpx - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
2025-10-30 20:35:28,894 - httpx - INFO - HTTP Request: POST https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions "HTTP/1.1 200 OK"
